I"UÓ<h1 id="ç»Ÿè®¡æœºå™¨ç¿»è¯‘ç³»ç»Ÿmosesçš„æ­å»ºä¸è¿è¡Œ">ç»Ÿè®¡æœºå™¨ç¿»è¯‘ç³»ç»ŸMosesçš„æ­å»ºä¸è¿è¡Œ</h1>

<h2 id="mosesç³»ç»Ÿç®€ä»‹">Mosesç³»ç»Ÿç®€ä»‹</h2>

<p>æ‘©è¥¿æ˜¯ç»Ÿè®¡ï¼ˆæˆ–ç§°åŸºäºæ•°æ®çš„ï¼‰æœºå™¨ç¿»è¯‘ï¼ˆMTï¼‰çš„ä¸€ä¸ªå®ç°æ–¹æ³•ã€‚è¿™æ˜¯è¯¥é¢†åŸŸç›®å‰çš„ä¸»è¦æ–¹æ³•ï¼Œå¹¶è¢«è°·æ­Œå’Œå¾®è½¯ç­‰å…¬å¸éƒ¨ç½²çš„åœ¨çº¿ç¿»è¯‘ç³»ç»Ÿæ‰€é‡‡ç”¨ã€‚åœ¨ç»Ÿè®¡æœºå™¨ç¿»è¯‘ï¼ˆSMTï¼‰ä¸­ï¼Œç¿»è¯‘ç³»ç»Ÿæ¥å—å¤§é‡å¹¶è¡Œæ•°æ®çš„è®­ç»ƒï¼ˆç³»ç»Ÿä»ä¸­å­¦ä¹ å¦‚ä½•ç¿»è¯‘å°æ®µï¼‰ï¼Œä»¥åŠæ›´å¤§é‡çš„å•è¯­æ•°æ®ï¼ˆç³»ç»Ÿä»ä¸­å­¦ä¹ ç›®æ ‡è¯­è¨€åº”è¯¥æ€ä¹ˆç»„ç»‡ï¼‰ã€‚å¹³è¡Œæ•°æ®æ˜¯ä¸¤ç§ä¸åŒè¯­è¨€çš„å¥å­é›†åˆï¼Œå®ƒä»¬æ˜¯å¥å­å¯¹é½çš„ï¼Œå› ä¸ºä¸€ç§è¯­è¨€çš„æ¯ä¸ªå¥å­éƒ½ä¸å¦ä¸€ç§è¯­è¨€ä¸­ç›¸åº”çš„ç¿»è¯‘å¥å­ç›¸åŒ¹é…ï¼Œå®ƒä¹Ÿè¢«ç§°ä¸ºbitextã€‚</p>

<p>æ‘©è¥¿çš„è®­ç»ƒè¿‡ç¨‹æ¥æ”¶å¹³è¡Œæ•°æ®ï¼Œå¹¶ä½¿ç”¨å•è¯å’Œè¯­è¨€ç‰‡æ®µï¼ˆå³ä¸ºçŸ­è¯­ï¼‰çš„åŒæ—¶å‡ºç°æ¥æ¨æ–­ä¸¤ç§è¯­è¨€ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚åœ¨åŸºäºçŸ­è¯­çš„æœºå™¨ç¿»è¯‘ä¸­ï¼Œè¿™äº›å¯¹åº”å…³ç³»ä»…åœ¨è¿ç»­çš„å•è¯åºåˆ—ä¹‹é—´ï¼Œè€Œåœ¨åŸºäºåˆ†å±‚çŸ­è¯­çš„æœºå™¨ç¿»è¯‘æˆ–åŸºäºè¯­æ³•çš„ç¿»è¯‘ä¸­ï¼Œæ›´å¤šå…³äºå¥å­çš„ç»“æ„è¢«æ·»åŠ åˆ°å¯¹åº”å…³ç³»ä¸­ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåˆ†å±‚çš„æœºå™¨ç¿»è¯‘ç³»ç»Ÿå¯ä»¥çŸ¥é“å¾·å›½hat X gegessen å¯¹åº”äºè‹±è¯­ä¸­çš„ate Xï¼Œå…¶ä¸­Xsèƒ½è¢«ä»»ä½•å¾·è¯­-è‹±è¯­å•è¯å¯¹æ‰€æ›¿æ¢ã€‚åœ¨è¿™äº›ç±»å‹çš„ç³»ç»Ÿä¸­ä½¿ç”¨çš„é¢å¤–ç»“æ„å¯èƒ½æˆ–å¹¶ä¸èƒ½ä»å¹¶è¡Œè¯­æ–™çš„è¯­è¨€åˆ†æå¾—åˆ°ã€‚æ‘©è¥¿è¿˜å®ç°äº†åŸºäºçŸ­è¯­çš„æœºå™¨ç¿»è¯‘çš„æ‰©å±•ï¼Œç§°ä¸ºå› å¼ç¿»è¯‘ï¼Œå¯ä»¥å°†é¢å¤–çš„è¯­è¨€ä¿¡æ¯æ·»åŠ åˆ°åŸºäºçŸ­è¯­çš„ç¿»è¯‘ç³»ç»Ÿä¸­ã€‚</p>

<p>æœ‰å…³æ‘©è¥¿ç¿»è¯‘æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§æ‘©è¥¿ç½‘ç«™ä¸Šå…³äº<a href="http://www.statmt.org/moses/?n=Moses.Tutorial">åŸºäºçŸ­è¯­çš„æœºå™¨ç¿»è¯‘ç³»ç»Ÿ</a>ï¼ŒåŸºäº<a href="http://www.statmt.org/moses/?n=Moses.SyntaxTutorial">å¥æ³•çš„ç¿»è¯‘ç³»ç»Ÿ</a>æˆ–åŸºäºå› å­çš„ç¿»è¯‘ç³»ç»Ÿã€‚</p>

<p>æ— è®ºæ‚¨ä½¿ç”¨å“ªç§ç±»å‹çš„æœºå™¨ç¿»è¯‘æ¨¡å‹ï¼Œåˆ›å»ºä¸€ä¸ªè¡¨ç°è‰¯å¥½çš„ç¿»è¯‘ç³»ç»Ÿçš„å…³é”®éƒ½æ˜¯å¤§é‡ä¼˜è´¨æ•°æ®ï¼ˆè¯­æ–™ï¼‰ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è®¸å¤š<a href="http://www.statmt.org/moses/?n=Moses.LinksToCorpora">å…è´¹çš„å¹¶è¡Œæ•°æ®æº</a>æ¥è®­ç»ƒæ ·æœ¬ç³»ç»Ÿï¼Œæ¯”å¦‚ï¼šhttp://www.statmt.org/moses/?n=Moses.LinksToCorporaã€‚ä½†ï¼ˆé€šå¸¸ï¼‰æ‚¨ä½¿ç”¨çš„æ•°æ®è¶Šæ¥è¿‘æ‚¨è¦ç¿»è¯‘çš„è¯­è¨€ç±»å‹ï¼Œå¾—åˆ°çš„ç»“æœå°±è¶Šå¥½ã€‚è¿™æ˜¯ä½¿ç”¨åƒMosesè¿™æ ·çš„å¼€æºå·¥å…·çš„ä¼˜åŠ¿ä¹‹ä¸€ï¼Œå¦‚æœæ‚¨æ‹¥æœ‰è‡ªå·±çš„æ•°æ®ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥æ ¹æ®éœ€è¦å®šåˆ¶è‡ªå·±çš„ç¿»è¯‘ç³»ç»Ÿï¼Œå¹¶ä¸”å¯èƒ½æ¯”é€šç”¨ç¿»è¯‘ç³»ç»Ÿè·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚æ‘©è¥¿ç”¨æ¥è®­ç»ƒç¿»è¯‘ç³»ç»Ÿçš„è¿‡ç¨‹ä¸­éœ€è¦å¥å­å¯¹é½çš„æ•°æ®ï¼Œä½†å¦‚æœè¯­æ–™åœ¨æ–‡æ¡£çº§åˆ«å¯¹é½ï¼Œåˆ™é€šå¸¸å¯ä»¥ä½¿ç”¨åƒ<a href="http://mokk.bme.hu/resources/hunalign/">hunalign</a>è¿™æ ·çš„å·¥å…·å°†å…¶è½¬æ¢ä¸ºå¥å­å¯¹é½çš„æ•°æ®ã€‚</p>

<h2 id="mosesç³»ç»Ÿçš„ç»„æˆéƒ¨åˆ†"><strong>Mosesç³»ç»Ÿçš„ç»„æˆéƒ¨åˆ†</strong></h2>

<p>æ‘©è¥¿ç³»ç»Ÿçš„ä¸¤ä¸ªä¸»è¦ç»„æˆéƒ¨åˆ†æ˜¯è®­ç»ƒç®¡é“å’Œè§£ç å™¨ã€‚è¿˜æœ‰å„ç§å¼€æºç¤¾åŒºè´¡çŒ®çš„å·¥å…·å’Œå®ç”¨ç¨‹åºã€‚è®­ç»ƒç®¡é“å®é™…ä¸Šæ˜¯ä¸€ç»„å·¥å…·ï¼ˆä¸»è¦ç”¨perlç¼–å†™ï¼Œæœ‰äº›ç”¨C ++ç¼–å†™ï¼‰ï¼Œå®ƒä»¬é‡‡ç”¨åŸå§‹æ•°æ®ï¼ˆå¹¶è¡Œè¯­æ–™å’Œå•è¯­è¨€ï¼‰å¹¶å°†å…¶è½¬æ¢ä¸ºæœºå™¨ç¿»è¯‘æ¨¡å‹ã€‚è§£ç å™¨æ˜¯ä¸€ä¸ªå•ç‹¬çš„C ++åº”ç”¨ç¨‹åºï¼Œç»™å®šä¸€ä¸ªè®­ç»ƒæœ‰ç´ çš„æœºå™¨ç¿»è¯‘æ¨¡å‹å’Œæºå¥å­ï¼Œå°†æºè¯­å¥ç¿»è¯‘æˆç›®æ ‡è¯­è¨€ã€‚</p>

<p>1.åŸ¹è®­ç®¡é“ï¼š</p>

<p>ä»åŸ¹è®­æ•°æ®ç”Ÿæˆç¿»è¯‘ç³»ç»Ÿæ¶‰åŠå„ä¸ªé˜¶æ®µï¼Œè¿™äº›é˜¶æ®µåœ¨åŸ¹è®­æ–‡æ¡£å’ŒåŸºçº¿ç³»ç»ŸæŒ‡å—ä¸­æœ‰æ›´è¯¦ç»†çš„æè¿°ã€‚è¿™äº›ä½œä¸ºç®¡é“è¢«å®Œæˆï¼Œå¹¶ä¸”å¯ç”±æ‘©è¥¿å®éªŒç®¡ç†ç³»ç»Ÿæ‰€æ§åˆ¶ï¼Œè€ŒMosesé€šå¸¸å¯ä»¥è½»æ¾åœ°å°†ä¸åŒç±»å‹çš„å¤–éƒ¨å·¥å…·æ’å…¥åˆ°åŸ¹è®­ç®¡é“ä¸­</p>

<p>æ•°æ®åœ¨è¢«ç”¨äºè®­ç»ƒä¹‹å‰éœ€è¦åšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œæ ‡è®°æ–‡æœ¬å¹¶ä¸”å°†æ ‡è®°è½¬æ¢ä¸ºæ ‡å‡†æ¡ˆä¾‹ã€‚å¯å‘å¼ç”¨äºåˆ é™¤çœ‹èµ·æ¥æœªå¯¹é½çš„å¥å­å¯¹ï¼Œå¹¶åˆ é™¤é•¿å¥å­ã€‚ç„¶åï¼Œå¹¶è¡Œçš„å¥å­éœ€è¦è¯å¯¹é½ï¼Œé€šå¸¸ä½¿ç”¨ GIZA ++æ¥å®Œæˆï¼Œå®ƒå®ç°äº†80å¹´ä»£åœ¨IBMå¼€å‘çš„ä¸€ç»„ç»Ÿè®¡æ¨¡å‹ã€‚è¿™äº›è¯å¯¹é½è¢«ç”¨äºæ ¹æ®éœ€è¦æå–çŸ­è¯­-çŸ­è¯­ç¿»è¯‘æˆ–åˆ†å±‚è§„åˆ™ï¼Œå¹¶ä¸”ä½¿ç”¨è¿™äº›è§„åˆ™çš„è¯­æ–™åº“èŒƒå›´ç»Ÿè®¡æ¥ä¼°è®¡æ¦‚ç‡ã€‚</p>

<p>ç¿»è¯‘ç³»ç»Ÿçš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†æ˜¯è¯­è¨€æ¨¡å‹ï¼Œä¸€ç§ä½¿ç”¨ç›®æ ‡è¯­è¨€ä¸­çš„å•è¯­è¨€æ•°æ®æ„å»ºçš„ç»Ÿè®¡æ¨¡å‹ï¼Œå¹¶ç”±è§£ç å™¨ç”¨æ¥å°è¯•ç¡®ä¿è¾“å‡ºçš„æµç•…æ€§ã€‚æ‘©è¥¿ä¾é <a href="http://www.statmt.org/moses/?n=FactoredTraining.BuildingLanguageModel">å¤–éƒ¨å·¥å…·</a>ï¼ˆhttp://www.statmt.org/moses/?n=FactoredTraining.BuildingLanguageModelï¼‰è¿›è¡Œè¯­è¨€æ¨¡å‹æ„å»ºã€‚</p>

<p>åˆ›å»ºæœºå™¨ç¿»è¯‘ç³»ç»Ÿçš„æœ€åä¸€æ­¥æ˜¯<em>è°ƒä¼˜</em>ï¼Œå…¶ä¸­ä¸åŒçš„ç»Ÿè®¡æ¨¡å‹ç›¸äº’åŠ æƒä»¥äº§ç”Ÿæœ€ä½³å¯èƒ½çš„ç¿»è¯‘ã€‚æ‘©è¥¿ç³»ç»ŸåŒ…å«äº†æœ€æµè¡Œçš„è°ƒä¼˜ç®—æ³•çš„å®ç°ã€‚</p>

<p>2.è§£ç å™¨</p>

<p>æ‘©è¥¿è§£ç å™¨çš„å·¥ä½œæ˜¯æ‰¾åˆ°ä¸ç»™å®šæºå¥å­ç›¸å¯¹åº”çš„ç›®æ ‡è¯­è¨€ï¼ˆæ ¹æ®ç¿»è¯‘æ¨¡å‹ï¼‰çš„æœ€é«˜è¯„åˆ†å¥å­ã€‚è§£ç å™¨è¿˜å¯ä»¥è¾“å‡ºå€™é€‰çš„ç¿»è¯‘çš„ä»å¥½åˆ°åçš„æ’åºåˆ—è¡¨ï¼Œå¹¶ä¸”è¿˜æä¾›å…³äºå…¶å¦‚ä½•åšå‡ºå†³ç­–çš„å„ç§ç±»å‹çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œå®ƒä½¿ç”¨çš„çŸ­è¯­-çŸ­è¯­å¯¹åº”å…³ç³»ï¼‰ã€‚</p>

<p>è§£ç å™¨ä»¥æ¨¡å—åŒ–æ–¹å¼ç¼–å†™ï¼Œå¹¶å…è®¸ç”¨æˆ·ä»¥å„ç§æ–¹å¼æ”¹å˜è§£ç è¿‡ç¨‹ï¼Œä¾‹å¦‚ï¼š</p>

<ul>
  <li>è¾“å…¥ï¼šè¿™å¯ä»¥æ˜¯ä¸€ä¸ªç®€å•çš„å¥å­ï¼Œæˆ–è€…å®ƒå¯ä»¥ç”¨ç±»ä¼¼xmlçš„å…ƒç´ çš„æ³¨é‡Šæ¥æŒ‡å¯¼ç¿»è¯‘è¿‡ç¨‹ï¼Œæˆ–è€…å®ƒå¯ä»¥æ˜¯æ›´å¤æ‚çš„ç»“æ„ï¼Œå¦‚æ ¼å­æˆ–æ··æ·†ç½‘ç»œï¼ˆä¾‹å¦‚ï¼Œä»è¯­éŸ³è¯†åˆ«çš„è¾“å‡ºï¼‰</li>
  <li>ç¿»è¯‘æ¨¡å‹ï¼šè¿™å¯ä»¥ä½¿ç”¨çŸ­è¯­-çŸ­è¯­è§„åˆ™æˆ–åˆ†å±‚ï¼ˆä¹Ÿå¯èƒ½æ˜¯å¥æ³•ï¼‰è§„åˆ™ã€‚å®ƒå¯ä»¥ç¼–è¯‘æˆäºŒè¿›åˆ¶å½¢å¼ï¼Œä»¥åŠ å¿«åŠ è½½é€Ÿåº¦ã€‚å®ƒå¯ä»¥é€šè¿‡å°†é¢å¤–çš„ä¿¡æ¯æ·»åŠ åˆ°ç¿»è¯‘è¿‡ç¨‹ä¸­æ¥è¡¥å……ä¸€äº›ç‰¹æ€§ï¼Œä¾‹å¦‚é˜æ˜çŸ­è¯­å¯¹çš„æ¥æºä»¥æ§åˆ¶ä»–ä»¬çš„å¯é æ€§çš„ç‰¹æ€§ã€‚</li>
  <li>è§£ç ç®—æ³•ï¼šè§£ç é—®é¢˜æ˜¯ä¸€ä¸ªå·¨å‹çš„æœç´¢é—®é¢˜ï¼Œé€šå¸¸å¯¹äºç²¾ç¡®æœç´¢æ¥è¯´å¤ªå¤§äº†ï¼Œè€Œä¸”Mosesä¸ºè¿™ç§æœç´¢å®ç°äº†å‡ ç§ä¸åŒçš„ç­–ç•¥ï¼Œä¾‹å¦‚åŸºäºå †æ ˆï¼Œç«‹æ–¹ä½“ä¿®å‰ªï¼Œå›¾è¡¨è§£æç­‰ã€‚</li>
  <li>è¯­è¨€æ¨¡å‹ï¼š Mosesæ”¯æŒå‡ ç§ä¸åŒçš„è¯­è¨€æ¨¡å‹å·¥å…·åŒ…ï¼ˆSRILMï¼ŒKenLMï¼ŒIRSTLMï¼ŒRandLMï¼‰ï¼Œæ¯ç§å·¥å…·åŒ…éƒ½æœ‰è‡ªå·±çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„LMå·¥å…·åŒ…å¾ˆç®€å•ã€‚</li>
</ul>

<p>Mosesè§£ç å™¨è¿˜æ”¯æŒå¤šçº¿ç¨‹è§£ç ï¼ˆå› ä¸ºç¿»è¯‘å…·æœ‰<a href="https://en.wikipedia.org/wiki/Embarrassingly_parallel">å¾ˆé«˜çš„çš„å¹¶è¡Œæ€§</a>ï¼‰ï¼Œå¹¶ä¸”å¦‚æœæ‚¨æœ‰æƒè®¿é—®ç¾¤é›†æœåŠ¡å™¨ï¼Œæ‘©è¥¿æä¾›å¯ç”¨å¤šè¿›ç¨‹è§£ç çš„è„šæœ¬ã€‚</p>

<h2 id="è´¡çŒ®å·¥å…·">è´¡çŒ®å·¥å…·</h2>

<p>æ‘©è¥¿æœ‰è®¸å¤šè´¡çŒ®å·¥å…·ï¼Œå®ƒä»¬æä¾›é¢å¤–çš„åŠŸèƒ½å’Œè¶…è¶Šæ ‡å‡†è®­ç»ƒå’Œè§£ç ç®¡é“çš„é™„åŠ åŠŸèƒ½ã€‚è¿™äº›åŒ…æ‹¬ï¼š</p>

<ul>
  <li>MosesæœåŠ¡å™¨ï¼šä¸ºè§£ç å™¨æä¾›xml-rpcæ¥å£ï¼Œéœ€è¦å®‰è£…xmlrpc-cã€‚</li>
  <li>Webç¿»è¯‘ï¼šä¸€ç»„è„šæœ¬ï¼Œä½¿Moseså¯ç”¨äºç¿»è¯‘ç½‘é¡µ</li>
  <li>åˆ†æå·¥å…·ï¼šä¸å‚è€ƒæ–‡çŒ®ç›¸æ¯”ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥å¯¹æ‘©è¥¿è¾“å‡ºè¿›è¡Œåˆ†æå’Œå¯è§†åŒ–çš„è„šæœ¬ã€‚</li>
</ul>

<p>è¿˜æœ‰ç”¨äºè¯„ä¼°ç¿»è¯‘çš„å·¥å…·ï¼Œæ›¿ä»£çŸ­è¯­è¯„åˆ†æ–¹æ³•ï¼Œç”¨äºåŠ æƒçŸ­è¯­è¡¨çš„æŠ€æœ¯çš„å®ç°ï¼Œç”¨äºå‡å°çŸ­è¯­è¡¨çš„è§„æ¨¡çš„å·¥å…·ä»¥åŠå…¶ä»–è´¡çŒ®å·¥å…·ã€‚</p>

<h2 id="ä¸€-å®‰è£…ç›¸å…³ä¾èµ–é¡¹">ä¸€ å®‰è£…ç›¸å…³ä¾èµ–é¡¹ï¼š</h2>

<p>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ç”¨æ¥æ­å»ºMosesç³»ç»Ÿçš„æœåŠ¡å™¨ç¯å¢ƒå¦‚ä¸‹ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 root<span class="se">\@</span>VM-0-15-ubuntu:/home/ubuntu/mosesdecoder<span class="se">\#</span> lsb_release <span class="nt">-a</span> No LSB modules are available. Distributor ID: Ubuntu Description: Ubuntu 16.04.4 LTS Release: 16.04 Codename: xenial 
</code></pre></div></div>

<p>å®‰è£…å¦‚ä¸‹ä¾èµ–ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 <span class="nb">sudo </span>apt-get <span class="nb">install </span>build-essential git-core pkg-config automake libtool wget zlib1g-dev python-dev libbz2-dev 
</code></pre></div></div>

<p>ä»Githubå…‹éš†Mosesï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 git clone &lt;https://github.com/moses-smt/mosesdecoder.git&gt; <span class="nb">cd </span>mosesdecoder 
</code></pre></div></div>

<p>è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…æœ€æ–°çš„booståº“ï¼Œcmph (for CompactPTï¼Œå³C Minimal Perfect Hashing Library), irstlm (language model from FBK, required to pass the regression tests),å’Œ xmlrpc-c (for moses server)ã€‚è¿™äº›éƒ½ä¼šé»˜è®¤å®‰è£…åœ¨ä½ çš„å½“å‰å·¥ä½œç›®å½•çš„./optè·¯å¾„ã€‚å…¶ä¸­xmlrpcä¸æ˜¯å¿…é¡»ï¼Œä½†æ˜¯å¦‚æœå°†mosesä½œä¸ºæœåŠ¡æä¾›å¿…é¡»å®‰è£…xmlrpcã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 make <span class="nt">-f</span> contrib/Makefiles/install-dependencies.gmake 
</code></pre></div></div>

<p>ç¼–è¯‘Mosesï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 ./compile.sh <span class="o">[</span>additional options] <span class="se">\-</span><span class="nt">-prefix</span><span class="o">=</span>/destination/path <span class="nt">--install-scripts</span> å®‰è£…åˆ°å…¶ä»–ç›®å½• <span class="se">\-</span><span class="nt">-with-mm</span> ä½¿ç”¨åŸºäºåç¼€æ•°ç»„çš„çŸ­è¯­è¡¨ 
</code></pre></div></div>

<p>å…¶ä¸­ï¼ŒMOSES SERVERä½¿ä½ å¯ä»¥æŠŠMOSESè§£ç å™¨ä½œä¸ºä¸€ä¸ªæœåŠ¡å™¨è¿›ç¨‹æ¥è¿è¡Œï¼Œå‘é€ç»™å…¶çš„å¥å­å°†é€šè¿‡XMLRPCæ¥ç¿»è¯‘ã€‚è¿™æ„å‘³ç€æ— è®ºå®¢æˆ·ä½¿ç”¨java,python,perl,phpè¿˜æ˜¯å…¶å®ƒåˆ«çš„XMLRPCé›†åˆé‡Œæœ‰çš„è¯­è¨€æ¥ç¼–ç ï¼ŒMOSESè¿›ç¨‹éƒ½å¯ä»¥æœåŠ¡å®¢æˆ·ä¸”åˆ†å¸ƒå¼åœ°æœåŠ¡å®¢æˆ·ã€‚</p>

<p>XMLRPCæ˜¯Userland Softwareå…¬å¸è®¾è®¡çš„ä¸€ç§æ ¼å¼ï¼šæ˜¯ä¸€ç§ä½¿ç”¨HTTPåè®®ä¼ è¾“XMLæ ¼å¼æ–‡ä»¶æ¥è·å–è¿œç¨‹ç¨‹åºè°ƒç”¨ï¼ˆRemote Procedure Callï¼‰çš„ä¼ è¾“æ–¹å¼ã€‚è¿œç¨‹ç¨‹åºè°ƒç”¨ç®€å•åœ°è®²æ˜¯æŒ‡ï¼Œä¸€å°æœºå™¨é€šè¿‡ç½‘ç»œè°ƒç”¨å¦ä¸€å°æœºå™¨é‡Œçš„åº”ç”¨ç¨‹åºï¼ŒåŒæ—¶å°†æ‰§è¡Œç»“æœè¿”å›ã€‚ä¸€èˆ¬ä¸€å°æœºå™¨ä½œä¸ºæœåŠ¡å™¨ç«¯ï¼Œå¦ä¸€å°ä½œä¸ºå®¢æˆ·ç«¯ã€‚æœåŠ¡å™¨ç«¯éœ€è¦è½®è¯¢æ˜¯å¦æœ‰å®¢æˆ·ç«¯è¿›è¡ŒRPCè¯·æ±‚ã€‚ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚ä¸€å°æœåŠ¡å™¨æä¾›æŸ¥è¯¢å½“å‰æ—¶é—´çš„RPCæœåŠ¡ã€‚å…¶ä»–ä»»ä½•ä¸€å°æœºå™¨é€šè¿‡ç½‘ç»œï¼Œä½¿ç”¨å®¢æˆ·ç«¯ï¼Œéƒ½å¯ä»¥åˆ°è¯¥æœåŠ¡å™¨æŸ¥è¯¢å½“å‰çš„æ—¶é—´ã€‚</p>

<p>MLRPCæ˜¯RPCæœºåˆ¶çš„å®ç°æ–¹å¼ä¹‹ä¸€ã€‚é‡‡ç”¨XMLè¯­è¨€ä½œä¸ºæœåŠ¡å™¨ä¸å®¢æˆ·ç«¯çš„æ•°æ®äº¤äº’æ ¼å¼ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…é˜…è¯»ã€‚XMLRPCå¯ä»¥ç”¨å¾ˆå¤šç§è¯­è¨€å®ç°ï¼ŒåŒ…æ‹¬perlï¼Œphyonï¼Œcç­‰ã€‚ä½¿ç”¨cä¸c++å®ç°çš„åº“ï¼Œå°±æ˜¯XMLRPC-cã€‚</p>

<p>Boost 1.48ç‰ˆæœ¬åœ¨ç¼–è¯‘Mosesæ—¶ä¼šå‡ºç°ä¸€ä¸ªä¸¥é‡çš„bugã€‚åœ¨æœ‰äº›Linuxçš„åˆ†å‘ç‰ˆæœ¬ä¸­ï¼Œæ¯”å¦‚Ubuntu 12.04ï¼ŒBooståº“å­˜åœ¨ç€è¿™ç§ç‰ˆæœ¬çš„Booståº“ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¿…é¡»è¦æ‰‹åŠ¨ä¸‹è½½å’Œç¼–è¯‘Boostã€‚</p>

<p>ä¸‹è½½ç¼–è¯‘boostï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 wget &lt;https://dl.bintray.com/boostorg/release/1.64.0/source/boost_1_64_0.tar.gz&gt; <span class="nb">tar </span>zxvf boost_1_64_0.tar.gz <span class="nb">cd </span>boost_1_64_0/ ./bootstrap.sh ./b2 <span class="nt">-j4</span> <span class="nt">--prefix</span><span class="o">=</span><span class="se">\$</span>PWD <span class="nt">--libdir</span><span class="o">=</span><span class="se">\$</span>PWD/lib64 <span class="nt">--layout</span><span class="o">=</span>system <span class="nb">link</span><span class="o">=</span>static <span class="nb">install</span> <span class="se">\|\|</span> <span class="nb">echo </span>FAILURE <span class="se">\#</span>æˆ–è€…æ‰§è¡Œ./b2å®‰è£…åœ¨å½“å‰ç›®å½•ä¸‹ 
</code></pre></div></div>

<p>ä¸Šè¿°å‘½ä»¤åœ¨æ–‡ä»¶å¤¹lib64ä¸­åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸æ˜¯åœ¨ç³»ç»Ÿç›®å½•ä¸‹ã€‚å› æ­¤ï¼Œä½ ä¸å¿…ä½¿ç”¨ç³»ç»Ÿrootæƒé™æ¥æ‰§è¡Œä¸Šè¿°å‘½ä»¤ã€‚ç„¶è€Œï¼Œä½ éœ€è¦å‘Šè¯‰Moseså¦‚ä½•æ‰¾åˆ°boostã€‚å½“boostè¢«æš—è´¦å¥½ä»¥åï¼Œä½ å¯ä»¥å¼€å§‹ç¼–è¯‘Mosesï¼Œä½ éœ€è¦ç”¨ â€“with-boostæ ‡è®°å‘Šè¯‰Mosesç³»ç»Ÿ boostå®‰è£…åœ¨å“ªé‡Œã€‚</p>

<p>ä¸‹è½½å®‰è£…cmph:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 13 wget http://www.mirrorservice.org/sites/download.sourceforge.net/pub/sourceforge/c/cm/cmph/cmph/cmph-2.0.tar.gz <span class="nb">tar </span>zxvf cmph-2.0.tar.gz <span class="nb">cd cd </span>cmph-2.0/ ./configure <span class="nt">--prefix</span><span class="o">=</span> /usr/local/cmph <span class="se">\#</span>æŒ‡å®šå®‰è£…è·¯å¾„ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©äº†/usr/local/cmph Make Make <span class="nb">install</span> 
</code></pre></div></div>

<p>ä¸‹è½½å®‰è£…xmlrpc-cï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 wget https://launchpad.net/ubuntu/+archive/primary/+sourcefiles/xmlrpc-c/1.33.14-8build1/xmlrpc-c_1.33.14.orig.tar.gz <span class="nb">tar </span>zxvf xmlrpc-c_1.33.14.orig.tar.gz <span class="nb">cd </span>xmlrpc-c-1.33.14/ ./configure <span class="nt">--prefix</span><span class="o">=</span> /usr/local/xmlrpc-c <span class="se">\#</span>æŒ‡å®šå®‰è£…è·¯å¾„ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©äº†/usr/local/xmlrpc-c Make Make <span class="nb">install</span> 
</code></pre></div></div>

<p>æ¥ä¸‹æ¥ï¼Œç”¨bjamç¼–è¯‘Mosesï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 ./bjam <span class="nt">--with-boost</span><span class="o">=</span>/home/ubuntu/boost_1_64_0 <span class="nt">--with-cmph</span><span class="o">=</span>/usr/local/cmph <span class="nt">--with-xmlrpc-c</span><span class="o">=</span>/usr/local/xmlrpc-c <span class="nt">-j4</span> 
</code></pre></div></div>

<p>æ³¨æ„ï¼š â€“with-boost åçš„è·¯å¾„ä¸ºä½ è‡ªå·±å®‰è£…æ—¶æŒ‡å®šçš„è·¯å¾„ï¼Œ-j4 ç”¨äºæŒ‡å®šæ ¸å¿ƒæ•°ã€‚Moseså¯é€‰çš„è¯­è¨€æ¨¡å‹æœ‰IRSTLMï¼ŒSRILMï¼ŒKenLM.å…¶ä¸­ï¼ŒKenLMå·²ç»é»˜è®¤åŒ…å«åœ¨Moseså·¥å…·åŒ…ä¸­ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨Mosesè‡ªå¸¦çš„è¯­è¨€æ¨¡å‹å·¥å…·KenLMï¼Œä¸å†å®‰è£…irstlmã€‚</p>

<h2 id="äºŒ-å®‰è£…è¯å¯¹é½å·¥å…·giza">äºŒ å®‰è£…è¯å¯¹é½å·¥å…·GIZA++</h2>

<p>æ¥ä¸‹æ¥ï¼Œå®‰è£…è¯å¯¹é½å·¥å…·GIZA++ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 git clone &lt;https://github.com/moses-smt/giza-pp.git&gt; <span class="nb">cd </span>giza-pp make 
</code></pre></div></div>

<p>ç¼–è¯‘å®Œæˆåï¼Œå°†ç”Ÿæˆä¸‰ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼š</p>

<p>Â· giza-pp/GIZA++-v2/GIZA++</p>

<p>Â· giza-pp/GIZA++-v2/snt2cooc.out</p>

<p>Â· giza-pp/mkcls-v2/mkcls</p>

<p>è®°å¾—åœ¨ç¼–è¯‘å®Œä¹‹åå°†ä¸Šé¢çš„ä¸‰ä¸ªæ–‡ä»¶æ‹·åˆ°ä¸€ä¸ªç›®å½•ä¸‹ï¼Œä¾¿äºè®¿é—®ä½¿ç”¨ã€‚å¦‚ä¸‹é¢çš„å‘½ä»¤æ‰€ç¤ºï¼Œæˆ‘æ˜¯ç›´æ¥å°†å…¶æ”¾åœ¨toolsæ–‡ä»¶å¤¹ä¸‹çš„ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 <span class="nb">cd</span> <span class="se">\~</span>/mosesdecoder <span class="nb">mkdir </span>tools <span class="nb">cp</span> <span class="se">\~</span>/giza-pp/GIZA++-v2/GIZA++ <span class="se">\~</span>/giza-pp/GIZA++-v2/snt2cooc.out <span class="se">\\</span> <span class="se">\~</span>/giza-pp/mkcls-v2/mkcls tools 
</code></pre></div></div>

<p>ç¼–è¯‘åˆ›å»ºå¥½GIZA++åï¼Œæœ‰ä¸¤ç§æ–¹å¼æ¥ä½¿ç”¨å®ƒï¼Œä¸€æ˜¯åœ¨ç¼–è¯‘Mosesæ—¶å°†GIZA++çš„åœ°å€ä½œä¸ºé€‰é¡¹å‚æ•°ã€‚å¦‚æœåœ¨ç¼–è¯‘Mosesæ—¶æ²¡æœ‰æŒ‡å®šGIZA++çš„åœ°å€ï¼Œå¯ä»¥é‡‡ç”¨å¦å¤–ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£å°±æ˜¯åœ¨è®­ç»ƒè¯­è¨€æ¨¡å‹æ—¶æŒ‡æ˜GIZA++ä¸‰ä¸ªå¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼Œä¾‹å¦‚ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 train-model.perl <span class="nt">-external-bin-dir</span> <span class="se">\$</span>HOME/external-bin-dir æˆ‘åœ¨å®é™…æ“ä½œä¸­ï¼Œé‡‡ç”¨çš„æ˜¯ç¬¬äºŒç§æ–¹æ³•ï¼Œå³åœ¨ä½¿ç”¨Mosesæ—¶ï¼Œç»™ä¸€ä¸ªå‚æ•°æŒ‡æ˜GIZA++è·¯å¾„ã€‚ 
</code></pre></div></div>

<h2 id="ä¸‰-è¯­æ–™å‡†å¤‡">ä¸‰ è¯­æ–™å‡†å¤‡</h2>

<p>æ¥ä¸‹æ¥ï¼Œå‡†å¤‡å¹³è¡Œè¯­æ–™ï¼š</p>

<p>æˆ‘çš„è‹±æ±‰å¹³è¡Œè¯­æ–™æ¥è‡ªè”åˆå›½çš„ç½‘ç«™æä¾›çš„è‹±æ±‰å¹³è¡Œè¯­æ–™ï¼Œï¼ˆhttps://conferences.unite.un.org/uncorpus/zhï¼‰ï¼Œå¤§çº¦1600ä¸‡å¯¹ã€‚å› æˆ‘ä½¿ç”¨çš„æœåŠ¡å™¨å†…å­˜åªæœ‰4Gï¼Œæ‰€ä»¥å°†åŸæ–‡ä»¶åˆ†æˆ30ä»½ï¼Œä»ä¸­æˆªå–äº†çº¦60ä¸‡å¯¹ç”¨æ¥åšæ­¤æ¬¡å®éªŒã€‚</p>

<p>æˆ‘ä»¬çš„è‹±æ–‡è¯­æ–™ä¸ºï¼šun_en-zh23.enï¼Œæ±‰è¯­è¯­æ–™ä¸ºï¼šun_en-zh23.cnã€‚</p>

<p>åœ¨å‡†å¤‡è®­ç»ƒç¿»è¯‘ç³»ç»Ÿä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¯­æ–™åšå¦‚ä¸‹çš„å¤„ç†ï¼š</p>

<ol>
  <li><strong>tokenisationï¼š</strong>è¿™ä¸€æ­¥ä¸»è¦æ˜¯åœ¨å•è¯å’Œå•è¯ä¹‹é—´æˆ–è€…å•è¯å’Œæ ‡ç‚¹ä¹‹é—´æ’å…¥ç©ºç™½ï¼Œä»¥ä¾¿äºåç»­è¯†åˆ«å’Œå…¶ä»–æ“ä½œã€‚</li>
</ol>

<p>å¯¹äºè‹±æ–‡è¯­æ–™ï¼Œæˆ‘ä»¬è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 <span class="se">\~</span>/mosesdecoder/scripts/tokenizer/tokenizer.perl <span class="nt">-l</span> en <span class="se">\\</span> <span class="se">\&lt;</span> <span class="se">\~</span>/corpus/training/un_en-zh23.en <span class="se">\\</span> <span class="se">\&gt;</span> <span class="se">\~</span>/corpus/un_en-zh23.tok.en 
</code></pre></div></div>

<blockquote>
  <p>æ³¨ï¼šå‘½ä»¤å½“ä¸­çš„~ä¸ºMosesdecoderçš„å®‰è£…è·¯å¾„å’Œè¯­æ–™æ‰€åœ¨çš„å…·ä½“è·¯å¾„ï¼Œä¸‹åŒ</p>
</blockquote>

<p>å¯¹äºæ±‰è¯­è¯­æ–™ã€‚æˆ‘ä»¬éœ€è¦è¿›è¡Œåˆ†è¯ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨æ¸…åå¤§å­¦è‡ªç„¶è¯­è¨€å¤„ç†ä¸ç¤¾ä¼šäººæ–‡è®¡ç®—å®éªŒå®¤ç ”åˆ¶æ¨å‡ºçš„ä¸­æ–‡è¯æ³•åˆ†æå·¥å…·åŒ…ï¼ˆ<a href="http://thulac.thunlp.orgï¼‰ï¼Œå…·æœ‰ä¸­æ–‡åˆ†è¯å’Œè¯æ€§æ ‡æ³¨åŠŸèƒ½ã€‚å…·æœ‰èƒ½åŠ›å¼ºï¼Œå‡†ç¡®ç‡é«˜ï¼Œé€Ÿåº¦å¿«çš„ç‰¹ç‚¹ã€‚å…·ä½“ä½¿ç”¨æ–¹æ³•è¯·å‚ç…§ç½‘é¡µã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨Pythonç‰ˆæœ¬æ¥å¯¹ä¸­æ–‡è¯­æ–™è¿›è¡Œåˆ†è¯ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š/">http://thulac.thunlp.orgï¼‰ï¼Œå…·æœ‰ä¸­æ–‡åˆ†è¯å’Œè¯æ€§æ ‡æ³¨åŠŸèƒ½ã€‚å…·æœ‰èƒ½åŠ›å¼ºï¼Œå‡†ç¡®ç‡é«˜ï¼Œé€Ÿåº¦å¿«çš„ç‰¹ç‚¹ã€‚å…·ä½“ä½¿ç”¨æ–¹æ³•è¯·å‚ç…§ç½‘é¡µã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨Pythonç‰ˆæœ¬æ¥å¯¹ä¸­æ–‡è¯­æ–™è¿›è¡Œåˆ†è¯ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 import thulac <span class="nv">thu1</span><span class="o">=</span>thulac.thulac<span class="o">(</span><span class="nv">user_dict</span><span class="o">=</span><span class="s2">"/home/ubuntu/corpus/un_en-zh_23/dict.txt"</span>,seg_only<span class="o">=</span>True<span class="o">)</span> <span class="se">\#</span>åªè¿›è¡Œåˆ†è¯ï¼Œä¸è¿›è¡Œè¯æ€§æ ‡æ³¨ thu1.cut_f<span class="o">(</span><span class="s2">"/home/ubuntu/corpus/un_en-zh_23/un_en-zh23.cn"</span>, <span class="s2">"/home/ubuntu/corpus/un_en-zh_23/un_en-zh23.fc"</span><span class="o">)</span> <span class="se">\#</span>å¯¹un_en-zh23.cnæ–‡ä»¶å†…å®¹è¿›è¡Œåˆ†è¯ï¼Œè¾“å‡ºåˆ°un_en-zh23.fc 
</code></pre></div></div>

<blockquote>
  <p>ç»è¿‡tokenisationï¼Œæˆ‘ä»¬å¾—åˆ°un_en-zh23.fcå’Œun_en-zh23.tok.enä¸¤ä¸ªæ–‡ä»¶ã€‚</p>
</blockquote>

<ol>
  <li>truecaseï¼šåˆå§‹æ¯å¥è¯çš„å­—å’Œè¯ç»„éƒ½è¢«è½¬æ¢ä¸ºæ²¡æœ‰æ ¼å¼çš„å½¢å¼(ä¾‹å¦‚ç»Ÿä¸€ä¸ºå°å†™ï¼‰ã€‚è¿™æœ‰åŠ©äºå‡å°‘æ•°æ®ç¨€ç–æ€§é—®é¢˜ã€‚</li>
</ol>

<blockquote>
  <p>Truecaseé¦–å…ˆéœ€è¦è®­ç»ƒï¼Œä»¥ä¾¿æå–å…³äºæ–‡æœ¬çš„ä¸€äº›ç»Ÿè®¡ä¿¡æ¯</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 13 <span class="se">\~</span>/mosesdecoder/scripts/recaser/train-truecaser.perl <span class="se">\\</span> <span class="se">\-</span><span class="nt">-model</span> <span class="se">\~</span>/corpus/truecase-model.en <span class="nt">--corpus</span> <span class="se">\\</span> <span class="se">\~</span>/corpus/ un_en-zh23.tok.en <span class="se">\~</span>/mosesdecoder/scripts/recaser/train-truecaser.perl <span class="se">\\</span> <span class="se">\-</span><span class="nt">-model</span> <span class="se">\~</span>/corpus/truecase-model.cn <span class="nt">--corpus</span> <span class="se">\\</span> <span class="se">\~</span>/corpus/ un_en-zh23.fc 
</code></pre></div></div>

<blockquote>
  <p>ç»è¿‡æ­¤æ­¥ï¼Œæˆ‘ä»¬å¾—åˆ°truecase-model.enå’Œtruecase-model.cnä¸¤ä¸ªæ–‡ä»¶ã€‚</p>
</blockquote>

<blockquote>
  <p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¹tokenisationåçš„æ–‡ä»¶è¿›è¡Œtruecaseï¼š</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <span class="se">\~</span>/mosesdecoder/scripts/recaser/truecase.perl <span class="se">\\</span> <span class="se">\-</span><span class="nt">-model</span> <span class="se">\~</span>/corpus/truecase-model.en <span class="se">\\</span> <span class="se">\&lt;</span> <span class="se">\~</span>/corpus/ un_en-zh23.tok.en <span class="se">\\</span> <span class="se">\&gt;</span> <span class="se">\~</span>/corpus/ un_en-zh23.true.en <span class="se">\~</span>/mosesdecoder/scripts/recaser/truecase.perl <span class="se">\\</span> <span class="se">\-</span><span class="nt">-model</span> <span class="se">\~</span>/corpus/truecase-model.cn <span class="se">\\</span> <span class="se">\&lt;</span> <span class="se">\~</span>/corpus/ un_en-zh23.fc <span class="se">\\</span> <span class="se">\&gt;</span> <span class="se">\~</span>/corpus/un_en-zh23.true.cn 
</code></pre></div></div>

<p>ç»è¿‡truecaseï¼Œæˆ‘ä»¬å¾—åˆ°un_en-zh23.true.cnå’Œun_en-zh23.true.enä¸¤ä¸ªæ–‡ä»¶ã€‚</p>

<p>\3. cleaningï¼šé•¿å¥å’Œç©ºè¯­å¥å¯å¼•èµ·è®­ç»ƒè¿‡ç¨‹ä¸­çš„é—®é¢˜ï¼Œå› æ­¤å°†å…¶åˆ é™¤ï¼ŒåŒæ—¶åˆ é™¤æ˜æ˜¾ä¸å¯¹é½çš„å¥å­ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 <span class="se">\~</span>/mosesdecoder/scripts/training/clean-corpus-n.perl <span class="se">\\</span> <span class="se">\~</span>/corpus/ un_en-zh23.true cn en <span class="se">\\</span> <span class="se">\~</span>/corpus/ un_en-zh23.clean 1 80 
</code></pre></div></div>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™å¥å‘½ä»¤ä¼šå¯¹truecase-model.enå’Œtruecase-model.cnä¸¤ä¸ªæ–‡ä»¶åŒæ—¶è¿›è¡Œæ¸…æ´—ã€‚ç»è¿‡cleanï¼Œæˆ‘ä»¬å¾—åˆ°un_en-zh23.clean.enå’Œun_en-zh23.clean.cnä¸¤ä¸ªæ–‡ä»¶ã€‚</p>

<h2 id="å››-è¯­è¨€æ¨¡å‹è®­ç»ƒlanguage-model-training">å›› è¯­è¨€æ¨¡å‹è®­ç»ƒï¼ˆLanguage Model Trainingï¼‰</h2>

<p>è¯­è¨€æ¨¡å‹çš„è®­ç»ƒæ˜¯ä¸ºäº†ä¿è¯èƒ½å¤Ÿäº§ç”Ÿæµåˆ©çš„è¾“å‡ºï¼Œæ‰€ä»¥è¦ç”¨ç›®æ ‡è¯­è¨€æ¥å»ºç«‹ã€‚æœ¬ä¾‹çš„ç›®æ ‡è¯­è¨€æ˜¯æ±‰è¯­ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨Mosesç³»ç»Ÿä¸­å†…ç½®çš„è¯­è¨€è¯­è¨€æ¨¡å‹å·¥å…·KenLMï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ä¸€äº›å¼€æºçš„è¯­è¨€æ¨¡å‹å·¥å…·ï¼Œæ¯”å¦‚ï¼ŒIRSTLMï¼ŒBerkeleyLMï¼ŒSRILMç­‰ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªåˆé€‚çš„3å…ƒæ–‡è¯­è¨€æ¨¡å‹ã€‚</p>

<p>å»ºç«‹æ–‡ä»¶å¤¹lmï¼Œç„¶åè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 <span class="nb">mkdir</span> <span class="se">\~</span>/lm <span class="nb">cd</span> <span class="se">\~</span>/lm <span class="se">\~</span>/mosesdecoder/bin/lmplz <span class="nt">-o</span> 3 <span class="se">\&lt;\~</span>/corpus/ un_en-zh23.true.cn <span class="se">\&gt;</span> un_en-zh23.arpa.cn 
</code></pre></div></div>

<p>ä½ ä¼šçœ‹åˆ°å»ºç«‹è¯­è¨€æ¨¡å‹çš„äº”ä¸ªæ­¥éª¤ï¼š</p>

<p>1/5 Counting and sorting n-grams</p>

<p>2/5 Calculating and sorting adjusted counts</p>

<p>3/5 Calculating and sorting initial probabilities</p>

<p>4/5 Calculating and writing order- interpolated probabilities</p>

<p>5/5 Writing ARPA model =FE Name</p>

<p>æ­¤æ­¥æˆ‘ä»¬ç”Ÿæˆun_en-zh23.arpa.cn æ–‡ä»¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¸ºäº†åŠ è½½çš„æ›´å¿«ä¸€äº›ï¼Œæˆ‘ä»¬ä½¿ç”¨KenLmæ¥å¯¹*.arpa.enæ–‡ä»¶äºŒè¿›åˆ¶åŒ–ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 <span class="se">\~</span>/mosesdecoder/bin/build_binary <span class="se">\\</span> un_en-zh23.arpa.cn <span class="se">\\</span> un_en-zh23.blm.cn 
</code></pre></div></div>

<p>å½“ä½ çœ‹åˆ°ç»¿è‰²çš„SUCCESSå­—æ ·æ—¶è¯´æ˜äºŒè¿›åˆ¶åŒ–å·²ç»æˆåŠŸäº†ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸€æ­¥ä¹‹åé€šè¿‡æŸ¥è¯¢æµ‹è¯•æ¥åˆ¤æ–­è®­ç»ƒçš„æ¨¡å‹æ˜¯å¦æ­£ç¡®ï¼Œè¿è¡Œå¦‚ä¸‹çš„linuxå‘½ä»¤ä½ ä¼šçœ‹åˆ°ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 <span class="se">\$</span> <span class="nb">echo</span> <span class="s2">"æˆ‘ çˆ± åŒ—äº¬ å¤©å®‰é—¨"</span> <span class="se">\\</span> <span class="se">\|</span> <span class="se">\~</span>/mosesdecoder/bin/query un_en-zh23.blm.cn Loading statistics: æˆ‘<span class="o">=</span>8872 2 <span class="nt">-2</span>.282969 çˆ±<span class="o">=</span>18074 1 <span class="nt">-6</span>.466906 åŒ—äº¬<span class="o">=</span>9416 1 <span class="nt">-4</span>.8714185 å¤©å®‰é—¨<span class="o">=</span>0 1 <span class="nt">-6</span>.4878592 <span class="se">\&lt;</span>/s<span class="se">\&gt;</span><span class="o">=</span>2 1 <span class="nt">-2</span>.288369 Total: <span class="nt">-22</span>.397522 OOV: 1 Perplexity including OOVs: 30165.07396388977 Perplexity excluding OOVs: 9493.266676976866 OOVs: 1 Tokens: 5 Name:query VmPeak:151680 kB VmRSS:4088 kB RSSMax:136452 kB user:0.008 sys:0 CPU:0.008 real:0.00995472 
</code></pre></div></div>

<h2 id="äº”-è®­ç»ƒç¿»è¯‘æ¨¡å‹training-the-translation-system">äº” è®­ç»ƒç¿»è¯‘æ¨¡å‹ï¼ˆTraining the Translation Systemï¼‰</h2>

<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿›è¡Œåˆ°æœ€ä¸»è¦çš„ä¸€æ­¥ï¼Œè®­ç»ƒç¿»è¯‘æ¨¡å‹ã€‚åœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬è¿›è¡Œè¯å¯¹é½ï¼ˆç”¨GIZA++ï¼‰ï¼ŒçŸ­è¯­æŠ½å–ï¼Œæ‰“åˆ†ï¼Œåˆ›å»ºè¯æ±‡åŒ–é‡æ–°æ’åºè¡¨ï¼Œå¹¶ä¸”åˆ›å»ºå±äºæˆ‘ä»¬è‡ªå·±çš„æ‘©è¥¿é…ç½®æ–‡ä»¶(moses.ini)ã€‚æˆ‘ä»¬è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 <span class="nb">mkdir</span> <span class="se">\~</span>/working <span class="nb">cd</span> <span class="se">\~</span>/working <span class="nb">nohup nice</span> <span class="se">\~</span>/mosesdecoder/scripts/training/train-model.perl <span class="nt">-root-dir</span> train <span class="se">\\</span> <span class="se">\-</span>corpus <span class="se">\~</span>/corpus/ un_en-zh23.clean <span class="se">\\</span> <span class="se">\-</span>f en <span class="nt">-e</span> cn <span class="nt">-alignment</span> grow-diag-final-and <span class="nt">-reordering</span> msd-bidirectional-fe <span class="se">\\</span> <span class="se">\-</span>lm 0:3:<span class="se">\$</span>HOME/lm/un_en-zh23.blm.cn:8 <span class="se">\\</span> <span class="se">\-</span>external-bin-dir <span class="se">\~</span>/mosesdecoder/tools <span class="se">\&gt;</span>&amp; training.out &amp; 
</code></pre></div></div>

<p>å¦‚æœä½ çš„CPUæ˜¯å¤šæ ¸çš„ï¼Œå»ºè®®ä½ åŠ ä¸Š-cores å‚æ•°æ¥åŠ å¿«è¯å¯¹é½çš„è¿‡ç¨‹ã€‚æ³¨æ„ï¼Œå¦‚æœåœ¨è®­ç»ƒç¿»è¯‘ç³»ç»Ÿçš„è¿‡ç¨‹ä¸­é‡åˆ°äº† Exit code:137é”™è¯¯ï¼Œä¸€èˆ¬æ˜¯å› ä¸ºå†…å­˜ä¸è¶³ï¼Œéœ€è¦å¢å¤§æœåŠ¡å™¨çš„å†…å­˜é…ç½®ã€‚ä¸Šè¿°è¿‡ç¨‹å®Œæˆåï¼Œä½ å¯ä»¥åœ¨~/working/train/model æ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°ä¸€ä¸ªmoses.inié…ç½®æ–‡ä»¶ï¼Œè¿™æ˜¯éœ€è¦åœ¨mosesè§£ç æ—¶ä½¿ç”¨åˆ°çš„ã€‚ä½†è¿™é‡Œæœ‰å‡ ä¸ªé—®é¢˜ï¼Œé¦–å…ˆæ˜¯å®ƒçš„åŠ è½½é€Ÿåº¦å¾ˆæ…¢ï¼Œè¿™ä¸ªé—®é¢˜æˆ‘ä»¬å¯ä»¥é€šè¿‡äºŒå€¼åŒ–(binarising)çŸ­è¯­è¡¨å’ŒçŸ­è¯­é‡æ’åºè¡¨æ¥è§£å†³ï¼Œå³ç¼–è¯‘æˆä¸€ä¸ªå¯ä»¥å¾ˆå¿«åœ°åŠ è½½çš„æ ¼å¼ã€‚ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œè¯¥é…ç½®æ–‡ä»¶ä¸­mosesè§£ç ç³»ç»Ÿç”¨æ¥æƒè¡¡ä¸åŒçš„æ¨¡å‹ä¹‹é—´é‡è¦ç¨‹åº¦çš„æƒé‡ä¿¡æ¯éƒ½æ˜¯åˆšåˆå§‹åŒ–çš„ï¼Œå³éæœ€ä¼˜çš„ï¼Œå¦‚æœä½ ç”¨VIMæ‰“å¼€moses.iniæ–‡ä»¶çœ‹çœ‹çš„è¯ï¼Œä½ ä¼šçœ‹åˆ°å„ç§æƒé‡éƒ½è¢«è®¾ç½®ä¸ºé»˜è®¤å€¼ï¼Œå¦‚0.2ï¼Œ0.3ç­‰ã€‚è¦å¯»æ‰¾æ›´å¥½çš„æƒé‡ï¼Œæˆ‘ä»¬éœ€è¦è°ƒæ•´(tuning)ç¿»è¯‘ç³»ç»Ÿï¼Œå³ä¸‹ä¸€æ­¥ã€‚</p>

<h2 id="å…­-è°ƒä¼˜tuning">å…­ è°ƒä¼˜(Tuning)</h2>

<p>è¿™æ˜¯æ•´ä¸ªè¿‡ç¨‹ä¸­æœ€æ…¢çš„ä¸€æ­¥ï¼ŒTuningéœ€è¦ä¸€å°éƒ¨åˆ†çš„å¹³è¡Œè¯­æ–™ï¼Œä¸è®­ç»ƒæ•°æ®ç›¸åˆ†ç¦»å¼€ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å†æ¬¡ä»è”åˆå›½çš„å¹³è¡Œè¯­æ–™ä¸­æˆªå–ä¸€éƒ¨åˆ†ã€‚æˆ‘ä»¬ç”¨æ¥è°ƒä¼˜çš„è¯­æ–™æ–‡ä»¶åç§°ä¸ºun_dev.cnå’Œun_dev.enã€‚æˆ‘ä»¬å°†ç”¨è¿™ä¸¤ä¸ªæ–‡ä»¶æ¥å®Œæˆè°ƒä¼˜çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä¹‹å‰å¿…é¡»å¯¹ç€ä¸¤ä¸ªæ–‡ä»¶è¿›è¡Œ tokenise å’Œ truecaseã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 <span class="nb">cd</span> <span class="se">\~</span>/corpus <span class="se">\~</span>/mosesdecoder/scripts/tokenizer/tokenizer.perl <span class="nt">-l</span> en <span class="se">\\</span> <span class="se">\&lt;</span> dev/un_dev.en <span class="se">\&gt;</span> un_dev.tok.en 
</code></pre></div></div>

<p>åŒæ ·çš„ï¼Œå¯¹un_dev.cnè¿›è¡Œä¸­æ–‡åˆ†è¯ï¼Œå¾—åˆ°un_dev.fcã€‚</p>

<p>ç„¶åè¿›è¡Œtruecaseï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 <span class="se">\~</span>/mosesdecoder/scripts/recaser/truecase.perl <span class="nt">--model</span> truecase-model.en <span class="se">\\</span> <span class="se">\&lt;</span> un_dev.tok.en <span class="se">\&gt;</span> un_dev.true.en <span class="se">\~</span>/mosesdecoder/scripts/recaser/truecase.perl <span class="nt">--model</span> truecase-model.fr <span class="se">\\</span> <span class="se">\&lt;</span> un_dev.fc <span class="se">\&gt;</span> un_dev.true.cn 
</code></pre></div></div>

<p>ç„¶åå›åˆ°æˆ‘ä»¬ç”¨æ¥è®­ç»ƒçš„ç›®å½•ï¼Œå¼€å§‹è°ƒä¼˜çš„è¿‡ç¨‹ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 <span class="nb">cd</span> <span class="se">\~</span>/working <span class="nb">nohup nice</span> <span class="se">\~</span>/mosesdecoder/scripts/training/mert-moses.pl <span class="se">\\</span> <span class="se">\~</span>/corpus/ un_dev.true.en <span class="se">\~</span>/corpus/ un_dev.true.cn <span class="se">\\</span> <span class="se">\~</span>/mosesdecoder/bin/moses train/model/moses.ini <span class="nt">--mertdir</span> <span class="se">\~</span>/mosesdecoder/bin/ <span class="se">\\</span> &amp;<span class="se">\&gt;</span> mert.out &amp; 
</code></pre></div></div>

<p>å¦‚æœä½ çš„CPUæ˜¯å¤šæ ¸çš„ï¼Œé‚£ä¹ˆç”¨å¤šçº¿ç¨‹æ¥è¿è¡Œæ‘©è¥¿ä¼šæ˜æ˜¾åŠ å¿«é€Ÿåº¦ã€‚åœ¨ä¸Šé¢çš„æœ€åä¸€è¡ŒåŠ ä¸Šâ€“decoder-flags=â€-threads 4â€å¯ä»¥ç”¨å››çº¿ç¨‹æ¥è¿è¡Œè§£ç å™¨ã€‚</p>

<p>æœ€åçš„è°ƒä¼˜ç»“æœæ˜¯ä¸€ä¸ªåŒ…å«è®­ç»ƒæƒé‡çš„iniæ–‡ä»¶ï¼Œå¦‚æœä½ ç”¨çš„è·Ÿæˆ‘ä¸€æ ·çš„ç›®å½•ç»“æ„çš„è¯ï¼Œåº”è¯¥å­˜åœ¨äº~/working/mert- work/moses.iniæ–‡ä»¶å¤¹ä¸­ã€‚</p>

<h2 id="ä¸ƒ-æµ‹è¯•">ä¸ƒ æµ‹è¯•</h2>

<p>æ¥ä¸‹æ¥ä½ å¯ä»¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¥ç¿»è¯‘å¥å­ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 <span class="se">\~</span>/mosesdecoder/bin/moses <span class="nt">-f</span> <span class="se">\~</span>/working/mert-work/moses.ini 
</code></pre></div></div>

<p>è¿è¡Œå‘½ä»¤åï¼Œä¼šå¾—åˆ°ä¸‹é¢çš„æç¤ºï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 Defined parameters <span class="o">(</span>per moses.ini or switch<span class="o">)</span>: config: /home/ubuntu/corpus/un_en-zh_23/working/mert-work/moses.ini distortion-limit: 6 feature: UnknownWordPenalty WordPenalty PhrasePenalty PhraseDictionaryMemory <span class="nv">name</span><span class="o">=</span>TranslationMode l0 num-features<span class="o">=</span>4 <span class="nv">path</span><span class="o">=</span>/home/ubuntu/corpus/un_en-zh_23/working/train/model/phrase-table.gz input-factor<span class="o">=</span>0 output-factor<span class="o">=</span>0 LexicalReordering <span class="nv">name</span><span class="o">=</span>LexicalReordering0 num-features<span class="o">=</span>6 <span class="nb">type</span><span class="o">=</span>wbe-msd-bidirectional-fe-a llff input-factor<span class="o">=</span>0 output-factor<span class="o">=</span>0 <span class="nv">path</span><span class="o">=</span>/home/ubuntu/corpus/un_enzh_23/working/train/model/reordering-t able.wbe-msd-bidirectional-fe.gz Distortion KENLM <span class="nv">name</span><span class="o">=</span>LM0 <span class="nb">factor</span><span class="o">=</span>0 <span class="nv">path</span><span class="o">=</span>/home/ubuntu/corpus/un_en-zh_23/ lm/un_en-zh23.blm.cn <span class="nv">order</span><span class="o">=</span>3 input-factors: 0 mapping: 0 T 0 weight: <span class="nv">LexicalReordering0</span><span class="o">=</span> 0.0614344 0.0245557 0.242242 0.0725016 0.0539617 0.0566553 Distortion <span class="nv">0</span><span class="o">=</span> 0.00534453 <span class="nv">LM0</span><span class="o">=</span> 0.0696027 <span class="nv">WordPenalty0</span><span class="o">=</span> <span class="nt">-0</span>.166007 <span class="nv">PhrasePenalty0</span><span class="o">=</span> 0.0688629 <span class="nv">TranslationModel0</span><span class="o">=</span> 0.03900 17 0.0457273 0.0730895 0.0210141 <span class="nv">UnknownWordPenalty0</span><span class="o">=</span> 1 <span class="nv">line</span><span class="o">=</span>UnknownWordPenalty FeatureFunction: UnknownWordPenalty0 start: 0 end: 0 <span class="nv">line</span><span class="o">=</span>WordPenalty FeatureFunction: WordPenalty0 start: 1 end: 1 <span class="nv">line</span><span class="o">=</span>PhrasePenalty FeatureFunction: PhrasePenalty0 start: 2 end: 2 <span class="nv">line</span><span class="o">=</span>PhraseDictionaryMemory <span class="nv">name</span><span class="o">=</span>TranslationModel0 num-features<span class="o">=</span>4 <span class="nv">path</span><span class="o">=</span>/home/ubuntu/corpus/un_en-zh_23/wo rking/train/model/phrase-table.gz input-factor<span class="o">=</span>0 output-factor<span class="o">=</span>0 FeatureFunction: TranslationModel0 start: 3 end: 6 <span class="nv">line</span><span class="o">=</span>LexicalReordering <span class="nv">name</span><span class="o">=</span>LexicalReordering0 num-features<span class="o">=</span>6 <span class="nb">type</span><span class="o">=</span>wbe-msd-bidirectional-fe-allff input-f <span class="nv">actor</span><span class="o">=</span>0 output-factor<span class="o">=</span>0 <span class="nv">path</span><span class="o">=</span>/home/ubuntu/corpus/un_en-zh_23/working/train/model/reordering-table.wbe-msd <span class="nt">-bidirectional-fe</span>.gz Initializing Lexical Reordering Feature.. FeatureFunction: LexicalReordering0 start: 7 end: 12 <span class="nv">line</span><span class="o">=</span>Distortion FeatureFunction: Distortion0 start: 13 end: 13 <span class="nv">line</span><span class="o">=</span>KENLM <span class="nv">name</span><span class="o">=</span>LM0 <span class="nb">factor</span><span class="o">=</span>0 <span class="nv">path</span><span class="o">=</span>/home/ubuntu/corpus/un_en-zh_23/lm/un_en-zh23.blm.cn <span class="nv">order</span><span class="o">=</span>3 FeatureFunction: LM0 start: 14 end: 14 Loading UnknownWordPenalty0 Loading WordPenalty0 Loading PhrasePenalty0 Loading LexicalReordering0 Loading table into memory...done. Loading Distortion0 Loading LM0 Loading TranslationModel0 Start loading text phrase table. Moses format : <span class="o">[</span>133.871] seconds Reading /home/ubuntu/corpus/un_en-zh_23/working/train/model/phrase-table.gz <span class="se">\-</span><span class="nt">---5---10---15---20---25---30---35---40---45---50---55---60---65---70---75---80---85---90---95--100</span> 
</code></pre></div></div>

<p>è¾“å…¥ä½ å–œæ¬¢çš„è‹±è¯­å¥å­ï¼Œç„¶åæŸ¥çœ‹ç»“æœã€‚ä½ ä¼šæ³¨æ„åˆ°ï¼Œè§£ç å™¨ä¼šè¯è´¹å¾ˆé•¿ä¸€æ®µæ—¶é—´æ¥å¯åŠ¨ã€‚å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ä»¬æ­¤æ¬¡å¯åŠ¨èŠ±è´¹äº†133.871ç§’ï¼Œå¹¶ä¸”CPUå’Œå†…å­˜ä¸€ç›´å¤„äºæ»¡è½½çŠ¶æ€ã€‚ä¸ºäº†è®©è§£ç å™¨å¯åŠ¨çš„æ›´å¿«ä¸€äº›ï¼Œæˆ‘ä»¬å¯ä»¥å°†çŸ­è¯­è¡¨å’Œè¯æ±‡åŒ–å†æ’åºæ¨¡å‹äºŒè¿›åˆ¶åŒ–ã€‚æ³¨æ„ï¼Œbinariseæ“ä½œéœ€è¦ä½¿ç”¨cmphï¼Œå¦‚æœæ²¡æœ‰æŒ‰ç…§æœ¬æ–‡æ¡£äº‹å…ˆå®‰è£…cmphï¼Œåœ¨æ­¤æ—¶æ‰å®‰è£…cmphï¼Œé‚£ä¹ˆå¿…é¡»è¿›å…¥mosesdecoderå®‰è£…æ–‡ä»¶å¤¹é‡æ–°æ‰§è¡Œ./bjamï¼Œå¹¶è¡¥å…¨ç¼–è¯‘å‚æ•°é‡æ–°ç¼–è¯‘mosesã€‚å¦åˆ™æ‰§è¡Œmoses.iniæ—¶ä¼šæŠ¥é”™ã€‚</p>

<p>æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªåˆé€‚çš„ç›®å½•å¹¶ä¸”æŒ‰å¦‚ä¸‹çš„å‘½ä»¤æ¥äºŒè¿›åˆ¶åŒ–æ¨¡å‹ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <span class="nb">mkdir</span> <span class="se">\~</span>/working/binarised-model <span class="nb">cd</span> <span class="se">\~</span>/working <span class="se">\~</span>/mosesdecoder/bin/processPhraseTableMin <span class="se">\\</span> <span class="se">\-</span><span class="k">in </span>train/model/phrase-table.gz <span class="nt">-nscores</span> 4 <span class="se">\\</span> <span class="se">\-</span>out binarised-model/phrase-table <span class="se">\~</span>/mosesdecoder/bin/processLexicalTableMin <span class="se">\\</span> <span class="se">\-</span><span class="k">in </span>train/model/reordering-table.wbe-msd-bidirectional-fe.gz <span class="se">\\</span> <span class="se">\-</span>out binarised-model/reordering-table 
</code></pre></div></div>

<p>è¾“å…¥å‘½ä»¤ï¼Œä½ ä¼šçœ‹åˆ°å¦‚ä¸‹çš„ä¿¡æ¯ï¼Œåˆ†åˆ«æ˜¯å°†çŸ­è¯­è¡¨å’Œé‡æ’åºè¡¨äºŒå€¼åŒ–ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 Used options: Text phrase table will be <span class="nb">read </span>from: train/model/phrase-table.gz Output phrase table will be written to: binarised-model/phrase-table.minphr Step size <span class="k">for </span><span class="nb">source </span>landmark phrases: 2<span class="se">\^</span><span class="nv">10</span><span class="o">=</span>1024 Source phrase fingerprint size: 16 bits / P<span class="o">(</span>fp<span class="o">)=</span>1.52588e-05 Selected target phrase encoding: Huffman + PREnc Maxiumum allowed rank <span class="k">for </span>PREnc: 100 Number of score components <span class="k">in </span>phrase table: 4 Single Huffman code <span class="nb">set </span><span class="k">for </span>score components: no Using score quantization: no Explicitly included alignment information: <span class="nb">yes </span>Running with 1 threads Pass 1/3: Creating <span class="nb">hash </span><span class="k">function for </span>rank assignment ..................................................[5000000] ..................................................[10000000] ... Pass 2/3: Creating <span class="nb">source </span>phrase index + Encoding target phrases ..................................................[5000000] ..................................................[10000000] ... Intermezzo: Calculating Huffman code sets Creating Huffman codes <span class="k">for </span>90037 target phrase symbols Creating Huffman codes <span class="k">for </span>69575 scores Creating Huffman codes <span class="k">for </span>5814858 scores Creating Huffman codes <span class="k">for </span>58305 scores Creating Huffman codes <span class="k">for </span>5407479 scores Creating Huffman codes <span class="k">for </span>50 alignment points Pass 3/3: Compressing target phrases ..................................................[5000000] ..................................................[10000000] ... Saving to binarised-model/phrase-table.minphr Done Used options: Text reordering table will be <span class="nb">read </span>from: train/model/reordering-table.wbe-msd-bidirectional-fe.gz Output reordering table will be written to: binarised-model/reordering-table.minlexr Step size <span class="k">for </span><span class="nb">source </span>landmark phrases: 2<span class="se">\^</span><span class="nv">10</span><span class="o">=</span>1024 Phrase fingerprint size: 16 bits / P<span class="o">(</span>fp<span class="o">)=</span>1.52588e-05 Single Huffman code <span class="nb">set </span><span class="k">for </span>score components: no Using score quantization: no Running with 1 threads Pass 1/2: Creating phrase index + Counting scores ..................................................[5000000] ..................................................[10000000] ..................................................[15000000] ........................ Intermezzo: Calculating Huffman code sets Creating Huffman codes <span class="k">for </span>16117 scores Creating Huffman codes <span class="k">for </span>8771 scores Creating Huffman codes <span class="k">for </span>16117 scores Creating Huffman codes <span class="k">for </span>15936 scores Creating Huffman codes <span class="k">for </span>8975 scores Creating Huffman codes <span class="k">for </span>16122 scores Pass 2/2: Compressing scores ..................................................[5000000] ..................................................[10000000] ..................................................[15000000] ........................ Saving to binarised-model/reordering-table.minlexr Done 
</code></pre></div></div>

<p>æ³¨æ„ï¼šå¦‚æœä½ é‡åˆ°äº†å¦‚ä¸‹çš„é”™è¯¯ï¼Œè¯·ç¡®ä¿ä½ åœ¨åˆšå¼€å§‹ç”¨CMPHæ¥ç¼–è¯‘æ‘©è¥¿ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 ...<span class="se">\~</span>/mosesdecoder/bin/processPhraseTableMin: No such file or directory 
</code></pre></div></div>

<p>å°† ~/working/mert-work/moses.iniå¤åˆ¶åˆ°binarised-model ç›®å½•ä¸­ï¼Œå¹¶ä¸”æ”¹å˜çŸ­è¯­å’Œé‡æ’åºè¡¨ä»¥è®©ä»–ä»¬æŒ‡å‘äºŒè¿›åˆ¶ç‰ˆæœ¬ï¼Œä½ å¯ä»¥æŒ‰å¦‚ä¸‹çš„å‘½ä»¤è¿è¡Œï¼š</p>

<ol>
  <li>å°† binarised-modelç›®å½•ä¸‹çš„Moses.iniæ–‡ä»¶ä¸­çš„# feature functionsä¸€æ ä¸­çš„PhraseDictionaryMemory æ”¹ä¸º PhraseDictionaryCompact</li>
  <li>å°† binarised-modelç›®å½•ä¸‹çš„Moses.iniæ–‡ä»¶ä¸­çš„# feature functionsä¸€æ ä¸­çš„PhraseDictionary çš„è·¯å¾„è®¾ç½®ä¸ºå¦‚ä¸‹ï¼š</li>
</ol>

<p>$HOME/working/binarised-model/phrase-table.minphr</p>

<ol>
  <li>å°† binarised-modelç›®å½•ä¸‹çš„Moses.iniæ–‡ä»¶ä¸­# feature functionsä¸€æ ä¸­çš„LexicalReordering çš„è·¯å¾„è®¾ç½®ä¸ºå¦‚ä¸‹ï¼š</li>
</ol>

<p>$HOME/working/binarised-model/reordering-table</p>

<p>ä¿®æ”¹åçš„Moses.iniä¸­çš„feature functionéƒ¨åˆ†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 <span class="se">\#</span> feature functions <span class="o">[</span>feature] UnknownWordPenalty WordPenalty PhrasePenalty PhraseDictionaryCompact <span class="nv">name</span><span class="o">=</span>TranslationModel0 num-features<span class="o">=</span>4 <span class="nv">path</span><span class="o">=</span>/home/ubuntu/corpus/un_en-zh_23/working/binarised-model/phrase-table.minphr input-factor<span class="o">=</span>0 output-factor<span class="o">=</span>0 LexicalReordering <span class="nv">name</span><span class="o">=</span>LexicalReordering0 num-features<span class="o">=</span>6 <span class="nb">type</span><span class="o">=</span>wbe-msd-bidirectional-fe-allff input-factor<span class="o">=</span>0 output-factor<span class="o">=</span>0 <span class="nv">path</span><span class="o">=</span>/home/ubuntu/corpus/un_en-zh_23/working/binarised-model/reordering-table Distortion KENLM <span class="nv">name</span><span class="o">=</span>LM0 <span class="nb">factor</span><span class="o">=</span>0 <span class="nv">path</span><span class="o">=</span>/home/ubuntu/corpus/un_en-zh_23/lm/un_en-zh23.blm.cn <span class="nv">order</span><span class="o">=</span>3 
</code></pre></div></div>

<p>å†æ¬¡è¿è¡ŒMoses:</p>

<pre><code class="language-bsah">\~/mosesdecoder/bin/moses -f \~/working/binarised-model/moses.ini
</code></pre>

<p>æ¥ä¸‹æ¥ä½ ä¼šå‘ç°åŠ è½½å’Œè¿è¡Œä¸€æ¬¡ç¿»è¯‘å°†ä¼šå˜å¾—éå¸¸è¿…é€Ÿã€‚è¿™é‡Œæˆ‘ä»¬è¾“å…¥è‹±è¯­å¥å­â€œhowever , there are good reasons for supporting the government .â€</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span> <span class="mi">13</span> <span class="mi">14</span> <span class="mi">15</span> <span class="mi">16</span> <span class="mi">17</span> <span class="mi">18</span> <span class="mi">19</span> <span class="mi">20</span> <span class="mi">21</span> <span class="mi">22</span> <span class="mi">23</span> <span class="mi">24</span> <span class="mi">25</span> <span class="mi">26</span> <span class="mi">27</span> <span class="mi">28</span> <span class="mi">29</span> <span class="mi">30</span> <span class="mi">31</span> <span class="mi">32</span> <span class="mi">33</span> <span class="mi">34</span> <span class="mi">35</span> <span class="mi">36</span> <span class="mi">37</span> <span class="mi">38</span> <span class="mi">39</span> <span class="mi">40</span> <span class="mi">41</span> <span class="mi">42</span> <span class="mi">43</span> <span class="mi">44</span> <span class="mi">45</span> <span class="mi">46</span> <span class="mi">47</span> <span class="mi">48</span> <span class="mi">49</span> <span class="mi">50</span> <span class="mi">51</span> <span class="mi">52</span> <span class="mi">53</span> <span class="mi">54</span> <span class="mi">55</span> <span class="mi">56</span> <span class="mi">57</span> <span class="mi">58</span> <span class="mi">59</span> <span class="mi">60</span> <span class="mi">61</span> <span class="mi">62</span> <span class="mi">63</span> <span class="mi">64</span> <span class="mi">65</span> <span class="mi">66</span> <span class="mi">67</span> <span class="mi">68</span> <span class="mi">69</span> <span class="mi">70</span> <span class="mi">71</span> <span class="mi">72</span> <span class="mi">73</span> <span class="mi">74</span> <span class="mi">75</span> <span class="mi">76</span> <span class="mi">77</span> <span class="mi">78</span> <span class="mi">79</span> <span class="mi">80</span> <span class="mi">81</span> <span class="mi">82</span> <span class="mi">83</span> <span class="mi">84</span> <span class="mi">85</span> <span class="mi">86</span> <span class="mi">87</span> <span class="mi">88</span> <span class="mi">89</span> <span class="mi">90</span> <span class="mi">91</span> <span class="mi">92</span> <span class="mi">93</span> <span class="mi">94</span> <span class="mi">95</span> <span class="mi">96</span> <span class="mi">97</span> <span class="n">Defined</span> <span class="n">parameters</span> <span class="p">(</span><span class="n">per</span> <span class="n">moses</span><span class="p">.</span><span class="n">ini</span> <span class="ow">or</span> <span class="n">switch</span><span class="p">):</span> <span class="n">config</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">working</span><span class="o">/</span><span class="n">binarised</span><span class="o">-</span><span class="n">model</span><span class="o">/</span><span class="n">moses</span><span class="p">.</span><span class="n">ini</span> <span class="n">distortion</span><span class="o">-</span><span class="n">limit</span><span class="p">:</span> <span class="mi">6</span> <span class="n">feature</span><span class="p">:</span> <span class="n">UnknownWordPenalty</span> <span class="n">WordPenalty</span> <span class="n">PhrasePenalty</span> <span class="n">PhraseDictionaryCompact</span> <span class="n">name</span><span class="o">=</span><span class="n">TranslationModel0</span> <span class="n">num</span> <span class="o">-</span><span class="n">features</span><span class="o">=</span><span class="mi">4</span> <span class="n">path</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">working</span><span class="o">/</span><span class="n">binarised</span><span class="o">-</span><span class="n">model</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">minphr</span> <span class="nb">input</span><span class="o">-</span><span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">outp</span> <span class="n">ut</span><span class="o">-</span><span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">LexicalReordering</span> <span class="n">name</span><span class="o">=</span><span class="n">LexicalReordering0</span> <span class="n">num</span><span class="o">-</span><span class="n">features</span><span class="o">=</span><span class="mi">6</span> <span class="nb">type</span><span class="o">=</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="o">-</span><span class="n">allff</span> <span class="nb">input</span><span class="o">-</span><span class="n">f</span> <span class="n">actor</span><span class="o">=</span><span class="mi">0</span> <span class="n">output</span><span class="o">-</span><span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">path</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">working</span><span class="o">/</span><span class="n">binarised</span><span class="o">-</span><span class="n">model</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span> <span class="n">Distortion</span> <span class="n">KENLM</span> <span class="n">name</span><span class="o">=</span><span class="n">LM0</span> <span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">path</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">lm</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh23</span><span class="p">.</span><span class="n">blm</span><span class="p">.</span><span class="n">cn</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span> <span class="nb">input</span><span class="o">-</span><span class="n">factors</span><span class="p">:</span> <span class="mi">0</span> <span class="n">mapping</span><span class="p">:</span> <span class="mi">0</span> <span class="n">T</span> <span class="mi">0</span> <span class="n">weight</span><span class="p">:</span> <span class="n">LexicalReordering0</span><span class="o">=</span> <span class="mf">0.0614344</span> <span class="mf">0.0245557</span> <span class="mf">0.242242</span> <span class="mf">0.0725016</span> <span class="mf">0.0539617</span> <span class="mf">0.0566553</span> <span class="n">Distortion0</span><span class="o">=</span> <span class="mf">0.00</span> <span class="mi">534453</span> <span class="n">LM0</span><span class="o">=</span> <span class="mf">0.0696027</span> <span class="n">WordPenalty0</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.166007</span> <span class="n">PhrasePenalty0</span><span class="o">=</span> <span class="mf">0.0688629</span> <span class="n">TranslationModel0</span><span class="o">=</span> <span class="mf">0.0390017</span> <span class="mf">0.0457273</span> <span class="mi">0</span> <span class="p">.</span><span class="mi">0730895</span> <span class="mf">0.0210141</span> <span class="n">UnknownWordPenalty0</span><span class="o">=</span> <span class="mi">1</span> <span class="n">line</span><span class="o">=</span><span class="n">UnknownWordPenalty</span> <span class="n">FeatureFunction</span><span class="p">:</span> <span class="n">UnknownWordPenalty0</span> <span class="n">start</span><span class="p">:</span> <span class="mi">0</span> <span class="n">end</span><span class="p">:</span> <span class="mi">0</span> <span class="n">line</span><span class="o">=</span><span class="n">WordPenalty</span> <span class="n">FeatureFunction</span><span class="p">:</span> <span class="n">WordPenalty0</span> <span class="n">start</span><span class="p">:</span> <span class="mi">1</span> <span class="n">end</span><span class="p">:</span> <span class="mi">1</span> <span class="n">line</span><span class="o">=</span><span class="n">PhrasePenalty</span> <span class="n">FeatureFunction</span><span class="p">:</span> <span class="n">PhrasePenalty0</span> <span class="n">start</span><span class="p">:</span> <span class="mi">2</span> <span class="n">end</span><span class="p">:</span> <span class="mi">2</span> <span class="n">line</span><span class="o">=</span><span class="n">PhraseDictionaryCompact</span> <span class="n">name</span><span class="o">=</span><span class="n">TranslationModel0</span> <span class="n">num</span><span class="o">-</span><span class="n">features</span><span class="o">=</span><span class="mi">4</span> <span class="n">path</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">working</span><span class="o">/</span> <span class="n">binarised</span><span class="o">-</span><span class="n">model</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">minphr</span> <span class="nb">input</span><span class="o">-</span><span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">output</span><span class="o">-</span><span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">FeatureFunction</span><span class="p">:</span> <span class="n">TranslationModel0</span> <span class="n">start</span><span class="p">:</span> <span class="mi">3</span> <span class="n">end</span><span class="p">:</span> <span class="mi">6</span> <span class="n">line</span><span class="o">=</span><span class="n">LexicalReordering</span> <span class="n">name</span><span class="o">=</span><span class="n">LexicalReordering0</span> <span class="n">num</span><span class="o">-</span><span class="n">features</span><span class="o">=</span><span class="mi">6</span> <span class="nb">type</span><span class="o">=</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="o">-</span><span class="n">allff</span> <span class="nb">input</span><span class="o">-</span><span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">output</span><span class="o">-</span><span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">path</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">working</span><span class="o">/</span><span class="n">binarised</span><span class="o">-</span><span class="n">model</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span> <span class="n">Initializing</span> <span class="n">Lexical</span> <span class="n">Reordering</span> <span class="n">Feature</span><span class="p">..</span> <span class="n">FeatureFunction</span><span class="p">:</span> <span class="n">LexicalReordering0</span> <span class="n">start</span><span class="p">:</span> <span class="mi">7</span> <span class="n">end</span><span class="p">:</span> <span class="mi">12</span> <span class="n">line</span><span class="o">=</span><span class="n">Distortion</span> <span class="n">FeatureFunction</span><span class="p">:</span> <span class="n">Distortion0</span> <span class="n">start</span><span class="p">:</span> <span class="mi">13</span> <span class="n">end</span><span class="p">:</span> <span class="mi">13</span> <span class="n">line</span><span class="o">=</span><span class="n">KENLM</span> <span class="n">name</span><span class="o">=</span><span class="n">LM0</span> <span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">path</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">lm</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh23</span><span class="p">.</span><span class="n">blm</span><span class="p">.</span><span class="n">cn</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span> <span class="n">FeatureFunction</span><span class="p">:</span> <span class="n">LM0</span> <span class="n">start</span><span class="p">:</span> <span class="mi">14</span> <span class="n">end</span><span class="p">:</span> <span class="mi">14</span> <span class="n">Loading</span> <span class="n">UnknownWordPenalty0</span> <span class="n">Loading</span> <span class="n">WordPenalty0</span> <span class="n">Loading</span> <span class="n">PhrasePenalty0</span> <span class="n">Loading</span> <span class="n">LexicalReordering0</span> <span class="n">Loading</span> <span class="n">Distortion0</span> <span class="n">Loading</span> <span class="n">LM0</span> <span class="n">Loading</span> <span class="n">TranslationModel0</span> <span class="n">Created</span> <span class="nb">input</span><span class="o">-</span><span class="n">output</span> <span class="nb">object</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.428</span><span class="p">]</span> <span class="n">seconds</span> <span class="n">however</span> <span class="p">,</span> <span class="n">there</span> <span class="n">are</span> <span class="n">good</span> <span class="n">reasons</span> <span class="k">for</span> <span class="n">supporting</span> <span class="n">the</span> <span class="n">government</span> <span class="n">Translating</span><span class="p">:</span> <span class="n">however</span> <span class="p">,</span> <span class="n">there</span> <span class="n">are</span> <span class="n">good</span> <span class="n">reasons</span> <span class="k">for</span> <span class="n">supporting</span> <span class="n">the</span> <span class="n">government</span> <span class="n">Line</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Initialize</span> <span class="n">search</span> <span class="n">took</span> <span class="mf">0.000</span> <span class="n">seconds</span> <span class="n">total</span> <span class="n">Line</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Collecting</span> <span class="n">options</span> <span class="n">took</span> <span class="mf">0.567</span> <span class="n">seconds</span> <span class="n">at</span> <span class="n">moses</span><span class="o">/</span><span class="n">Manager</span><span class="p">.</span><span class="n">cpp</span> <span class="n">Line</span> <span class="mi">141</span> <span class="n">Line</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Search</span> <span class="n">took</span> <span class="mf">0.308</span> <span class="n">seconds</span> <span class="n">ç„¶è€Œ</span> <span class="err">ï¼Œ</span> <span class="n">æœ‰</span> <span class="n">å……åˆ†</span> <span class="n">ç†ç”±</span> <span class="n">æ”¯æŒ</span> <span class="n">æ”¿åºœ</span> <span class="n">BEST</span> <span class="n">TRANSLATION</span><span class="p">:</span> <span class="n">ç„¶è€Œ</span> <span class="err">ï¼Œ</span> <span class="n">æœ‰</span> <span class="n">å……åˆ†</span> <span class="n">ç†ç”±</span> <span class="n">æ”¯æŒ</span> <span class="n">æ”¿åºœ</span> <span class="p">[</span><span class="mi">1111111111</span><span class="p">]</span> <span class="p">[</span><span class="n">total</span><span class="o">=-</span><span class="mf">3.462</span><span class="p">]</span> <span class="n">core</span><span class="o">=</span><span class="p">(</span><span class="mf">0.000</span><span class="p">,</span><span class="o">-</span><span class="mf">7.000</span><span class="p">,</span><span class="mf">4.000</span><span class="p">,</span><span class="o">-</span><span class="mf">13.611</span><span class="p">,</span><span class="o">-</span><span class="mf">24.516</span><span class="p">,</span><span class="o">-</span><span class="mf">3.431</span><span class="p">,</span><span class="o">-</span><span class="mf">11.391</span><span class="p">,</span><span class="o">-</span><span class="mf">3.059</span><span class="p">,</span><span class="mf">0.000</span><span class="p">,</span><span class="mf">0.000</span><span class="p">,</span><span class="o">-</span><span class="mf">2.434</span><span class="p">,</span><span class="mf">0.000</span><span class="p">,</span><span class="mf">0.000</span><span class="p">,</span><span class="mf">0.000</span><span class="p">,</span><span class="o">-</span><span class="mf">34.379</span><span class="p">)</span> <span class="n">Line</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Decision</span> <span class="n">rule</span> <span class="n">took</span> <span class="mf">0.000</span> <span class="n">seconds</span> <span class="n">total</span> <span class="n">Line</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Additional</span> <span class="n">reporting</span> <span class="n">took</span> <span class="mf">0.000</span> <span class="n">seconds</span> <span class="n">total</span> <span class="n">Line</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Translation</span> <span class="n">took</span> <span class="mf">0.877</span> <span class="n">seconds</span> <span class="n">total</span> \\ 
</code></pre></div></div>

<p>ä½ ä¼šå‘ç°ï¼Œæ­¤æ¬¡åŠ è½½è¿è¡Œä¸€æ¬¡ç¿»è¯‘ç³»ç»Ÿåªéœ€0.877ç§’ï¼Œè€Œä¸”åœ¨æ­¤æœŸé—´ï¼ŒCPUå’Œå†…å­˜çš„å ç”¨å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚è¯´æ˜æˆ‘ä»¬çš„äºŒå€¼åŒ–å–å¾—äº†éå¸¸è‰¯å¥½çš„æ•ˆæœã€‚åœ¨è¿™ä¸€æ­¥ï¼Œä½ å¯èƒ½å¾ˆæƒ³çŸ¥é“è¿™ä¸ªç¿»è¯‘ç³»ç»Ÿçš„è¡¨ç°å¦‚ä½•ã€‚ä¸ºäº†è¡¡é‡è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬ä½¿ç”¨å¦ä¸€ç»„ä¹‹å‰æ²¡æœ‰ä½¿ç”¨è¿‡çš„å¹³è¡Œæ•°æ®ï¼ˆæµ‹è¯•é›†ï¼‰ã€‚æˆ‘ä»¬çš„æµ‹è¯•é›†æ–‡ä»¶åç§°æ˜¯un_test.cnå’Œun_test.enã€‚é¦–å…ˆï¼Œå’Œä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æµ‹è¯•é›†è¿›è¡Œtokenise å’Œtruecaseã€‚</p>

<p>æ­¤å¤„å¯¹un_test.cnè¿›è¡Œtokeniseæ—¶ä¾ç„¶é‡‡ç”¨thulacåˆ†è¯å·¥å…·ï¼Œå¾—åˆ°un_test.fcæ–‡ä»¶ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span> <span class="mi">13</span> <span class="mi">14</span> <span class="mi">15</span> <span class="n">cd</span> \<span class="o">~/</span><span class="n">corpus</span> \<span class="o">~/</span><span class="n">mosesdecoder</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">tokenizer</span><span class="o">/</span><span class="n">tokenizer</span><span class="p">.</span><span class="n">perl</span> <span class="o">-</span><span class="n">l</span> <span class="n">en</span> \\ \<span class="o">&lt;</span> <span class="n">dev</span><span class="o">/</span><span class="n">un_test</span><span class="p">.</span><span class="n">en</span> \<span class="o">&gt;</span> <span class="n">un_test</span><span class="p">.</span><span class="n">tok</span><span class="p">.</span><span class="n">en</span> \<span class="o">~/</span><span class="n">mosesdecoder</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">recaser</span><span class="o">/</span><span class="n">truecase</span><span class="p">.</span><span class="n">perl</span> <span class="o">--</span><span class="n">model</span> <span class="n">truecase</span><span class="o">-</span><span class="n">model</span><span class="p">.</span><span class="n">en</span> \\ \<span class="o">&lt;</span> <span class="n">un_test</span><span class="p">.</span><span class="n">tok</span><span class="p">.</span><span class="n">en</span> \<span class="o">&gt;</span> <span class="n">un_test</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="n">en</span> \<span class="o">~/</span><span class="n">mosesdecoder</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">recaser</span><span class="o">/</span><span class="n">truecase</span><span class="p">.</span><span class="n">perl</span> <span class="o">--</span><span class="n">model</span> <span class="n">truecase</span><span class="o">-</span><span class="n">model</span><span class="p">.</span><span class="n">cn</span> \\ \<span class="o">&lt;</span> <span class="n">un_test</span><span class="p">.</span><span class="n">fc</span> \<span class="o">&gt;</span> <span class="n">un_test</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="n">cn</span> 
</code></pre></div></div>

<p>å¯ä»¥é’ˆå¯¹æ¬¡æµ‹è¯•æœºè¿‡æ»¤æˆ‘ä»¬è®­ç»ƒè¿‡çš„æ¨¡å‹ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬åªä¿ç•™éœ€è¦çš„æ¡ç›®æ¥ç¿»è¯‘ã€‚è¿™ä¼šä½¿ç¿»è¯‘é€Ÿåº¦åŠ å¿«ä¸€äº›ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span> <span class="n">cd</span> \<span class="o">~/</span><span class="n">working</span> \<span class="o">~/</span><span class="n">mosesdecoder</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">training</span><span class="o">/</span><span class="nb">filter</span><span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">given</span><span class="o">-</span><span class="nb">input</span><span class="p">.</span><span class="n">pl</span> \\ <span class="n">filtered</span><span class="o">-</span><span class="n">newstest2011</span> \<span class="o">~/</span><span class="n">working</span><span class="o">/</span><span class="n">mert</span><span class="o">-</span><span class="n">work</span><span class="o">/</span><span class="n">moses</span><span class="p">.</span><span class="n">ini</span> \<span class="o">~/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_test</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="n">en</span> \\ \<span class="o">-</span><span class="n">Binarizer</span> \<span class="o">~/</span><span class="n">mosesdecoder</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">processPhraseTableMin</span> 
</code></pre></div></div>

<p>è¿è¡Œå‘½ä»¤åï¼Œä½ ä¼šçœ‹åˆ°å¦‚ä¸‹çš„æç¤ºï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span> <span class="mi">13</span> <span class="mi">14</span> <span class="mi">15</span> <span class="mi">16</span> <span class="mi">17</span> <span class="mi">18</span> <span class="mi">19</span> <span class="mi">20</span> <span class="mi">21</span> <span class="mi">22</span> <span class="mi">23</span> <span class="mi">24</span> <span class="mi">25</span> <span class="mi">26</span> <span class="mi">27</span> <span class="mi">28</span> <span class="mi">29</span> <span class="mi">30</span> <span class="mi">31</span> <span class="mi">32</span> <span class="mi">33</span> <span class="mi">34</span> <span class="mi">35</span> <span class="mi">36</span> <span class="mi">37</span> <span class="mi">38</span> <span class="mi">39</span> <span class="mi">40</span> <span class="mi">41</span> <span class="mi">42</span> <span class="mi">43</span> <span class="mi">44</span> <span class="mi">45</span> <span class="mi">46</span> <span class="mi">47</span> <span class="mi">48</span> <span class="mi">49</span> <span class="mi">50</span> <span class="mi">51</span> <span class="mi">52</span> <span class="mi">53</span> <span class="mi">54</span> <span class="mi">55</span> <span class="mi">56</span> <span class="mi">57</span> <span class="mi">58</span> <span class="mi">59</span> <span class="mi">60</span> <span class="mi">61</span> <span class="mi">62</span> <span class="mi">63</span> <span class="mi">64</span> <span class="mi">65</span> <span class="mi">66</span> <span class="mi">67</span> <span class="mi">68</span> <span class="mi">69</span> <span class="mi">70</span> <span class="mi">71</span> <span class="mi">72</span> <span class="mi">73</span> <span class="mi">74</span> <span class="mi">75</span> <span class="mi">76</span> <span class="mi">77</span> <span class="mi">78</span> <span class="mi">79</span> <span class="mi">80</span> <span class="mi">81</span> <span class="mi">82</span> <span class="mi">83</span> <span class="mi">84</span> <span class="mi">85</span> <span class="mi">86</span> <span class="mi">87</span> <span class="mi">88</span> <span class="mi">89</span> <span class="mi">90</span> <span class="mi">91</span> <span class="mi">92</span> <span class="mi">93</span> <span class="mi">94</span> <span class="mi">95</span> <span class="mi">96</span> <span class="mi">97</span> <span class="mi">98</span> <span class="mi">99</span> <span class="mi">100</span> <span class="mi">101</span> <span class="mi">102</span> <span class="mi">103</span> <span class="mi">104</span> <span class="mi">105</span> <span class="mi">106</span> <span class="mi">107</span> <span class="mi">108</span> <span class="mi">109</span> <span class="mi">110</span> <span class="mi">111</span> <span class="mi">112</span> <span class="mi">113</span> <span class="mi">114</span> <span class="mi">115</span> <span class="mi">116</span> <span class="mi">117</span> <span class="mi">118</span> <span class="mi">119</span> <span class="mi">120</span> <span class="mi">121</span> <span class="mi">122</span> <span class="mi">123</span> <span class="mi">124</span> <span class="mi">125</span> <span class="mi">126</span> <span class="mi">127</span> <span class="mi">128</span> <span class="mi">129</span> <span class="mi">130</span> <span class="mi">131</span> <span class="mi">132</span> <span class="mi">133</span> <span class="mi">134</span> <span class="mi">135</span> <span class="mi">136</span> <span class="mi">137</span> <span class="mi">138</span> <span class="mi">139</span> <span class="mi">140</span> <span class="mi">141</span> <span class="mi">142</span> <span class="mi">143</span> <span class="mi">144</span> <span class="mi">145</span> <span class="mi">146</span> <span class="mi">147</span> <span class="mi">148</span> <span class="mi">149</span> <span class="mi">150</span> <span class="mi">151</span> <span class="mi">152</span> <span class="mi">153</span> <span class="mi">154</span> <span class="mi">155</span> <span class="mi">156</span> <span class="mi">157</span> <span class="mi">158</span> <span class="mi">159</span> <span class="mi">160</span> <span class="mi">161</span> <span class="mi">162</span> <span class="mi">163</span> <span class="mi">164</span> <span class="mi">165</span> <span class="mi">166</span> <span class="mi">167</span> <span class="mi">168</span> <span class="mi">169</span> <span class="mi">170</span> <span class="n">Executing</span><span class="p">:</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span> <span class="n">Stripping</span> <span class="n">XML</span><span class="p">...</span> <span class="n">Executing</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">mosesdecoder</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">training</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">generic</span><span class="o">/</span><span class="n">strip</span><span class="o">-</span><span class="n">xml</span><span class="p">.</span><span class="n">perl</span> \<span class="o">&lt;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">un_test</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="n">en</span> \<span class="o">&gt;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="nb">input</span><span class="p">.</span><span class="mi">16677</span> <span class="n">pt</span><span class="p">:</span><span class="n">PhraseDictionaryMemory</span> <span class="n">name</span><span class="o">=</span><span class="n">TranslationModel0</span> <span class="n">num</span><span class="o">-</span><span class="n">features</span><span class="o">=</span><span class="mi">4</span> <span class="n">path</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">working</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">gz</span> <span class="nb">input</span><span class="o">-</span><span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">output</span><span class="o">-</span><span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">Considering</span> <span class="n">factor</span> <span class="mi">0</span> <span class="n">ro</span><span class="p">:</span><span class="n">LexicalReordering</span> <span class="n">name</span><span class="o">=</span><span class="n">LexicalReordering0</span> <span class="n">num</span><span class="o">-</span><span class="n">features</span><span class="o">=</span><span class="mi">6</span> <span class="nb">type</span><span class="o">=</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="o">-</span><span class="n">allff</span> <span class="nb">input</span><span class="o">-</span><span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">output</span><span class="o">-</span><span class="n">factor</span><span class="o">=</span><span class="mi">0</span> <span class="n">path</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">working</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="p">.</span><span class="n">gz</span> <span class="n">Considering</span> <span class="n">factor</span> <span class="mi">0</span> <span class="n">Filtering</span> <span class="n">files</span><span class="p">...</span> <span class="n">filtering</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">working</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">gz</span> <span class="o">-</span>\<span class="o">&gt;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="mf">1.</span><span class="p">..</span> <span class="mi">2351834</span> <span class="n">of</span> <span class="mi">17491572</span> <span class="n">phrases</span> <span class="n">pairs</span> <span class="n">used</span> <span class="p">(</span><span class="mf">13.45</span><span class="o">%</span><span class="p">)</span> <span class="o">-</span> <span class="n">note</span><span class="p">:</span> <span class="nb">max</span> <span class="n">length</span> <span class="mi">10</span> <span class="n">binarizing</span><span class="p">...</span> <span class="n">Executing</span><span class="p">:</span> <span class="n">gzip</span> <span class="o">-</span><span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="mf">1.</span><span class="n">gz</span> \<span class="o">|</span> <span class="n">LC_ALL</span><span class="o">=</span><span class="n">C</span> <span class="n">sort</span> <span class="o">--</span><span class="n">compress</span><span class="o">-</span><span class="n">program</span> <span class="n">gzip</span> <span class="o">-</span><span class="n">T</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span> \<span class="o">|</span> <span class="n">gzip</span> <span class="o">-</span> \<span class="o">&gt;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="mf">1.</span><span class="n">gz</span><span class="p">.</span><span class="nb">sorted</span><span class="p">.</span><span class="n">gz</span> <span class="o">&amp;&amp;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">mosesdecoder</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">processPhraseTableMin</span> <span class="o">-</span><span class="ow">in</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="mf">1.</span><span class="n">gz</span><span class="p">.</span><span class="nb">sorted</span><span class="p">.</span><span class="n">gz</span> <span class="o">-</span><span class="n">out</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="mi">1</span> <span class="o">-</span><span class="n">nscores</span> <span class="mi">4</span> <span class="o">-</span><span class="n">threads</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">rm</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="mf">1.</span><span class="n">gz</span><span class="p">.</span><span class="nb">sorted</span><span class="p">.</span><span class="n">gz</span> <span class="n">Used</span> <span class="n">options</span><span class="p">:</span> <span class="n">Text</span> <span class="n">phrase</span> <span class="n">table</span> <span class="n">will</span> <span class="n">be</span> <span class="n">read</span> <span class="k">from</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="mf">1.</span><span class="n">gz</span><span class="p">.</span><span class="nb">sorted</span><span class="p">.</span><span class="n">gz</span> <span class="n">Output</span> <span class="n">phrase</span> <span class="n">table</span> <span class="n">will</span> <span class="n">be</span> <span class="n">written</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="mf">1.</span><span class="n">minphr</span> <span class="n">Step</span> <span class="n">size</span> <span class="k">for</span> <span class="n">source</span> <span class="n">landmark</span> <span class="n">phrases</span><span class="p">:</span> <span class="mi">2</span>\<span class="o">^</span><span class="mi">10</span><span class="o">=</span><span class="mi">1024</span> <span class="n">Source</span> <span class="n">phrase</span> <span class="n">fingerprint</span> <span class="n">size</span><span class="p">:</span> <span class="mi">16</span> <span class="n">bits</span> <span class="o">/</span> <span class="n">P</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span><span class="o">=</span><span class="mf">1.52588e-05</span> <span class="n">Selected</span> <span class="n">target</span> <span class="n">phrase</span> <span class="n">encoding</span><span class="p">:</span> <span class="n">Huffman</span> <span class="o">+</span> <span class="n">PREnc</span> <span class="n">Maxiumum</span> <span class="n">allowed</span> <span class="n">rank</span> <span class="k">for</span> <span class="n">PREnc</span><span class="p">:</span> <span class="mi">100</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">score</span> <span class="n">components</span> <span class="ow">in</span> <span class="n">phrase</span> <span class="n">table</span><span class="p">:</span> <span class="mi">4</span> <span class="n">Single</span> <span class="n">Huffman</span> <span class="n">code</span> <span class="nb">set</span> <span class="k">for</span> <span class="n">score</span> <span class="n">components</span><span class="p">:</span> <span class="n">no</span> <span class="n">Using</span> <span class="n">score</span> <span class="n">quantization</span><span class="p">:</span> <span class="n">no</span> <span class="n">Explicitly</span> <span class="n">included</span> <span class="n">alignment</span> <span class="n">information</span><span class="p">:</span> <span class="n">yes</span> <span class="n">Running</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">threads</span> <span class="n">Pass</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">:</span> <span class="n">Creating</span> <span class="nb">hash</span> <span class="n">function</span> <span class="k">for</span> <span class="n">rank</span> <span class="n">assignment</span> <span class="p">.</span> <span class="n">Pass</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">:</span> <span class="n">Creating</span> <span class="n">source</span> <span class="n">phrase</span> <span class="n">index</span> <span class="o">+</span> <span class="n">Encoding</span> <span class="n">target</span> <span class="n">phrases</span> <span class="p">.</span> <span class="n">Intermezzo</span><span class="p">:</span> <span class="n">Calculating</span> <span class="n">Huffman</span> <span class="n">code</span> <span class="n">sets</span> <span class="n">Creating</span> <span class="n">Huffman</span> <span class="n">codes</span> <span class="k">for</span> <span class="mi">37180</span> <span class="n">target</span> <span class="n">phrase</span> <span class="n">symbols</span> <span class="n">Creating</span> <span class="n">Huffman</span> <span class="n">codes</span> <span class="k">for</span> <span class="mi">59255</span> <span class="n">scores</span> <span class="n">Creating</span> <span class="n">Huffman</span> <span class="n">codes</span> <span class="k">for</span> <span class="mi">779126</span> <span class="n">scores</span> <span class="n">Creating</span> <span class="n">Huffman</span> <span class="n">codes</span> <span class="k">for</span> <span class="mi">55190</span> <span class="n">scores</span> <span class="n">Creating</span> <span class="n">Huffman</span> <span class="n">codes</span> <span class="k">for</span> <span class="mi">1373326</span> <span class="n">scores</span> <span class="n">Creating</span> <span class="n">Huffman</span> <span class="n">codes</span> <span class="k">for</span> <span class="mi">50</span> <span class="n">alignment</span> <span class="n">points</span> <span class="n">Pass</span> <span class="mi">3</span><span class="o">/</span><span class="mi">3</span><span class="p">:</span> <span class="n">Compressing</span> <span class="n">target</span> <span class="n">phrases</span> <span class="p">.</span> <span class="n">Saving</span> <span class="n">to</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">phrase</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="mf">1.</span><span class="n">minphr</span> <span class="n">Done</span> <span class="n">filtering</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">working</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="p">.</span><span class="n">gz</span> <span class="o">-</span>\<span class="o">&gt;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">...</span> <span class="mi">2351834</span> <span class="n">of</span> <span class="mi">17491572</span> <span class="n">phrases</span> <span class="n">pairs</span> <span class="n">used</span> <span class="p">(</span><span class="mf">13.45</span><span class="o">%</span><span class="p">)</span> <span class="o">-</span> <span class="n">note</span><span class="p">:</span> <span class="nb">max</span> <span class="n">length</span> <span class="mi">10</span> <span class="n">binarizing</span><span class="p">...</span> <span class="n">Executing</span><span class="p">:</span> <span class="n">gzip</span> <span class="o">-</span><span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="n">gz</span> \<span class="o">|</span> <span class="n">LC_ALL</span><span class="o">=</span><span class="n">C</span> <span class="n">sort</span> <span class="o">--</span><span class="n">compress</span><span class="o">-</span><span class="n">program</span> <span class="n">gzip</span> <span class="o">-</span><span class="n">T</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span> \<span class="o">|</span> <span class="n">gzip</span> <span class="o">-</span> \<span class="o">&gt;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="n">gz</span><span class="p">.</span><span class="nb">sorted</span><span class="p">.</span><span class="n">gz</span> <span class="o">&amp;&amp;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">mosesdecoder</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">processLexicalTableMin</span> <span class="o">-</span><span class="ow">in</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="n">gz</span><span class="p">.</span><span class="nb">sorted</span><span class="p">.</span><span class="n">gz</span> <span class="o">-</span><span class="n">out</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span> <span class="o">-</span><span class="n">threads</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">rm</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="n">gz</span><span class="p">.</span><span class="nb">sorted</span><span class="p">.</span><span class="n">gz</span> <span class="n">Used</span> <span class="n">options</span><span class="p">:</span> <span class="n">Text</span> <span class="n">reordering</span> <span class="n">table</span> <span class="n">will</span> <span class="n">be</span> <span class="n">read</span> <span class="k">from</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="n">gz</span><span class="p">.</span><span class="nb">sorted</span><span class="p">.</span><span class="n">gz</span> <span class="n">Output</span> <span class="n">reordering</span> <span class="n">table</span> <span class="n">will</span> <span class="n">be</span> <span class="n">written</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="n">minlexr</span> <span class="n">Step</span> <span class="n">size</span> <span class="k">for</span> <span class="n">source</span> <span class="n">landmark</span> <span class="n">phrases</span><span class="p">:</span> <span class="mi">2</span>\<span class="o">^</span><span class="mi">10</span><span class="o">=</span><span class="mi">1024</span> <span class="n">Phrase</span> <span class="n">fingerprint</span> <span class="n">size</span><span class="p">:</span> <span class="mi">16</span> <span class="n">bits</span> <span class="o">/</span> <span class="n">P</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span><span class="o">=</span><span class="mf">1.52588e-05</span> <span class="n">Single</span> <span class="n">Huffman</span> <span class="n">code</span> <span class="nb">set</span> <span class="k">for</span> <span class="n">score</span> <span class="n">components</span><span class="p">:</span> <span class="n">no</span> <span class="n">Using</span> <span class="n">score</span> <span class="n">quantization</span><span class="p">:</span> <span class="n">no</span> <span class="n">Running</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">threads</span> <span class="n">Pass</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span> <span class="n">Creating</span> <span class="n">phrase</span> <span class="n">index</span> <span class="o">+</span> <span class="n">Counting</span> <span class="n">scores</span> <span class="p">.......................</span> <span class="n">Intermezzo</span><span class="p">:</span> <span class="n">Calculating</span> <span class="n">Huffman</span> <span class="n">code</span> <span class="n">sets</span> <span class="n">Creating</span> <span class="n">Huffman</span> <span class="n">codes</span> <span class="k">for</span> <span class="mi">14663</span> <span class="n">scores</span> <span class="n">Creating</span> <span class="n">Huffman</span> <span class="n">codes</span> <span class="k">for</span> <span class="mi">8197</span> <span class="n">scores</span> <span class="n">Creating</span> <span class="n">Huffman</span> <span class="n">codes</span> <span class="k">for</span> <span class="mi">14660</span> <span class="n">scores</span> <span class="n">Creating</span> <span class="n">Huffman</span> <span class="n">codes</span> <span class="k">for</span> <span class="mi">14562</span> <span class="n">scores</span> <span class="n">Creating</span> <span class="n">Huffman</span> <span class="n">codes</span> <span class="k">for</span> <span class="mi">8162</span> <span class="n">scores</span> <span class="n">Creating</span> <span class="n">Huffman</span> <span class="n">codes</span> <span class="k">for</span> <span class="mi">14774</span> <span class="n">scores</span> <span class="n">Pass</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span> <span class="n">Compressing</span> <span class="n">scores</span> <span class="p">.......................</span> <span class="n">Saving</span> <span class="n">to</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">reordering</span><span class="o">-</span><span class="n">table</span><span class="p">.</span><span class="n">wbe</span><span class="o">-</span><span class="n">msd</span><span class="o">-</span><span class="n">bidirectional</span><span class="o">-</span><span class="n">fe</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">.</span><span class="n">minlexr</span> <span class="n">Done</span> <span class="n">To</span> <span class="n">run</span> <span class="n">the</span> <span class="n">decoder</span><span class="p">,</span> <span class="n">please</span> <span class="n">call</span><span class="p">:</span> <span class="n">moses</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">moses</span><span class="p">.</span><span class="n">ini</span> <span class="o">-</span><span class="n">i</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_en</span><span class="o">-</span><span class="n">zh_23</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="nb">input</span><span class="p">.</span><span class="mi">16677</span> 
</code></pre></div></div>

<p>ä½ å¯ä»¥åœ¨ç¬¬ä¸€æ¬¡ç¿»è¯‘æµ‹è¯•æ•°æ®æ—¶è¿è¡ŒBLEUè„šæœ¬æ¥æµ‹è¯•è§£ç å™¨ã€‚å½“ç„¶ï¼Œè¿™éœ€è¦å¾ˆçŸ­ä¸€æ®µæ—¶é—´ã€‚å‘½ä»¤ä¸­çš„ -lcæ˜¯æ— è§†å¤§å°å†™çš„BLEUè¯„åˆ†ï¼Œä¸ä½¿ç”¨å‚æ•°-lcæ˜¯å¤§å°å†™æ•æ„Ÿçš„BLEUè¯„åˆ†ã€‚â€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span> <span class="mi">13</span> <span class="mi">14</span> <span class="mi">15</span> <span class="mi">16</span> <span class="mi">17</span> <span class="n">nohup</span> <span class="n">nice</span> \<span class="o">~/</span><span class="n">mosesdecoder</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">moses</span> \\ \<span class="o">-</span><span class="n">f</span> \<span class="o">~/</span><span class="n">working</span><span class="o">/</span><span class="n">filtered</span><span class="o">-</span><span class="n">un_test</span><span class="o">/</span><span class="n">moses</span><span class="p">.</span><span class="n">ini</span> <span class="o">-</span><span class="n">i</span> \\ \<span class="o">&lt;</span> \<span class="o">~/</span><span class="n">corpus</span><span class="o">/</span> <span class="n">un_test</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="n">en</span> \\ \<span class="o">&gt;</span> \<span class="o">~/</span><span class="n">working</span><span class="o">/</span><span class="n">un_test</span><span class="p">.</span><span class="n">translated</span><span class="p">.</span><span class="n">cn</span> \\ <span class="mi">2</span>\<span class="o">&gt;</span> \<span class="o">~/</span><span class="n">working</span><span class="o">/</span><span class="n">un_test</span><span class="p">.</span><span class="n">out</span> \<span class="o">~/</span><span class="n">mosesdecoder</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">generic</span><span class="o">/</span><span class="n">multi</span><span class="o">-</span><span class="n">bleu</span><span class="p">.</span><span class="n">perl</span> \\ \<span class="o">-</span><span class="n">lc</span> \<span class="o">~/</span><span class="n">corpus</span><span class="o">/</span><span class="n">un_test</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="n">cn</span> \\ \<span class="o">&lt;</span> \<span class="o">~/</span><span class="n">working</span><span class="o">/</span><span class="n">un_test</span><span class="p">.</span><span class="n">translated</span><span class="p">.</span><span class="n">cn</span> 
</code></pre></div></div>

<p>ä¸Šè¿°å‘½ä»¤ä¸­ï¼Œun_test.true.en æ˜¯æˆ‘ä»¬å¾…ç¿»è¯‘çš„æ–‡ä»¶ï¼Œun_test.translated.cnæ˜¯æˆ‘ä»¬å¾—åˆ°çš„ç¿»è¯‘åçš„æ–‡ä»¶ï¼Œun_test.outæ˜¯æˆ‘ä»¬åœ¨ç¿»è¯‘è¿‡ç¨‹ä¸­ç”Ÿæˆçš„æ—¥å¿—æ–‡ä»¶ï¼Œä½ å¯ä»¥ç”¨VIMå·¥å…·æŸ¥çœ‹å…¶ä¸­çš„å†…å®¹ã€‚</p>

<p>å‘½ä»¤æ‰§è¡Œå®Œæˆåï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°å¦‚ä¸‹çš„ä¿¡æ¯ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 BLEU <span class="o">=</span> 29.29, 68.1/36.9/22.0/13.3 <span class="o">(</span><span class="nv">BP</span><span class="o">=</span>1.000, <span class="nv">ratio</span><span class="o">=</span>1.001, <span class="nv">hyp_len</span><span class="o">=</span>106809, <span class="nv">ref_len</span><span class="o">=</span>106725<span class="o">)</span> It is <span class="k">in</span><span class="nt">-advisable</span> to publish scores from multi-bleu.perl. The scores depend on your tokenizer, which is unlikely to be reproducible from your paper or consistent across research groups. Instead you should detokenize <span class="k">then </span>use mteval-v14.pl, which has a standard tokenization. Scores from multi-bleu.perl can still be used <span class="k">for </span>internal purposes when you have a consistent tokenizer. 
</code></pre></div></div>

<p>ä»multi-bleu.perlå¾—åˆ°çš„åˆ†æ•°æ˜¯å¯ä¿¡çš„ã€‚ æœ€ç»ˆå¾—åˆ°çš„åˆ†æ•°å–å†³äºä½ çš„åˆ†è¯å·¥å…·çš„å¥½åï¼Œåœ¨ä½ çš„è®ºæ–‡ä¸­æˆ–è€…æ•´ä¸ªç ”ç©¶å°ç»„ä¸­æ¯æ¬¡å¾—åˆ°çš„åˆ†æ•°éƒ½åº”è¯¥æ˜¯ä¸åŒçš„ã€‚ç›¸åï¼Œä½ åº”è¯¥ä½¿ç”¨mteval-v14.plï¼Œå®ƒå¯ä»¥è¿›è¡Œæ ‡å‡†çš„ç¬¦å·åŒ–ã€‚å½“æ‚¨æ‹¥æœ‰ä¸€è‡´çš„æ ‡è®°ç”Ÿæˆå™¨æ—¶ï¼Œæ¥è‡ªmulti-bleu.perlçš„åˆ†æ•°ä»å¯ç”¨äºå†…éƒ¨ç›®çš„ã€‚</p>

<p>æˆ‘ä»¬è¿™é‡Œå¾—åˆ°çš„BLEUæˆç»©æ˜¯29.29åˆ†ï¼Œæ¯æ¬¡è¿›è¡Œç¿»è¯‘æ—¶ï¼Œå¾—åˆ°çš„BLEUåˆ†æ•°åº”è¯¥æ˜¯ä¸ä¸€æ ·çš„ã€‚åœ¨tuningå’Œæœ€ç»ˆtestçš„æ—¶å€™å‚è€ƒè¯‘æ–‡çš„æ•°é‡ä»¥åŠä½¿ç”¨ä¸åŒåˆ†è¯å·¥å…·æ‰€é€ æˆçš„é¢„å¤„ç†çš„ä¸åŒï¼Œè¯­è¨€æ¨¡å‹æ˜¯n-gramçš„ä¸åŒéƒ½ä¼šå½±å“åˆ°æœ€ç»ˆBLEUåˆ†æ•°ã€‚</p>

<h2 id="å…«-æ­å»ºmoses-server">å…« æ­å»ºmoses server</h2>

<p>å¦‚æœå¸Œæœ›æŠŠmosesä½œä¸ºæœåŠ¡å¼€æ”¾ä½¿ç”¨ï¼Œå¿…é¡»é€šè¿‡è®¾ç½®å°†mosesè®¾ä¸ºmoses serverã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š 
\1. å®‰è£…xmlrpcï¼ˆå¦‚æœå‰é¢æŒ‰ç…§æœ¬æ–‡æ¡£å·²ç»å®‰è£…xmlrpcï¼Œè¯¥æ­¥å¯ä»¥ç•¥è¿‡ã€‚å¦åˆ™å‚è§è¯¥æ–‡æ¡£å‰åŠéƒ¨åˆ†ã€‚å®‰è£…å®Œæˆåé‡æ–°ç¼–è¯‘mosesï¼‰ã€‚</p>

<ol>
  <li>ä¿®æ”¹moses.plå‚æ•° 
è¿›å…¥~/mosesdecoder/contrib/iSenWebæ–‡ä»¶å¤¹ï¼Œæ‰“å¼€moses.plæ–‡ä»¶ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­æŒ‡å®šmoseså’Œmoses.ini(é…ç½®æ–‡ä»¶)çš„ä½ç½®ã€‚æˆ‘è¿™é‡Œçš„MOSESå‚æ•°ä¸ºâ€œ/home/ubuntu/mosesdecoder/bin/mosesâ€ï¼Œ MOSES_INIå‚æ•°ä¸ºâ€ /home/ubuntu/corpus/un_en-zh_23/working/binarised-model/moses.iniâ€ã€‚å…³é—­å¹¶ä¿å­˜ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</li>
</ol>

<p>å°†Moses.plæ–‡ä»¶ä¸­çš„</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 <span class="se">\#</span><span class="nt">------------------------------------------------------------------------------</span> <span class="se">\#</span> constants, global vars, config my <span class="se">\$</span>MOSES <span class="o">=</span> <span class="s1">'/home/tianliang/research/moses-smt/scripts/training/model/moses'</span><span class="p">;</span> my <span class="se">\$</span>MOSES_INI <span class="o">=</span> <span class="s1">'/home/tianliang/research/moses-smt/scripts/training/model/moses.ini'</span><span class="p">;</span> die <span class="s2">"usage: daemon.pl </span><span class="se">\&lt;</span><span class="s2">hostname</span><span class="se">\&gt;</span><span class="s2"> </span><span class="se">\&lt;</span><span class="s2">port</span><span class="se">\&gt;</span><span class="s2">"</span> unless <span class="o">(</span><span class="se">\@</span>ARGV <span class="o">==</span> 2<span class="o">)</span><span class="p">;</span> my <span class="se">\$</span>LISTEN_HOST <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span> my <span class="se">\$</span>LISTEN_PORT <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span> <span class="se">\#</span><span class="nt">------------------------------------------------------------------------------</span> 
</code></pre></div></div>

<p>ä¿®æ”¹ä¸ºï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 <span class="se">\#</span><span class="nt">------------------------------------------------------------------------------</span> <span class="se">\#</span> constants, global vars, config my <span class="se">\$</span>MOSES <span class="o">=</span> <span class="s1">'/home/ubuntu/mosesdecoder/bin/moses'</span><span class="p">;</span> my <span class="se">\$</span>MOSES_INI <span class="o">=</span> <span class="s1">'/home/ubuntu/corpus/un_en-zh_23/working/binarised-model/moses.ini'</span><span class="p">;</span> die <span class="s2">"usage: daemon.pl </span><span class="se">\&lt;</span><span class="s2">hostname</span><span class="se">\&gt;</span><span class="s2"> </span><span class="se">\&lt;</span><span class="s2">port</span><span class="se">\&gt;</span><span class="s2">"</span> unless <span class="o">(</span><span class="se">\@</span>ARGV <span class="o">==</span> 2<span class="o">)</span><span class="p">;</span> my <span class="se">\$</span>LISTEN_HOST <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span> my <span class="se">\$</span>LISTEN_PORT <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span> <span class="se">\#</span><span class="nt">------------------------------------------------------------------------------</span> 
</code></pre></div></div>

<ol>
  <li>è¿›å…¥åˆ°~/mosesdecoder/contrib/iSenWebæ–‡ä»¶å¤¹ï¼Œåœ¨terminalä¸­è¾“å…¥ï¼š</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 ./moses.pl 192.168.0.1 9999 
</code></pre></div></div>

<p>å³ï¼šmoses.pl <hostname> <port></port></hostname></p>

<p>å…¶ä¸­ï¼Œ 192.168.1.1 æ˜¯æœ¬æœºåœ°å€ï¼Œ9999æ˜¯ç«¯å£å·ã€‚TCP/IPåè®®ä¸­ç«¯å£å·çš„èŒƒå›´ä»0~65535,1024ä»¥ä¸‹çš„ç«¯å£ç”¨äºç³»ç»ŸæœåŠ¡ï¼Œ1024~65535ç«¯å£æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ã€‚æˆ‘ä»¬å¯ä»¥åœ¨/etc/serviceæ–‡ä»¶ä¸­çœ‹åˆ°å„ä¸ªç«¯å£çš„æƒ…å†µã€‚</p>

<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒç»­è¿è¡Œmoses serverï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 <span class="nb">nohup</span> <span class="se">\~</span> /mosesdecoder/contrib/iSenWeb/moses.pl 192.168.0.1 9999&amp; 
</code></pre></div></div>

<p>è¿è¡Œå‘½ä»¤åä¼šæ˜¾ç¤ºå¿½ç•¥è¾“å…¥å¹¶æŠŠè¾“å‡ºè¿½åŠ åˆ°â€nohup.outâ€ã€‚å³æˆåŠŸè¿è¡Œäº†moses serverã€‚åœ¨Linuxä¸­ï¼Œnohupçš„æ„æ€æ˜¯å¿½ç•¥SIGHUPä¿¡å·ï¼Œ æ‰€ä»¥å½“è¿è¡Œnohup ./a.outçš„æ—¶å€™ï¼Œ å…³é—­shell, é‚£ä¹ˆa.outè¿›ç¨‹è¿˜æ˜¯å­˜åœ¨çš„ï¼Œå³å¯¹SIGHUPä¿¡å·å…ç–«ã€‚åé¢çš„&amp;ç¬¦å·æ„ä¸ºè®©ä»»åŠ¡åœ¨åå°è¿è¡Œã€‚ è¿è¡Œåä¼šåœ¨å½“å‰è·¯å¾„ä¸‹äº§ç”Ÿä¸€ä¸ªæ–‡ä»¶nohup.outã€‚</p>

<ol>
  <li>
    <p>æµ‹è¯•ç¿»è¯‘å¹³å°ï¼š</p>
  </li>
  <li>
    <p>è¾“å…¥ï¼š</p>

    <p><code class="language-plaintext highlighter-rouge">1 echo " may I help you" \| nc 192.168.0.1 9999 </code></p>
  </li>
</ol>

<p>å¯ä»¥çœ‹åˆ°è¿”å›ç»“æœï¼š</p>

<p>æˆ‘ æ˜¯ å¦ å¯ä»¥ å¸®åŠ© ä½ </p>

<ol>
  <li>å¦‚æœéœ€è¦å…³é—­moses serverï¼Œä½¿ç”¨killall moses.plå°±å¯ä»¥äº†ã€‚</li>
</ol>
:ET