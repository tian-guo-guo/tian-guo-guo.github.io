I"á´<h3 id="learned-in-translation-contextualized-word-vectors">Learned in Translation: Contextualized Word Vectors</h3>

<h3 id="abstract">Abstract</h3>
<p>Computer vision has benefited from initializing multiple deep layers with weights pretrained on large supervised training sets like ImageNet. Natural language processing (NLP) typically sees initialization of only the lowest layer of deep models with pretrained word vectors. In this paper, we use a deep LSTM encoder from an attentional sequence-to-sequence model trained for machine translation (MT) to contextualize word vectors. We show that adding these context vectors (CoVe) improves performance over using only unsupervised word and character vectors on a wide variety of common NLP tasks: sentiment analysis (SST, IMDb), question classification (TREC), entailment (SNLI), and question answering (SQuAD). For fine-grained sentiment analysis and entailment, CoVe improves performance of our baseline models to the state of the art.</p>

<p>è®¡ç®—æœºè§†è§‰å·²ç»å—ç›Šäºåˆå§‹åŒ–å¤šä¸ªæ·±å±‚ï¼Œæƒé‡é¢„å…ˆè®­ç»ƒåœ¨å¤§å‹æœ‰ç›‘ç£çš„è®­ç»ƒé›†ä¸Šï¼Œå¦‚ImageNetã€‚ è‡ªç„¶è¯­è¨€å¤„ç†(NLP)é€šå¸¸åªçœ‹åˆ°ä½¿ç”¨é¢„å…ˆè®­ç»ƒçš„å­—å‘é‡åˆå§‹åŒ–æœ€ä¸‹å±‚çš„æ·±åº¦æ¨¡å‹ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ·±åº¦LSTMç¼–ç å™¨ä»ä¸€ä¸ªæ³¨æ„åºåˆ—åˆ°åºåˆ—æ¨¡å‹è®­ç»ƒæœºå™¨ç¿»è¯‘(MT)æ¥ä¸Šä¸‹æ–‡åŒ–å•è¯å‘é‡ã€‚ æˆ‘ä»¬å‘ç°ï¼Œåœ¨æƒ…æ„Ÿåˆ†æ(SSTã€IMDB)ã€é—®é¢˜åˆ†ç±»(TREC)ã€è•´æ¶µ(SNLI)å’Œé—®ç­”ï¼ˆSquadï¼‰ç­‰å¤šç§å¸¸è§çš„è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ä¸­ï¼Œæ·»åŠ è¿™äº›ä¸Šä¸‹æ–‡å‘é‡ï¼ˆCoVEï¼‰æ¯”ä»…ä½¿ç”¨æ— ç›‘ç£çš„å•è¯å’Œå­—ç¬¦å‘é‡æé«˜äº†æ€§èƒ½ã€‚ å¯¹äºç»†ç²’åº¦çš„æƒ…æ„Ÿåˆ†æå’Œè•´æ¶µï¼ŒCOVEå°†æˆ‘ä»¬çš„åŸºçº¿æ¨¡å‹çš„æ€§èƒ½æé«˜åˆ°äº†æœ€å…ˆè¿›çš„æ°´å¹³ã€‚</p>

<h3 id="1-introduction">1 Introduction</h3>
<p>Significant gains have been made through transfer and multi-task learning between synergistic tasks. In many cases, these synergies can be exploited by architectures that rely on similar components. In computer vision, convolutional neural networks (CNNs) pretrained on ImageNet [Krizhevsky et al., 2012, Deng et al., 2009] have become the de facto initialization for more complex and deeper models. This initialization improves accuracy on other related tasks such as visual question answering [Xiong et al., 2016] or image captioning [Lu et al., 2016, Socher et al., 2014].</p>

<p>ååŒä»»åŠ¡ä¹‹é—´çš„è¿ç§»å’Œå¤šä»»åŠ¡å­¦ä¹ å–å¾—äº†æ˜¾è‘—çš„æˆæ•ˆã€‚ åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œä¾èµ–äºç±»ä¼¼ç»„ä»¶çš„ä½“ç³»ç»“æ„å¯ä»¥åˆ©ç”¨è¿™äº›ååŒä½œç”¨ã€‚ åœ¨è®¡ç®—æœºè§†è§‰ä¸­ï¼Œåœ¨ImageNetä¸Šé¢„è®­ç»ƒçš„å·ç§¯ç¥ç»ç½‘ç»œ[Krizhevskyç­‰äººï¼Œ2012ï¼ŒDengç­‰äººï¼Œ2009]å·²ç»æˆä¸ºæ›´å¤æ‚å’Œæ›´æ·±å±‚æ¬¡æ¨¡å‹çš„äº‹å®ä¸Šçš„åˆå§‹åŒ–ã€‚ è¿™ç§åˆå§‹åŒ–æé«˜äº†å…¶ä»–ç›¸å…³ä»»åŠ¡çš„å‡†ç¡®æ€§ï¼Œä¾‹å¦‚è§†è§‰é—®é¢˜å›ç­”[Xiongç­‰äººï¼Œ2016]æˆ–å›¾åƒå­—å¹•[Luç­‰äººï¼Œ2016ï¼ŒSocherç­‰äººï¼Œ2014]ã€‚</p>

<p>In NLP, distributed representations pretrained with models like Word2Vec [Mikolov et al., 2013] and GloVe [Pennington et al., 2014] have become common initializations for the word vectors of deep learning models. Transferring information from large amounts of unlabeled training data in the form of word vectors has shown to improve performance over random word vector initialization on a variety of downstream tasks, e.g. part-of-speech tagging [Collobert et al., 2011], named entity recognition [Pennington et al., 2014], and question answering [Xiong et al., 2017]; however, words rarely appear in isolation. The ability to share a common representation of words in the context of sentences that include them could further improve transfer learning in NLP.</p>

<p>åœ¨NLPä¸­ï¼Œä½¿ç”¨è¯¸å¦‚Word2Vec[Mikolovç­‰äººï¼Œ2013]å’ŒGlove[Penningtonç­‰äººï¼Œ2014]ç­‰æ¨¡å‹é¢„å…ˆè®­ç»ƒçš„åˆ†å¸ƒå¼è¡¨ç¤ºå·²ç»æˆä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„å•è¯å‘é‡çš„å¸¸è§åˆå§‹åŒ–ã€‚ ä»¥è¯å‘é‡çš„å½¢å¼ä»å¤§é‡æœªæ ‡è®°çš„è®­ç»ƒæ•°æ®ä¼ è¾“ä¿¡æ¯å·²ç»è¡¨æ˜ï¼Œåœ¨å„ç§ä¸‹æ¸¸ä»»åŠ¡ä¸Šï¼Œä¾‹å¦‚è¯æ€§æ ‡è®°[Collobertç­‰äººï¼Œ2011]ã€å‘½åå®ä½“è¯†åˆ«[Penningtonç­‰äººï¼Œ2014]ã€ä»¥åŠé—®ç­”[Xiongç­‰äººï¼Œ2017]ä¸Šï¼Œç›¸å¯¹äºéšæœºè¯å‘é‡åˆå§‹åŒ–ï¼Œæé«˜äº†æ€§èƒ½ï¼› ç„¶è€Œï¼Œè¯è¯­å¾ˆå°‘å•ç‹¬å‡ºç°ã€‚ åœ¨åŒ…å«å•è¯çš„å¥å­ä¸­å…±äº«å•è¯çš„å…±åŒè¡¨ç¤ºçš„èƒ½åŠ›å¯ä»¥è¿›ä¸€æ­¥æé«˜è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„è¿ç§»å­¦ä¹ ã€‚</p>

<p>Inspired by the successful transfer of CNNs trained on ImageNet to other tasks in computer vision, we focus on training an encoder for a large NLP task and transferring that encoder to other tasks in NLP. Machine translation (MT) requires a model to encode words in context so as to decode them into another language, and attentional sequence-to-sequence models for MT often contain an LSTM-based encoder, which is a common component in other NLP models. We hypothesize that MT data in general holds potential comparable to that of ImageNet as a cornerstone for reusable models. This makes an MT-LSTM pairing in NLP a natural candidate for mirroring the ImageNet-CNN pairing of computer vision.</p>

<p>åœ¨ImageNetä¸Šè®­ç»ƒçš„CNNæˆåŠŸåœ°è½¬ç§»åˆ°è®¡ç®—æœºè§†è§‰ä¸­çš„å…¶ä»–ä»»åŠ¡çš„å¯å‘ä¸‹ï¼Œæˆ‘ä»¬ä¸“æ³¨äºè®­ç»ƒç”¨äºå¤§å‹NLPä»»åŠ¡çš„ç¼–ç å™¨ï¼Œå¹¶å°†è¯¥ç¼–ç å™¨è½¬ç§»åˆ°NLPä¸­çš„å…¶ä»–ä»»åŠ¡ã€‚ æœºå™¨ç¿»è¯‘ï¼ˆMachine Translationï¼ŒMTï¼‰éœ€è¦ä¸€ä¸ªæ¨¡å‹å¯¹ä¸Šä¸‹æ–‡ä¸­çš„å•è¯è¿›è¡Œç¼–ç ï¼Œä»¥ä¾¿å°†å®ƒä»¬è¯‘æˆå¦ä¸€ç§è¯­è¨€ï¼Œè€ŒMTçš„æ³¨æ„åºåˆ—åˆ°åºåˆ—æ¨¡å‹é€šå¸¸åŒ…å«ä¸€ä¸ªåŸºäºLSTMçš„ç¼–ç å™¨ï¼Œè¿™æ˜¯å…¶ä»–NLPæ¨¡å‹ä¸­å¸¸è§çš„ç»„ä»¶ã€‚ æˆ‘ä»¬å‡è®¾MTæ•°æ®é€šå¸¸å…·æœ‰ä¸ImageNetç›¸å½“çš„æ½œåŠ›ï¼Œä½œä¸ºå¯é‡ç”¨æ¨¡å‹çš„åŸºçŸ³ã€‚ è¿™ä½¿å¾—NLPä¸­çš„MT-LSTMé…å¯¹æˆä¸ºè®¡ç®—æœºè§†è§‰çš„ImageNet-CNNé…å¯¹çš„è‡ªç„¶å€™é€‰ã€‚</p>

<p>As depicted in Figure 1, we begin by training LSTM encoders on several machine translation datasets, and we show that these encoders can be used to improve performance of models trained for other tasks in NLP. In order to test the transferability of these encoders, we develop a common architecture for a variety of classification tasks, and we modify the Dynamic Coattention Network for question answering [Xiong et al., 2017]. We append the outputs of the MT-LSTMs, which we call context vectors (CoVe), to the word vectors typically used as inputs to these models. This approach improved the performance of models for downstream tasks over that of baseline models using pretrained word vectors alone. For the Stanford Sentiment Treebank (SST) and the Stanford Natural Language Inference Corpus (SNLI), CoVe pushes performance of our baseline model to the state of the art.</p>

<p>å¦‚å›¾1æ‰€ç¤ºï¼Œæˆ‘ä»¬é¦–å…ˆåœ¨å‡ ä¸ªæœºå™¨ç¿»è¯‘æ•°æ®é›†ä¸Šè®­ç»ƒLSTMç¼–ç å™¨ï¼Œå¹¶ä¸”æˆ‘ä»¬å±•ç¤ºäº†è¿™äº›ç¼–ç å™¨å¯ä»¥ç”¨æ¥æé«˜NLPä¸­ä¸ºå…¶ä»–ä»»åŠ¡è®­ç»ƒçš„æ¨¡å‹çš„æ€§èƒ½ã€‚ ä¸ºäº†æµ‹è¯•è¿™äº›ç¼–ç å™¨çš„å¯è½¬ç§»æ€§ï¼Œæˆ‘ä»¬ä¸ºå„ç§åˆ†ç±»ä»»åŠ¡å¼€å‘äº†ä¸€ä¸ªé€šç”¨æ¶æ„ï¼Œå¹¶ä¿®æ”¹äº†ç”¨äºé—®ç­”çš„åŠ¨æ€ååŒæ³¨æ„ç½‘ç»œ[Xiongç­‰äººï¼Œ2017]ã€‚ æˆ‘ä»¬å°†MT-LSTMçš„è¾“å‡ºï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºä¸Šä¸‹æ–‡å‘é‡ï¼ˆCoVEï¼‰ï¼‰é™„åŠ åˆ°é€šå¸¸ç”¨ä½œè¿™äº›æ¨¡å‹è¾“å…¥çš„å­—å‘é‡ã€‚ ä¸ä»…ä½¿ç”¨é¢„å…ˆè®­ç»ƒçš„å­—å‘é‡çš„åŸºçº¿æ¨¡å‹ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•æé«˜äº†ä¸‹æ¸¸ä»»åŠ¡çš„æ¨¡å‹çš„æ€§èƒ½ã€‚ å¯¹äºæ–¯å¦ç¦æƒ…æ„Ÿæ ‘åº“(SST)å’Œæ–¯å¦ç¦è‡ªç„¶è¯­è¨€æ¨ç†è¯­æ–™åº“(SNLI)ï¼ŒCOVEå°†æˆ‘ä»¬çš„åŸºçº¿æ¨¡å‹çš„æ€§èƒ½æå‡åˆ°äº†æœ€å…ˆè¿›çš„æ°´å¹³ã€‚</p>

<p><img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-table1.png" alt="190911-table1.png" /></p>

<p>å®éªŒè¡¨æ˜ï¼Œç”¨äºè®­ç»ƒMT-LSTMçš„è®­ç»ƒæ•°æ®é‡ä¸ä¸‹æ¸¸ä»»åŠ¡çš„æ€§èƒ½æ­£ç›¸å…³ã€‚ è¿™æ˜¯ä¾èµ–MTçš„å¦ä¸€ä¸ªä¼˜ç‚¹ï¼Œå› ä¸ºMTçš„æ•°æ®æ¯”å¤§å¤šæ•°å…¶ä»–å—ç›‘ç£çš„NLPä»»åŠ¡çš„æ•°æ®æ›´ä¸°å¯Œï¼Œè¿™è¡¨æ˜æ›´é«˜è´¨é‡çš„MT-LSTMæºå¸¦æ›´å¤šæœ‰ç”¨çš„ä¿¡æ¯ã€‚ è¿™åŠ å¼ºäº†æœºå™¨ç¿»è¯‘æ˜¯è¿›ä¸€æ­¥ç ”ç©¶å…·æœ‰æ›´å¼ºè‡ªç„¶è¯­è¨€ç†è§£èƒ½åŠ›çš„æ¨¡å‹çš„ä¸€ä¸ªå¾ˆå¥½çš„å€™é€‰ä»»åŠ¡çš„è§‚ç‚¹ã€‚</p>

<h3 id="2-related-work">2 Related Work</h3>
<p><strong>Transfer Learning.</strong>
Transfer learning, or domain adaptation, has been applied in a variety of areas where researchers identified synergistic relationships between independently collected datasets. Saenko et al. [2010] adapt object recognition models developed for one visual domain to new imaging conditions by learning a transformation that minimizes domain-induced changes in the feature distribution. Zhu et al. [2011] use matrix factorization to incorporate textual information into tagged images to enhance image classification. In natural language processing (NLP), Collobert et al. [2011] leverage representations learned from unsupervised learning to improve performance on supervised tasks like named entity recognition, part-of-speech tagging, and chunking. Recent work in NLP has continued in this direction by using pretrained word representations to improve models for entailment [Bowman et al., 2014], sentiment analysis [Socher et al., 2013], summarization [Nallapati et al., 2016], and question answering [Seo et al., 2017, Xiong et al., 2017]. Ramachandran et al. [2016] propose initializing sequence-to-sequence models with pretrained language models and fine-tuning for a specific task. Kiros et al. [2015] propose an unsupervised method for training an encoder that outputs sentence vectors that are predictive of surrounding sentences. We also propose a method of transferring higher-level representations than word vectors, but we use a supervised method to train our sentence encoder and show that it improves models for text classification and question answering without fine-tuning.</p>

<p>è¿ç§»å­¦ä¹ ï¼Œæˆ–ç§°é¢†åŸŸé€‚åº”ï¼Œå·²ç»è¢«åº”ç”¨äºç ”ç©¶äººå‘˜å‘ç°ç‹¬ç«‹æ”¶é›†çš„æ•°æ®é›†ä¹‹é—´ååŒå…³ç³»çš„å„ä¸ªé¢†åŸŸã€‚ Saenkoç­‰äººã€‚ [2010]é€šè¿‡å­¦ä¹ æœ€å°åŒ–åŸŸå¼•èµ·çš„ç‰¹å¾åˆ†å¸ƒå˜åŒ–çš„å˜æ¢ï¼Œä½¿ä¸ºä¸€ä¸ªè§†è§‰åŸŸå¼€å‘çš„å¯¹è±¡è¯†åˆ«æ¨¡å‹é€‚åº”æ–°çš„æˆåƒæ¡ä»¶ã€‚ æœ±ç­‰ã€‚ [2011]ä½¿ç”¨çŸ©é˜µåˆ†è§£å°†æ–‡æœ¬ä¿¡æ¯åˆå¹¶åˆ°æ ‡è®°å›¾åƒä¸­ï¼Œä»¥å¢å¼ºå›¾åƒåˆ†ç±»ã€‚ åœ¨è‡ªç„¶è¯­è¨€å¤„ç†(NLP)ä¸­ï¼ŒCollobertç­‰äººã€‚ [2011]åˆ©ç”¨ä»æ— ç›‘ç£å­¦ä¹ ä¸­å­¦ä¹ åˆ°çš„è¡¨ç¤ºæ¥æé«˜åœ¨æœ‰ç›‘ç£ä»»åŠ¡ä¸Šçš„æ€§èƒ½ï¼Œå¦‚å‘½åå®ä½“è¯†åˆ«ã€è¯æ€§æ ‡è®°å’Œåˆ†å—ã€‚ NLPæœ€è¿‘åœ¨è¿™æ–¹é¢ç»§ç»­å¼€å±•å·¥ä½œï¼Œä½¿ç”¨é¢„å…ˆè®­ç»ƒçš„è¯è¡¨ç¤ºæ”¹è¿›è•´å«æ¨¡å‹[Bowmanç­‰äººï¼Œ2014]ã€æƒ…æ„Ÿåˆ†æ[Socherç­‰äººï¼Œ2013]ã€æ€»ç»“[Nallapatiç­‰äººï¼Œ2016]å’Œé—®ç­”[Seoç­‰äººï¼Œ2017ï¼Œç†Šç­‰äººï¼Œ2017]ã€‚ Ramachandranç­‰äººã€‚ [2016]å»ºè®®ä½¿ç”¨é¢„å…ˆè®­ç»ƒçš„è¯­è¨€æ¨¡å‹åˆå§‹åŒ–åºåˆ—åˆ°åºåˆ—æ¨¡å‹ï¼Œå¹¶é’ˆå¯¹ç‰¹å®šä»»åŠ¡è¿›è¡Œå¾®è°ƒã€‚ Kirosç­‰äººã€‚ [2015]æå‡ºäº†ä¸€ç§ç”¨äºè®­ç»ƒç¼–ç å™¨çš„æ— ç›‘ç£æ–¹æ³•ï¼Œè¯¥ç¼–ç å™¨è¾“å‡ºé¢„æµ‹å‘¨å›´å¥å­çš„å¥å­å‘é‡ã€‚ æˆ‘ä»¬è¿˜æå‡ºäº†ä¸€ç§æ¯”è¯å‘é‡æ›´é«˜çº§çš„è¡¨ç¤ºæ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ç§æœ‰ç›‘ç£çš„æ–¹æ³•æ¥è®­ç»ƒæˆ‘ä»¬çš„å¥å­ç¼–ç å™¨ï¼Œå¹¶ä¸”è¡¨æ˜å®ƒæ”¹è¿›äº†æ–‡æœ¬åˆ†ç±»å’Œé—®é¢˜å›ç­”çš„æ¨¡å‹ï¼Œè€Œä¸éœ€è¦å¾®è°ƒ.</p>

<p><strong>Neural Machine Translation.</strong>
Our source domain of transfer learning is machine translation, a task that has seen marked improvements in recent years with the advance of neural machine translation (NMT) models. Sutskever et al. [2014] investigate sequence-to-sequence models that consist of a neural network encoder and decoder for machine translation. Bahdanau et al. [2015] propose the augmenting sequence to sequence models with an attention mechanism that gives the decoder access to the encoder representations of the input sequence at each step of sequence generation. Luong et al. [2015] further study the effectiveness of various attention mechanisms with respect to machine translation. Attention mechanisms have also been successfully applied to NLP tasks like entailment [Conneau et al., 2017], summarization [Nallapati et al., 2016], question answering [Seo et al., 2017, Xiong et al., 2017, Min et al., 2017], and semantic parsing [Dong and Lapata, 2016]. We show that attentional encoders trained for NMT transfer well to other NLP tasks.</p>

<p>è¿ç§»å­¦ä¹ çš„æºé¢†åŸŸæ˜¯æœºå™¨ç¿»è¯‘ï¼Œè¿‘å¹´æ¥éšç€ç¥ç»æœºå™¨ç¿»è¯‘(NMT)æ¨¡å‹çš„å‘å±•ï¼Œæœºå™¨ç¿»è¯‘å¾—åˆ°äº†æ˜¾è‘—çš„æ”¹è¿›ã€‚ Sutskeverç­‰äºº [2014]ç ”ç©¶ç”±ç”¨äºæœºå™¨ç¿»è¯‘çš„ç¥ç»ç½‘ç»œç¼–ç å™¨å’Œè§£ç å™¨ç»„æˆçš„åºåˆ—åˆ°åºåˆ—æ¨¡å‹ã€‚ Bahdanauç­‰äºº [2015]æå‡ºäº†åºåˆ—æ¨¡å‹çš„å¢å¼ºåºåˆ—ï¼Œæ³¨æ„æœºåˆ¶ä½¿è§£ç å™¨èƒ½å¤Ÿåœ¨åºåˆ—ç”Ÿæˆçš„æ¯ä¸ªæ­¥éª¤è®¿é—®è¾“å…¥åºåˆ—çš„ç¼–ç å™¨è¡¨ç¤ºã€‚ Luongç­‰äººã€‚ [2015]è¿›ä¸€æ­¥ç ”ç©¶æœºå™¨ç¿»è¯‘æ–¹é¢å„ç§æ³¨æ„æœºåˆ¶çš„æœ‰æ•ˆæ€§ã€‚ æ³¨æ„æœºåˆ¶ä¹Ÿå·²æˆåŠŸåœ°åº”ç”¨äºNLPä»»åŠ¡ï¼Œå¦‚è•´æ¶µ[Conneauç­‰äººï¼Œ2017]ã€æ€»ç»“[Nallapatiç­‰äººï¼Œ2016]ã€é—®ç­”[Seoç­‰äººï¼Œ2017ã€Xiongç­‰äººï¼Œ2017ã€Minç­‰äººï¼Œ2017]å’Œè¯­ä¹‰åˆ†æ[Dongå’ŒLapataï¼Œ2016]ã€‚ å®éªŒç»“æœè¡¨æ˜ï¼Œå—è¿‡NMTè®­ç»ƒçš„æ³¨æ„ç¼–ç å™¨èƒ½å¤Ÿå¾ˆå¥½åœ°è½¬ç§»åˆ°å…¶ä»–NLPä»»åŠ¡ä¸­ã€‚</p>

<p><strong>Transfer Learning and Machine Translation.</strong>
Machine translation is a suitable source domain for transfer learning because the task, by nature, requires the model to faithfully reproduce a sentence in the target language without losing information in the source language sentence. Moreover, there is an abundance of machine translation data that can be used for transfer learning. Hill et al. [2016] study the effect of transferring from a variety of source domains to the semantic similarity tasks in Agirre et al. [2014]. Hill et al. [2017] further demonstrate that fixed-length representations obtained from NMT encoders outperform those obtained from monolingual (e.g. language modeling) encoders on semantic similarity tasks. Unlike previous work, we do not transfer from fixed length representations produced by NMT encoders. Instead, we transfer representations for each token in the input sequence. Our approach makes the transfer of the trained encoder more directly compatible with subsequent LSTMs, attention mechanisms, and, in general, layers that expect input sequences. This additionally facilitates the transfer of sequential dependencies between encoder states.</p>

<p>æœºå™¨ç¿»è¯‘æ˜¯ä¸€ä¸ªé€‚åˆäºè¿ç§»å­¦ä¹ çš„æºåŸŸï¼Œå› ä¸ºä»»åŠ¡æœ¬è´¨ä¸Šè¦æ±‚æ¨¡å‹å¿ å®åœ°å†ç°ç›®æ ‡è¯­è¨€ä¸­çš„å¥å­ï¼Œè€Œä¸ä¸¢å¤±æºè¯­è¨€å¥å­ä¸­çš„ä¿¡æ¯ã€‚ æ­¤å¤–ï¼Œè¿˜æœ‰å¤§é‡çš„æœºå™¨ç¿»è¯‘æ•°æ®å¯ç”¨äºè¿ç§»å­¦ä¹ ã€‚ å¸Œå°”ç­‰äººã€‚ [2016]ç ”ç©¶äº†Agirreç­‰äººæå‡ºçš„è¯­ä¹‰ç›¸ä¼¼ä»»åŠ¡ä»å¤šç§æºåŸŸè¿ç§»åˆ°è¯­ä¹‰ç›¸ä¼¼ä»»åŠ¡çš„æ•ˆæœã€‚ [2014]ã€‚ å¸Œå°”ç­‰äººã€‚ [2017]è¿›ä¸€æ­¥è¯æ˜ä»NMTç¼–ç å™¨è·å¾—çš„å›ºå®šé•¿åº¦è¡¨ç¤ºåœ¨è¯­ä¹‰ç›¸ä¼¼æ€§ä»»åŠ¡ä¸Šä¼˜äºä»å•è¯­è¨€ï¼ˆä¾‹å¦‚ï¼Œè¯­è¨€å»ºæ¨¡ï¼‰ç¼–ç å™¨è·å¾—çš„å›ºå®šé•¿åº¦è¡¨ç¤ºã€‚ ä¸å…ˆå‰çš„å·¥ä½œä¸åŒï¼Œæˆ‘ä»¬ä¸ä»ç”±NMTç¼–ç å™¨äº§ç”Ÿçš„å›ºå®šé•¿åº¦è¡¨ç¤ºè½¬ç§»ã€‚ ç›¸åï¼Œæˆ‘ä»¬ä¼ è¾“è¾“å…¥åºåˆ—ä¸­æ¯ä¸ªä»¤ç‰Œçš„è¡¨ç¤ºå½¢å¼ã€‚ æˆ‘ä»¬çš„æ–¹æ³•ä½¿å¾—ç»è¿‡è®­ç»ƒçš„ç¼–ç å™¨çš„ä¼ è¾“æ›´ç›´æ¥åœ°ä¸åç»­çš„LSTMã€æ³¨æ„æœºåˆ¶ä»¥åŠé€šå¸¸æœŸæœ›è¾“å…¥åºåˆ—çš„å±‚å…¼å®¹ã€‚ è¿™è¿˜æœ‰åŠ©äºåœ¨ç¼–ç å™¨çŠ¶æ€ä¹‹é—´ä¼ è¾“é¡ºåºä¾èµ–æ€§ã€‚</p>

<p><strong>Transfer Learning in Computer Vision.</strong>
Since the success of CNNs on the ImageNet challenge, a number of approaches to computer vision tasks have relied on pretrained CNNs as off-the-shelf feature extractors. Girshick et al. [2014] show that using a pretrained CNN to extract features from region proposals improves object detection and semantic segmentation models. Qi et al. [2016] propose a CNN-based object tracking framework, which uses hierarchical features from a pretrained CNN (VGG-19 by Simonyan and Zisserman [2014]). For image captioning, Lu et al. [2016] train a visual sentinel with a pretrained CNN and fine-tune the model with a smaller learning rate. For VQA, Fukui et al. [2016] propose to combine text representations with visual representations extracted by a pretrained residual network [He et al., 2016]. Although model transfer has seen widespread success in computer vision, transfer learning beyond pretrained word vectors is far less pervasive in NLP.</p>

<p>è‡ªä»CNNåœ¨ImageNetæŒ‘æˆ˜ä¸­å–å¾—æˆåŠŸä»¥æ¥ï¼Œè®¸å¤šè®¡ç®—æœºè§†è§‰ä»»åŠ¡çš„æ–¹æ³•éƒ½ä¾èµ–äºé¢„å…ˆè®­ç»ƒçš„CNNä½œä¸ºç°æˆçš„ç‰¹å¾æå–å™¨ã€‚ Girshickç­‰äººã€‚ [2014]è¡¨æ˜ï¼Œä½¿ç”¨é¢„å…ˆè®­ç»ƒçš„CNNä»åŒºåŸŸææ¡ˆä¸­æå–ç‰¹å¾æ”¹è¿›äº†å¯¹è±¡æ£€æµ‹å’Œè¯­ä¹‰åˆ†å‰²æ¨¡å‹ã€‚ é½ç­‰äººã€‚ [2016]æå‡ºä¸€ä¸ªåŸºäºCNNçš„ç›®æ ‡è·Ÿè¸ªæ¡†æ¶ï¼Œè¯¥æ¡†æ¶ä½¿ç”¨é¢„å…ˆè®­ç»ƒçš„CNNçš„åˆ†å±‚ç‰¹å¾(VGG-19ï¼ŒSimonyanå’ŒZisserman[2014])ã€‚ å¯¹äºå›¾åƒå­—å¹•ï¼ŒLuç­‰äººã€‚ [2016]ç”¨é¢„å…ˆè®­ç»ƒçš„CNNè®­ç»ƒè§†è§‰å“¨å…µï¼Œå¹¶ä»¥è¾ƒå°çš„å­¦ä¹ é€Ÿç‡å¾®è°ƒæ¨¡å‹ã€‚ å¯¹äºVQAï¼ŒFukuiç­‰äººã€‚ [2016]æè®®å°†æ–‡æœ¬è¡¨ç¤ºä¸é€šè¿‡é¢„å…ˆè®­ç»ƒçš„æ®‹å·®ç½‘ç»œæå–çš„è§†è§‰è¡¨ç¤ºç›¸ç»“åˆ[Heç­‰äººï¼Œ2016å¹´]ã€‚ å°½ç®¡æ¨¡å‹è¿ç§»åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸå–å¾—äº†å¹¿æ³›çš„æˆåŠŸï¼Œä½†åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸï¼Œè¶…å‡ºé¢„å…ˆè®­ç»ƒå¥½çš„è¯å‘é‡çš„è¿ç§»å­¦ä¹ å¹¶ä¸æ™®éã€‚</p>

<p><strong>3 Machine Translation Model</strong>
We begin by training an attentional sequence-to-sequence model for English-to-German translation based on Klein et al. [2017] with the goal of transferring the encoder to other tasks.</p>

<p>æˆ‘ä»¬é¦–å…ˆåœ¨Kleinç­‰äººçš„åŸºç¡€ä¸Šè®­ç»ƒäº†ä¸€ä¸ªæ³¨æ„åºåˆ—åˆ°åºåˆ—çš„è‹±å¾·ç¿»è¯‘æ¨¡å‹ã€‚ [2017]ç›®æ ‡æ˜¯å°†ç¼–ç å™¨è½¬ç§»åˆ°å…¶ä»–ä»»åŠ¡ã€‚</p>

<p>For training, we are given a sequence of words in the source language wx = [wx1,â€¦,wxn] and a sequence of words in the target language wz = [wz1,â€¦,wzm]. Let GloVe(wx) be a sequence of GloVe vectors corresponding to the words in wx, and let z be a sequence of randomly initialized word vectors corresponding to the words in wz.</p>

<p>ä¸ºäº†è®­ç»ƒï¼Œæˆ‘ä»¬å¾—åˆ°æºè¯­è¨€Wx=[Wx1ï¼Œâ€¦ï¼ŒWxn]ä¸­çš„å•è¯åºåˆ—å’Œç›®æ ‡è¯­è¨€Wz=[Wz1ï¼Œâ€¦ï¼ŒWzm]ä¸­çš„å•è¯åºåˆ—ã€‚ è®¾glove(wx)æ˜¯å¯¹åº”äºwxä¸­çš„å•è¯çš„gloveå‘é‡åºåˆ—ï¼Œzæ˜¯å¯¹åº”äºwzä¸­çš„å•è¯çš„éšæœºåˆå§‹åŒ–çš„å•è¯å‘é‡åºåˆ—ã€‚</p>

<p>We feed GloVe(wx) to a standard, two-layer, bidirectional, long short-term memory network 1 [Graves and Schmidhuber, 2005] that we refer to as an MT-LSTM to indicate that it is this same two-layer BiLSTM that we later transfer as a pretrained encoder. The MT-LSTM is used to compute a sequence of hidden states</p>

<p>æˆ‘ä»¬å°†æ‰‹å¥—(WX)é¦ˆé€åˆ°æ ‡å‡†çš„ã€ä¸¤å±‚çš„ã€åŒå‘çš„ã€é•¿æœŸçš„çŸ­æœŸè®°å¿†ç½‘ç»œ1[Graveså’ŒSchmidhuberï¼Œ2005]ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸ºMT-LSTMï¼Œä»¥æŒ‡ç¤ºæˆ‘ä»¬ç¨åä½œä¸ºé¢„è®­ç»ƒç¼–ç å™¨ä¼ è¾“çš„æ­£æ˜¯ç›¸åŒçš„ä¸¤å±‚BILSTMã€‚ MT-LSTMç”¨äºè®¡ç®—éšè—çŠ¶æ€åºåˆ— 
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation1.png" alt="190911-equation1.png" />
For machine translation, the MT-LSTM supplies the context for an attentional decoder that produces a distribution over output words p(Ë†wzt |H,wz1,â€¦,wztâˆ’1) at each time-step.</p>

<p>å¯¹äºæœºå™¨ç¿»è¯‘ï¼ŒMT-LSTMæä¾›ç”¨äºæ³¨æ„è§£ç å™¨çš„ä¸Šä¸‹æ–‡ï¼Œè¯¥æ³¨æ„è§£ç å™¨åœ¨æ¯ä¸ªæ—¶é—´æ­¥äº§ç”Ÿè¾“å‡ºå­—P(WZT Hï¼ŒWZ1ï¼Œâ€¦ï¼ŒWZTâˆ’1)ä¸Šçš„åˆ†å¸ƒã€‚</p>

<p>At time-step t, the decoder first uses a two-layer, unidirectional LSTM to produce a hidden state hdec t based on the previous target embedding ztâˆ’1 and a context-adjusted hidden state Ëœhtâˆ’1:</p>

<p>åœ¨æ—¶é—´æ­¥éª¤tï¼Œè§£ç å™¨é¦–å…ˆä½¿ç”¨ä¸¤å±‚å•å‘LSTMæ¥åŸºäºå…ˆå‰çš„ç›®æ ‡åµŒå…¥ZT-1å’Œä¸Šä¸‹æ–‡è°ƒæ•´éšè—çŠ¶æ€ï½HT-1:
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation2.png" alt="190911-equation2.png" />
The decoder then computes a vector of attention weights Î± representing the relevance of each encoding time-step to the current decoder state.</p>

<p>è§£ç å™¨ç„¶åè®¡ç®—è¡¨ç¤ºæ¯ä¸ªç¼–ç æ—¶é—´æ­¥é•¿ä¸å½“å‰è§£ç å™¨çŠ¶æ€çš„ç›¸å…³æ€§çš„å…³æ³¨æƒé‡Î±çš„å‘é‡ã€‚ 
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation3.png" alt="190911-equation3.png" /></p>

<p>where H refers to the elements of h stacked along the time dimension.</p>

<p>å…¶ä¸­Hè¡¨ç¤ºæ²¿æ—¶é—´ç»´å †å çš„Hçš„å…ƒç´ ã€‚</p>

<p>The decoder then uses these weights as coefficients in an attentional sum that is concatenated with the decoder state and passed through a tanh layer to form the context-adjusted hidden state Ëœh:</p>

<p>ç„¶åï¼Œè§£ç å™¨ä½¿ç”¨è¿™äº›æƒé‡ä½œä¸ºå…³æ³¨å’Œä¸­çš„ç³»æ•°ï¼Œè¯¥å…³æ³¨å’Œä¸è§£ç å™¨çŠ¶æ€çº§è”å¹¶ä¸”ç»è¿‡Tanhå±‚ä»¥å½¢æˆä¸Šä¸‹æ–‡è°ƒæ•´çš„éšè—çŠ¶æ€ï½H
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation4.png" alt="190911-equation4.png" /></p>

<p>The distribution over output words is generated by a final transformation of the context-adjusted. hidden state: p( Ë†wz
t |X, wz 1, . . . , wz tâˆ’1) = softmax WoutËœht + bout)<br />
è¾“å‡ºå­—ä¸Šçš„åˆ†å¸ƒç”±ä¸Šä¸‹æ–‡è°ƒæ•´çš„æœ€ç»ˆè½¬æ¢ç”Ÿæˆã€‚ éšè—çŠ¶æ€:Pï¼ˆWZ 
T xï¼ŒWz 1ï¼Œã€‚ ã€‚ã€‚ã€‚ï¼ŒWZ tâˆ’1)=SOFTMAX WOUT~HT+BOUTï¼Ÿï¼Ÿ)</p>

<h3 id="4-context-vectors-cove">4 Context Vectors (CoVe)</h3>
<p>We transfer what is learned by the MT-LSTM to downstream tasks by treating the outputs of the MT-LSTM as context vectors. If w is a sequence of words and GloVe(w) the corresponding sequence of word vectors produced by the GloVe model, then<br />
é€šè¿‡å°†MT-LSTMçš„è¾“å‡ºä½œä¸ºä¸Šä¸‹æ–‡å‘é‡ï¼Œæˆ‘ä»¬å°†MT-LSTMæ‰€å­¦åˆ°çš„çŸ¥è¯†è½¬ç§»åˆ°ä¸‹æ¸¸ä»»åŠ¡ã€‚ å¦‚æœwæ˜¯å•è¯åºåˆ—ï¼Œå¹¶ä¸”glove(w)æ˜¯ç”±gloveæ¨¡å‹äº§ç”Ÿçš„å•è¯å‘é‡çš„ç›¸åº”åºåˆ—ï¼Œç„¶å
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation5.png" alt="190911-equation5.png" /></p>

<p>is the sequence of context vectors produced by the MT-LSTM. For classification and question answering, for an input sequence w, we concatenate each vector in GloVe(w) with its corresponding vector in CoVe(w)<br />
æ˜¯MT-LSTMç”Ÿæˆçš„ä¸Šä¸‹æ–‡å‘é‡åºåˆ—ã€‚ ä¸ºäº†åˆ†ç±»å’Œå›ç­”é—®é¢˜ï¼Œå¯¹äºè¾“å…¥åºåˆ—Wï¼Œæˆ‘ä»¬å°†æ‰‹å¥—(W)ä¸­çš„æ¯ä¸ªå‘é‡ä¸å…¶åœ¨å‡¹æ§½(W)ä¸­çš„ç›¸åº”å‘é‡è¿æ¥èµ·æ¥ã€‚ <br />
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation6.png" alt="190911-equation6.png" />
as depicted in Figure 1b.<br />
å¦‚å›¾1bæ‰€ç¤ºã€‚
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-figure1.png" alt="190911-figure1.png" /></p>

<h3 id="5-classification-with-cove">5 Classification with CoVe</h3>
<p>We now describe a general biattentive classification network (BCN) we use to test how well CoVe transfer to other tasks. This model, shown in Figure 2, is designed to handle both single-sentence and two-sentence classification tasks. In the case of single-sentence tasks, the input sequence is duplicated to form two sequences, so we will assume two input sequences for the rest of this section.
æˆ‘ä»¬ç°åœ¨æè¿°äº†ä¸€ä¸ªé€šç”¨çš„åæ³¨æ„åˆ†ç±»ç½‘ç»œ(BCN)ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒæ¥æµ‹è¯•Coveåˆ°å…¶ä»–ä»»åŠ¡çš„è¿ç§»æƒ…å†µã€‚ å¦‚å›¾2æ‰€ç¤ºï¼Œè¯¥æ¨¡å‹è®¾è®¡ç”¨äºå¤„ç†å•å¥å’ŒåŒå¥åˆ†ç±»ä»»åŠ¡ã€‚ åœ¨å•å¥å­ä»»åŠ¡çš„æƒ…å†µä¸‹ï¼Œè¾“å…¥åºåˆ—è¢«é‡å¤ä»¥å½¢æˆä¸¤ä¸ªåºåˆ—ï¼Œå› æ­¤æˆ‘ä»¬å°†åœ¨æœ¬èŠ‚çš„å…¶ä½™éƒ¨åˆ†å‡è®¾ä¸¤ä¸ªè¾“å…¥åºåˆ—ã€‚
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-figure2.png" alt="190911-figure2.png" /></p>

<p>Input sequences wx and wy are converted to se- quences of vectors, Ëœwx and Ëœwy, as described in Eq. 6 before being fed to the task-specific portion of the model (Figure 1b). <br />
è¾“å…¥åºåˆ—wxå’Œwyè¢«è½¬æ¢æˆå‘é‡åºåˆ—ï¼Œï½wxå’Œï½wyï¼Œå¦‚ç­‰å¼ä¸­æ‰€è¿°ã€‚ 6åœ¨è¢«é¦ˆé€åˆ°æ¨¡å‹çš„ä»»åŠ¡ç‰¹å®šéƒ¨åˆ†ä¹‹å‰ï¼ˆå›¾1B)ã€‚</p>

<p>A function f applies a feedforward network with ReLU activation [Nair and Hinton, 2010] to each element of Ëœwx and Ëœwy, and a bidirectional LSTM processes the resulting sequences to obtain task spe- cific representations,<br />
å‡½æ•°Få°†å…·æœ‰RELUæ¿€æ´»çš„å‰é¦ˆç½‘ç»œ[Nairå’Œè¾›é¡¿ï¼Œ2010]åº”ç”¨äºï½Wxå’Œï½Wyçš„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”åŒå‘LSTMå¤„ç†æ‰€å¾—åºåˆ—ä»¥è·å¾—ä»»åŠ¡ç‰¹å®šè¡¨ç¤ºï¼Œ
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation7_8.png" alt="190911-equation7_8.png" /></p>

<p>These sequences are each stacked along the time axis to get matrices X and Y.<br />
è¿™äº›åºåˆ—å„è‡ªæ²¿ç€æ—¶é—´è½´å †å ä»¥å¾—åˆ°çŸ©é˜µXå’ŒYã€‚</p>

<p>In order to compute representations that are interde- pendent, we use a biattention mechanism [Seo et al., 2017, Xiong et al., 2017]. The biattention first com- putes an affinity matrix A = XY?. It then extracts attention weights with column-wise normalization:<br />
ä¸ºäº†è®¡ç®—æ‚¬è€Œæœªå†³çš„è¡¨ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨åŒæ³¨æ„æœºåˆ¶[Seoç­‰äººï¼Œ2017ï¼ŒXiongç­‰äººï¼Œ2017]ã€‚ Biattentioné¦–å…ˆè®¡ç®—ä¸€ä¸ªäº²å’ŒçŸ©é˜µA=XYï¼Ÿã€‚ ç„¶åï¼Œä½¿ç”¨æŒ‰åˆ—å½’ä¸€åŒ–æå–æ³¨æ„æƒé‡:
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation9.png" alt="190911-equation9.png" /></p>

<p>which amounts to a novel form of self-attention when x = y. Next, it uses context summaries to condition each sequence on the other.<br />
è¿™ç›¸å½“äºå½“x=yæ—¶çš„ä¸€ç§æ–°çš„è‡ªæˆ‘æ³¨æ„å½¢å¼ã€‚ æ¥ä¸‹æ¥ï¼Œå®ƒä½¿ç”¨ä¸Šä¸‹æ–‡æ‘˜è¦æ¥è°ƒèŠ‚æ¯ä¸ªåºåˆ—ã€‚ 
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation10.png" alt="190911-equation10.png" /></p>

<p>We integrate the conditioning information into our representations for each sequence with two separate one-layer, bidirectional LSTMs that operate on the concatenation of the original representations (to ensure no information is lost in conditioning), their differences from the context summaries (to explicitly capture the difference from the original signals), and the element-wise products between originals and context summaries (to amplify or dampen the original signals).<br />
æˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªç‹¬ç«‹çš„å•å±‚åŒå‘LSTMå°†æ¡ä»¶ä¿¡æ¯é›†æˆåˆ°æ¯ä¸ªåºåˆ—çš„è¡¨ç¤ºä¸­ï¼Œè¿™ä¸¤ä¸ªLSTMåˆ†åˆ«å¤„ç†åŸå§‹è¡¨ç¤ºçš„çº§è”ï¼ˆä»¥ç¡®ä¿æ¡ä»¶ä¸­æ²¡æœ‰ä¿¡æ¯ä¸¢å¤±ï¼‰ã€å®ƒä»¬ä¸ä¸Šä¸‹æ–‡æ‘˜è¦çš„å·®å¼‚ï¼ˆä»¥æ˜¾å¼æ•è·åŸå§‹ä¿¡å·çš„å·®å¼‚ï¼‰ä»¥åŠåŸå§‹è¡¨ç¤ºä¸ä¸Šä¸‹æ–‡æ‘˜è¦ä¹‹é—´çš„å…ƒç´ ç§¯ï¼ˆä»¥æ”¾å¤§æˆ–æŠ‘åˆ¶åŸå§‹ä¿¡å·ï¼‰ã€‚ 
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation11_12.png" alt="190911-equation11_12.png" /></p>

<p>The outputs of the bidirectional LSTMs are aggregated by pooling along the time dimension. Max and mean pooling have been used in other models to extract features, but we have found that adding both min pooling and self-attentive pooling can aid in some tasks. Each captures a different perspective on the conditioned sequences.<br />
åŒå‘LSTMçš„è¾“å‡ºé€šè¿‡æ²¿æ—¶é—´ç»´çš„æ± è¿›è¡Œèšåˆã€‚ Maxå’ŒMean Poolingåœ¨å…¶ä»–æ¨¡å‹ä¸­è¢«ç”¨æ¥æå–ç‰¹å¾ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°æ·»åŠ Min Poolingå’ŒSelf-Attentive Poolingéƒ½å¯ä»¥å¸®åŠ©å®Œæˆä¸€äº›ä»»åŠ¡ã€‚ æ¯ç§æ–¹æ³•éƒ½æ•è·æ¡ä»¶åºåˆ—çš„ä¸åŒé€è§†å›¾ã€‚</p>

<p>The self-attentive pooling computes weights for each time step of the sequence<br />
è‡ªæ³¨æ„æ± ä¸ºåºåˆ—çš„æ¯ä¸ªæ—¶é—´æ­¥éª¤è®¡ç®—æƒé‡
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation13.png" alt="190911-equation13.png" /></p>

<p>and uses these weights to get weighted summations of each sequence:<br />
å¹¶ä½¿ç”¨è¿™äº›æƒé‡å¾—åˆ°æ¯ä¸ªåºåˆ—çš„åŠ æƒå’Œ:
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation14.png" alt="190911-equation14.png" /></p>

<p>The pooled representations are combined to get one joined representation for all inputs.<br />
åˆå¹¶çš„è¡¨ç¤ºè¢«ç»„åˆä»¥è·å¾—æ‰€æœ‰è¾“å…¥çš„ä¸€ä¸ªè”æ¥è¡¨ç¤ºã€‚
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-equation15_16.png" alt="190911-equation15_16.png" /></p>

<p>We feed this joined representation through a three-layer, batch-normalized [Ioffe and Szegedy, 2015] maxout network [Goodfellow et al., 2013] to produce a probability distribution over possible classes.<br />
æˆ‘ä»¬é€šè¿‡ä¸‰å±‚ã€æ‰¹å½’ä¸€åŒ–çš„[IOFFEå’ŒSzegedyï¼Œ2015]Maxoutç½‘ç»œ[Goodfellowç­‰äººï¼Œ2013]æ¥é¦ˆé€è¿™ä¸ªè¿æ¥çš„è¡¨ç¤ºï¼Œä»¥åœ¨å¯èƒ½çš„ç±»ä¸Šäº§ç”Ÿæ¦‚ç‡åˆ†å¸ƒã€‚</p>

<h3 id="6-question-answering-with-cove">6 Question Answering with CoVe</h3>
<p>For question answering, we obtain sequences x and y just as we do in Eq. 7 and Eq. 8 for classification, except that the function f is replaced with a function g that uses a tanh activation instead of a ReLU activation. In this case, one of the sequences is the document and the other the question in the question-document pair. These sequences are then fed through the coattention and dynamic decoder implemented as in the original Dynamic Coattention Network (DCN) [Xiong et al., 2016].
å¯¹äºé—®é¢˜çš„å›ç­”ï¼Œæˆ‘ä»¬å¾—åˆ°åºåˆ—Xå’ŒYï¼Œå°±åƒæˆ‘ä»¬åœ¨æ–¹ç¨‹ä¸­æ‰€åšçš„é‚£æ ·ã€‚ 7å’Œç­‰å¼ã€‚ 8ç”¨äºåˆ†ç±»ï¼Œé™¤äº†å‡½æ•°fè¢«ä½¿ç”¨tanhæ¿€æ´»è€Œä¸æ˜¯reluæ¿€æ´»çš„å‡½æ•°gä»£æ›¿ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€ä¸ªåºåˆ—æ˜¯æ–‡æ¡£ï¼Œå¦ä¸€ä¸ªåºåˆ—æ˜¯é—®é¢˜-æ–‡æ¡£å¯¹ä¸­çš„é—®é¢˜ã€‚ ç„¶åï¼Œè¿™äº›åºåˆ—é€šè¿‡ä¸åŸå§‹åŠ¨æ€å…±åŒæ³¨æ„ç½‘ç»œ(DCN)ä¸­å®ç°çš„å…±åŒæ³¨æ„å’ŒåŠ¨æ€è§£ç å™¨é¦ˆé€[Xiongç­‰äººï¼Œ2016]ã€‚</p>

<h3 id="7-datasets">7 Datasets</h3>
<p><strong>Machine Translation.</strong> We use three different English-German machine translation datasets to train three separate MT-LSTMs. Each is tokenized using the Moses Toolkit [Koehn et al., 2007].<br />
æˆ‘ä»¬ä½¿ç”¨ä¸‰ä¸ªä¸åŒçš„è‹±å¾·æœºå™¨ç¿»è¯‘æ•°æ®é›†æ¥è®­ç»ƒä¸‰ä¸ªç‹¬ç«‹çš„MT-LSTMã€‚ æ¯ä¸ªéƒ½ä½¿ç”¨Moseså·¥å…·åŒ…è¿›è¡Œæ ‡è®°[Koehnç­‰äººï¼Œ2007å¹´]ã€‚</p>

<p>Our smallest MT dataset comes from the WMT 2016 multi-modal translation shared task [Specia et al., 2016]. The training set consists of 30,000 sentence pairs that briefly describe Flickr captions and is often referred to as Multi30k. Due to the nature of image captions, this dataset contains sentences that are, on average, shorter and simpler than those from larger counterparts.<br />
æˆ‘ä»¬æœ€å°çš„MTæ•°æ®é›†æ¥è‡ªWMT2016å¤šæ¨¡æ€ç¿»è¯‘å…±äº«ä»»åŠ¡[Specia et al.ï¼Œ2016]ã€‚ è®­ç»ƒé›†åŒ…å«30,000ä¸ªå¥å­å¯¹ï¼Œè¿™äº›å¥å­å¯¹ç®€è¦æè¿°äº†Flickrå­—å¹•ï¼Œé€šå¸¸ç§°ä¸ºmulti30kã€‚ ç”±äºå›¾åƒæ ‡é¢˜çš„æ€§è´¨ï¼Œæ­¤æ•°æ®é›†åŒ…å«çš„å¥å­å¹³å‡æ¯”è¾ƒå¤§å¯¹åº”çš„å¥å­æ›´çŸ­å’Œæ›´ç®€å•ã€‚</p>

<p>Our medium-sized MT dataset is the 2016 version of the machine translation task prepared for the International Workshop on Spoken Language Translation [Cettolo et al., 2015]. The training set consists of 209,772 sentence pairs from transcribed TED presentations that cover a wide variety of topics with more conversational language than in the other two machine translation datasets.<br />
æˆ‘ä»¬çš„ä¸­å‹MTæ•°æ®é›†æ˜¯ä¸ºå›½é™…å£è¯­ç¿»è¯‘ç ”è®¨ä¼š[Cettoloç­‰äººï¼Œ2015å¹´]å‡†å¤‡çš„æœºå™¨ç¿»è¯‘ä»»åŠ¡çš„2016å¹´ç‰ˆæœ¬ã€‚ åŸ¹è®­é›†ç”±209,772å¯¹æŠ„å½•çš„TEDæ¼”è®²å¥å­ç»„æˆï¼Œè¿™äº›å¥å­æ¯”å¦å¤–ä¸¤ä¸ªæœºå™¨ç¿»è¯‘æ•°æ®é›†åŒ…å«æ›´å¤šä¼šè¯è¯­è¨€çš„å¹¿æ³›ä¸»é¢˜ã€‚</p>

<p>Our largest MT dataset comes from the news translation shared task from WMT 2017. The training set consists of roughly 7 million sentence pairs that comes from web crawl data, a news and commentary corpus, European Parliament proceedings, and European Union press releases.
æˆ‘ä»¬æœ€å¤§çš„MTæ•°æ®é›†æ¥è‡ªWMT2017çš„æ–°é—»ç¿»è¯‘å…±äº«ä»»åŠ¡ã€‚ è¿™ä¸ªè®­ç»ƒé›†ç”±å¤§çº¦700ä¸‡å¯¹å¥å­ç»„æˆï¼Œè¿™äº›å¥å­æ¥è‡ªç½‘ç»œçˆ¬è¡Œæ•°æ®ã€æ–°é—»å’Œè¯„è®ºè¯­æ–™åº“ã€æ¬§æ´²è®®ä¼šè®®äº‹å½•å’Œæ¬§ç›Ÿæ–°é—»ç¨¿ã€‚</p>

<p>We refer to the three MT datasets as MT-Small, MT-Medium, and MT-Large, respectively, and we refer to context vectors from encoders trained on each in turn as CoVe-S, CoVe-M, and CoVe-L. 
æˆ‘ä»¬å°†è¿™ä¸‰ä¸ªMTæ•°æ®é›†åˆ†åˆ«ç§°ä¸ºMT-Smallã€MT-Mediumå’ŒMT-Largeï¼Œå¹¶å°†æ¥è‡ªç¼–ç å™¨çš„ä¸Šä¸‹æ–‡å‘é‡ä¾æ¬¡ç§°ä¸ºCOVE-Sã€COVE-Må’ŒCOVE-Lã€‚</p>

<p><strong>Sentiment Analysis.</strong> We train our model separately on two sentiment analysis datasets: the Stanford Sentiment Treebank (SST) [Socher et al., 2013] and the IMDb dataset [Maas et al., 2011]. Both of these datasets comprise movie reviews and their sentiment. We use the binary version of each dataset as well as the five-class version of SST. For training on SST, we use all sub-trees with length greater than 3. SST-2 contains roughly 56, 400 reviews after removing â€œneutralâ€ examples. SST-5 contains roughly 94, 200 reviews and does include â€œneutralâ€ examples. IMDb contains 25, 000 multi-sentence reviews, which we truncate to the first 200 words. 2, 500 reviews are held out for validation.<br />
æˆ‘ä»¬åˆ†åˆ«åœ¨ä¸¤ä¸ªæƒ…ç»ªåˆ†ææ•°æ®é›†ä¸Šè®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹:æ–¯å¦ç¦æƒ…ç»ªæ ‘åº“(SST)[Socherç­‰äººï¼Œ2013]å’ŒIMDBæ•°æ®é›†[Maasç­‰äººï¼Œ2011]ã€‚ è¿™ä¸¤ä¸ªæ•°æ®é›†åŒ…æ‹¬ç”µå½±è¯„è®ºå’Œä»–ä»¬çš„æƒ…æ„Ÿã€‚ æˆ‘ä»¬ä½¿ç”¨æ¯ä¸ªæ•°æ®é›†çš„äºŒè¿›åˆ¶ç‰ˆæœ¬ä»¥åŠSSTçš„äº”ç±»ç‰ˆæœ¬ã€‚ å¯¹äºSSTçš„è®­ç»ƒï¼Œæˆ‘ä»¬ä½¿ç”¨é•¿åº¦å¤§äº3çš„æ‰€æœ‰å­æ ‘ã€‚ åœ¨åˆ é™¤â€œä¸­æ€§â€ç¤ºä¾‹ä¹‹åï¼ŒSST-2åŒ…å«å¤§çº¦56,400ä¸ªè¯„è®ºã€‚ SST-5åŒ…å«å¤§çº¦94,200ç¯‡è¯„è®ºï¼Œå¹¶åŒ…å«â€œä¸­æ€§â€çš„ä¾‹å­ã€‚ IMDBåŒ…å«25,000ä¸ªå¤šå¥è¯„è®ºï¼Œæˆ‘ä»¬å°†å…¶æˆªæ–­ä¸ºå‰200ä¸ªå•è¯ã€‚ æœ‰2,500ç¯‡è¯„è®ºç­‰å¾…éªŒè¯ã€‚</p>

<p><strong>Question Classification.</strong> For question classification, we use the small TREC dataset [Voorhees and Tice, 1999] dataset of open-domain, fact-based questions divided into broad semantic categories. We experiment with both the six-class and fifty-class versions of TREC, which which refer to as TREC-6 and TREC-50, respectively. We hold out 452 examples for validation and leave 5, 000 for training.
Entailment.<br />
åœ¨é—®é¢˜åˆ†ç±»æ–¹é¢ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å°å‹çš„TRECæ•°æ®é›†[Voorhees and Ticeï¼Œ1999]ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼€æ”¾é¢†åŸŸçš„åŸºäºäº‹å®çš„é—®é¢˜é›†ï¼Œè¢«åˆ’åˆ†ä¸ºå¹¿æ³›çš„è¯­ä¹‰ç±»åˆ«ã€‚ æˆ‘ä»¬å¯¹TRECçš„å…­çº§å’Œäº”åçº§ç‰ˆæœ¬è¿›è¡Œäº†å®éªŒï¼Œè¿™ä¸¤ä¸ªç‰ˆæœ¬åˆ†åˆ«ç§°ä¸ºTREC-6å’ŒTREC-50ã€‚ æˆ‘ä»¬ç»™å‡ºäº†452ä¸ªéªŒè¯ç¤ºä¾‹ï¼Œå¹¶ç•™ä¸‹5000ä¸ªç”¨äºåŸ¹è®­ã€‚</p>

<p><strong>Entailment.</strong> For entailment, we use the Stanford Natural Language Inference Corpus (SNLI) [Bow- man et al., 2015], which has 550,152 training, 10,000 validation, and 10,000 testing examples. Each example consists of a premise, a hypothesis, and a label specifying whether the premise entails, contradicts, or is neutral with respect to the hypothesis.<br />
å¯¹äºè•´æ¶µï¼Œæˆ‘ä»¬ä½¿ç”¨æ–¯å¦ç¦è‡ªç„¶è¯­è¨€æ¨ç†è¯­æ–™åº“(SNLI)[Bow-manç­‰äººï¼Œ2015å¹´]ï¼Œè¯¥è¯­æ–™åº“æœ‰550,152ä¸ªè®­ç»ƒã€10,000ä¸ªéªŒè¯å’Œ10,000ä¸ªæµ‹è¯•ç¤ºä¾‹ã€‚ æ¯ä¸ªç¤ºä¾‹éƒ½åŒ…å«ä¸€ä¸ªå‰æã€ä¸€ä¸ªå‡è®¾å’Œä¸€ä¸ªæ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾æŒ‡å®šè¯¥å‰æå¯¹äºè¯¥å‡è®¾æ˜¯åŒ…å«ã€çŸ›ç›¾è¿˜æ˜¯ä¸­ç«‹çš„ã€‚</p>

<p><strong>Question Answering.</strong> The Stanford Question Answering Dataset (SQuAD) [Rajpurkar et al., 2016] is a large-scale question answering dataset with 87,599 training examples, 10,570 development examples, and a test set that is not released to the public. Examples consist of question-answer pairs associated with a paragraph from the English Wikipedia. SQuAD examples assume that the question is answerable and that the answer is contained verbatim somewhere in the paragraph.
æ–¯å¦ç¦é—®ç­”æ•°æ®é›†ï¼ˆSquadï¼‰[Rajpurkarç­‰äººï¼Œ2016å¹´]æ˜¯ä¸€ä¸ªå¤§å‹é—®ç­”æ•°æ®é›†ï¼ŒåŒ…å«87599ä¸ªåŸ¹è®­ç¤ºä¾‹ã€10570ä¸ªå¼€å‘ç¤ºä¾‹å’Œä¸€ä¸ªæœªå‘å…¬ä¼—å‘å¸ƒçš„æµ‹è¯•é›†ã€‚ ç¤ºä¾‹åŒ…æ‹¬ä¸è‹±æ–‡ç»´åŸºç™¾ç§‘ä¸­çš„æ®µè½ç›¸å…³è”çš„é—®ç­”å¯¹ã€‚ å°ç»„çš„ä¾‹å­å‡å®šé—®é¢˜æ˜¯å¯ä»¥å›ç­”çš„ï¼Œç­”æ¡ˆé€å­—åœ°åŒ…å«åœ¨æ®µè½çš„æŸå¤„ã€‚</p>

<h3 id="8-experiments">8 Experiments</h3>

<h3 id="81-machine-translation">8.1 Machine Translation</h3>
<p>The MT-LSTM trained on MT-Small obtains an uncased, tokenized BLEU score of 38.5 on the Multi30k test set from 2016. The model trained on MT-Medium obtains an uncased, tokenized BLEU score of 25.54 on the IWSLT test set from 2014. The MT-LSTM trained on MT-Large obtains an uncased, tokenized BLEU score of 28.96 on the WMT 2016 test set. These results represent strong baseline machine translation models for their respective datasets. Note that, while the smallest dataset has the highest BLEU score, it is also a much simpler dataset with a restricted domain.<br />
åœ¨MT-Smallä¸Šè®­ç»ƒçš„MT-LSTMä»2016å¹´èµ·åœ¨Multi30Kæµ‹è¯•é›†ä¸Šè·å¾—38.5çš„æ— çº¦æŸçš„ã€æ ‡è®°åŒ–çš„BLEUåˆ†æ•°ã€‚ åœ¨MT-mediumä¸Šè®­ç»ƒçš„æ¨¡å‹ä»2014å¹´èµ·åœ¨IWSLTæµ‹è¯•é›†ä¸Šè·å¾—äº†25.54çš„æ— çº¦æŸã€æ ‡è®°çš„BLEUåˆ†æ•°ã€‚ åœ¨MT-LARGEä¸Šè®­ç»ƒçš„MT-LSTMåœ¨WMT2016æµ‹è¯•é›†ä¸Šè·å¾—28.96çš„æ— çº¦æŸçš„ã€æ ‡è®°åŒ–çš„BLEUåˆ†æ•°ã€‚ è¿™äº›ç»“æœä»£è¡¨äº†å„è‡ªæ•°æ®é›†çš„å¼ºåŸºçº¿æœºå™¨ç¿»è¯‘æ¨¡å‹ã€‚ è¯·æ³¨æ„ï¼Œè™½ç„¶æœ€å°çš„æ•°æ®é›†å…·æœ‰æœ€é«˜çš„BLEUå¾—åˆ†ï¼Œä½†å®ƒä¹Ÿæ˜¯ä¸€ä¸ªå…·æœ‰å—é™åŸŸçš„ç®€å•å¾—å¤šçš„æ•°æ®é›†ã€‚</p>

<p><strong>Training Details.</strong> When training an MT-LSTM, we used fixed 300-dimensional word vectors. We used the CommonCrawl-840B GloVe model for English word vectors, which were completely fixed during training, so that the MT-LSTM had to learn how to use the pretrained vectors for translation. The hidden size of the LSTMs in all MT-LSTMs is 300. Because all MT-LSTMs are bidirectional, they output 600-dimensional vectors. The model was trained with stochastic gradient descent with a learning rate that began at 1 and decayed by half each epoch after the validation perplexity increased for the first time. Dropout with ratio 0.2 was applied to the inputs and outputs of all layers of the encoder and decoder.<br />
åœ¨è®­ç»ƒMT-LSTMæ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨å›ºå®šçš„300ç»´è¯å‘é‡ã€‚ æˆ‘ä»¬ä½¿ç”¨Commoncrawl-840Bæ‰‹å¥—æ¨¡å‹å¯¹è‹±è¯­å•è¯å‘é‡è¿›è¡Œè®­ç»ƒï¼Œè¿™äº›å‘é‡åœ¨è®­ç»ƒæœŸé—´å®Œå…¨å›ºå®šï¼Œå› æ­¤MT-LSTMå¿…é¡»å­¦ä¹ å¦‚ä½•ä½¿ç”¨é¢„å…ˆè®­ç»ƒçš„å‘é‡è¿›è¡Œç¿»è¯‘ã€‚ æ‰€æœ‰MT-LSTMä¸­LSTMçš„éšè—å¤§å°ä¸º300ã€‚ å› ä¸ºæ‰€æœ‰MT-LSTMéƒ½æ˜¯åŒå‘çš„ï¼Œæ‰€ä»¥å®ƒä»¬è¾“å‡º600ç»´å‘é‡ã€‚ è¯¥æ¨¡å‹ä»¥éšæœºæ¢¯åº¦ä¸‹é™çš„æ–¹å¼è¿›è¡Œè®­ç»ƒï¼Œå­¦ä¹ é€Ÿç‡ä»1å¼€å§‹ï¼Œåœ¨éªŒè¯å›°æƒ‘åº¦é¦–æ¬¡å¢åŠ åï¼Œæ¯ä¸€ä¸ªå†å…ƒè¡°å‡ä¸€åŠã€‚ åœ¨ç¼–ç å™¨å’Œè§£ç å™¨çš„æ‰€æœ‰å±‚çš„è¾“å…¥å’Œè¾“å‡ºä¸Šæ–½åŠ æ¯”ä¸º0.2çš„å‹å·®ã€‚</p>

<p><strong>8.2 Classification and Question Answering</strong>
For classification and question answering, we explore how varying the input representations affects final performance. Table 2 contains validation performances for experiments comparing the use of GloVe, character n-grams, CoVe, and combinations of the three.<br />
å¯¹äºåˆ†ç±»å’Œé—®ç­”ï¼Œæˆ‘ä»¬æ¢è®¨äº†è¾“å…¥è¡¨ç¤ºå½¢å¼çš„å˜åŒ–å¦‚ä½•å½±å“æœ€ç»ˆæ€§èƒ½ã€‚ è¡¨2åŒ…å«æ¯”è¾ƒæ‰‹å¥—ã€å­—ç¬¦nå…‹ã€COVEå’Œä¸‰è€…ç»„åˆä½¿ç”¨çš„å®éªŒéªŒè¯æ€§èƒ½ã€‚
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-table2.png" alt="190911-table2.png" /></p>

<p><strong>Training Details.</strong> Unsupervised vectors and MT-LSTMs remain fixed in this set of experiments. LSTMs have hidden size 300. Models were trained using Adam with Î± = 0.001. Dropout was applied before all feedforward layers with dropout ratio 0.1, 0.2, or 0.3. Maxout networks pool over 4 channels, reduce dimensionality by 2, 4, or 8, reduce again by 2, and project to the output dimension.<br />
åœ¨è¿™ç»„å®éªŒä¸­ï¼Œæ— ç›‘ç£å‘é‡å’ŒMT-LSTMä¿æŒä¸å˜ã€‚ LSTMå…·æœ‰éšè—å¤§å°300ã€‚ æ¨¡å‹è®­ç»ƒé‡‡ç”¨ADAMï¼ŒÎ±=0.001ã€‚ åœ¨æ‰€æœ‰å‰é¦ˆå±‚ä¹‹å‰æ–½åŠ å‹å·®ï¼Œå‹å·®æ¯”ä¸º0.1ã€0.2æˆ–0.3ã€‚ MAXOUTç½‘ç»œé€šè¿‡4ä¸ªé€šé“å…±ç”¨ï¼Œå°†ç»´æ•°é™ä½2ã€4æˆ–8ï¼Œå†æ¬¡é™ä½2ï¼Œç„¶åæŠ•å°„åˆ°è¾“å‡ºç»´åº¦ã€‚</p>

<p><strong>The Benefits of CoVe.</strong> Figure 3a shows that models that use CoVe alongside GloVe achieve higher validation performance than models that use only GloVe. Figure 3b shows that using CoVe in Eq. 6 brings larger improvements than using character n-gram embeddings [Hashimoto et al., 2016]. It also shows that altering Eq. 6 by additionally appending character n-gram embeddings can boost performance even further for some tasks. This suggests that the information provided by CoVe is complementary to both the word-level information provided by GloVe as well as the character-level information provided by character n-gram embeddings.<br />
å›¾3Aæ˜¾ç¤ºï¼Œä¸åªä½¿ç”¨æ‰‹å¥—çš„æ¨¡å‹ç›¸æ¯”ï¼Œå°†COVEä¸æ‰‹å¥—ä¸€èµ·ä½¿ç”¨çš„æ¨¡å‹å®ç°äº†æ›´é«˜çš„éªŒè¯æ€§èƒ½ã€‚ å›¾3Bæ˜¾ç¤ºäº†åœ¨EQä¸­ä½¿ç”¨COVEã€‚ 6æ¯”ä½¿ç”¨å­—ç¬¦N-å…‹åµŒå…¥å¸¦æ¥æ›´å¤§çš„æ”¹è¿›[Hashimotoç­‰äººï¼Œ2016å¹´]ã€‚ ç»“æœè¿˜è¡¨æ˜ï¼Œæƒ…å•†çš„æ”¹å˜ã€‚ 6é€šè¿‡é™„åŠ å­—ç¬¦ï¼Œn-å…‹åµŒå…¥å¯ä»¥è¿›ä¸€æ­¥æé«˜æŸäº›ä»»åŠ¡çš„æ€§èƒ½ã€‚ è¿™è¡¨æ˜ï¼ŒCOVEæä¾›çš„ä¿¡æ¯ä¸GLOVEæä¾›çš„å­—çº§ä¿¡æ¯ä»¥åŠå­—ç¬¦nå­—åµŒå…¥æä¾›çš„å­—ç¬¦çº§ä¿¡æ¯æ˜¯äº’è¡¥çš„ã€‚
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-figure3.png" alt="190911-figure3.png" /></p>

<p><strong>The Effects of MT Training Data.</strong> 
We experimented with different training datasets for the MT-LSTMs to see how varying the MT train- ing data affects the benefits of using CoVe in downstream tasks. Figure 4 shows an important trend we can ex- tract from Table 2. There appears to be a positive correlation between the larger MT datasets, which contain more complex, varied language, and the improvement that using CoVe brings to downstream tasks. This is evidence for our hypothesis that MT data has potential as a large resource for transfer learning in NLP.<br />
æˆ‘ä»¬å¯¹MT-LSTMçš„ä¸åŒè®­ç»ƒæ•°æ®é›†è¿›è¡Œäº†å®éªŒï¼Œä»¥äº†è§£MT-Trainingæ•°æ®çš„å˜åŒ–å¦‚ä½•å½±å“åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸­ä½¿ç”¨COVEçš„å¥½å¤„ã€‚ å›¾4æ˜¾ç¤ºäº†ä¸€ä¸ªé‡è¦çš„è¶‹åŠ¿ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¡¨2ä¸­æ¨æ–­å‡ºæ¥ã€‚ åŒ…å«æ›´å¤æ‚ã€æ›´å¤šæ ·çš„è¯­è¨€çš„æ›´å¤§çš„MTæ•°æ®é›†ä¸ä½¿ç”¨COVEç»™ä¸‹æ¸¸ä»»åŠ¡å¸¦æ¥çš„æ”¹è¿›ä¹‹é—´ä¼¼ä¹å­˜åœ¨æ­£ç›¸å…³ã€‚ è¿™è¯æ˜äº†æˆ‘ä»¬çš„å‡è®¾ï¼Œå³MTæ•°æ®ä½œä¸ºNLPä¸­è¿ç§»å­¦ä¹ çš„ä¸€ä¸ªå·¨å¤§èµ„æºå…·æœ‰æ½œåŠ›ã€‚
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-figure4.png" alt="190911-figure4.png" /></p>

<p><strong>Test Performance.</strong> Table 4 shows the final test accuracies of our best classification models, each of which achieved the highest validation accuracy on its task using GloVe, CoVe, and character n-gram embeddings. Final test performances on SST-5 and SNLI reached a new state of the art.<br />
è¡¨4æ˜¾ç¤ºäº†æˆ‘ä»¬æœ€å¥½çš„åˆ†ç±»æ¨¡å‹çš„æœ€ç»ˆæµ‹è¯•ç²¾åº¦ï¼Œæ¯ä¸ªæ¨¡å‹éƒ½ä½¿ç”¨GLOVEã€COVEå’Œå­—ç¬¦N-å›¾åµŒå…¥åœ¨å…¶ä»»åŠ¡ä¸Šè·å¾—äº†æœ€é«˜çš„éªŒè¯ç²¾åº¦ã€‚ åœ¨SST-5å’ŒSNLIä¸Šçš„æœ€ç»ˆæµ‹è¯•æ€§èƒ½è¾¾åˆ°äº†æ–°çš„æŠ€æœ¯æ°´å¹³ã€‚ 
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-table4.png" alt="190911-table4.png" /></p>

<p>Table 3 shows how the validation exact match and F1 scores of our best SQuAD model compare to the scores of the most recent top models in the literature. We did not submit the SQuAD model for testing, but the addition of CoVe was enough to push the validation performance of the original DCN, which already used
character n-gram embeddings, above the validation performance of the published version of the R-NET.Test performances are tracked by the SQuAD leaderboard 2.<br />
è¡¨3æ˜¾ç¤ºäº†æˆ‘ä»¬æœ€ä½³é˜µå®¹æ¨¡å‹çš„éªŒè¯ç²¾ç¡®åŒ¹é…å’ŒF1å¾—åˆ†ä¸æ–‡çŒ®ä¸­æœ€æ–°é¡¶çº§æ¨¡å‹çš„å¾—åˆ†çš„æ¯”è¾ƒã€‚ æˆ‘ä»¬æ²¡æœ‰æäº¤Squadæ¨¡å‹è¿›è¡Œæµ‹è¯•ï¼Œä½†æ˜¯æ·»åŠ COVEå°±è¶³ä»¥æ¨åŠ¨å·²ç»ä½¿ç”¨çš„åŸå§‹DCNçš„éªŒè¯æ€§èƒ½ 
å­—ç¬¦N-gramåµŒå…¥ï¼Œé«˜äºå·²å‘å¸ƒç‰ˆæœ¬çš„R-NETçš„éªŒè¯æ€§èƒ½ã€‚æµ‹è¯•æ€§èƒ½ç”±Squad Leaderboard 2è·Ÿè¸ªã€‚ 
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-table3.png" alt="190911-table3.png" /></p>

<p><strong>Comparison to Skip-Thought Vectors.</strong> Kiros et al. [2015] show how to encode a sentence into a single skip-thought vector that transfers well to a variety of tasks. Both skip-thought and CoVe pretrain encoders to capture information at a higher level than words. However, skip-thought encoders are trained with an unsupervised method that relies on the final output of the encoder. MT-LSTMs are trained with a supervised method that instead relies on intermediate outputs as- sociated with each input word. Additionally, the 4800 dimensional skip-thought vectors make training more unstable than using the 600 dimensional CoVe. Table 5 shows that these differences make CoVe more suitable for transfer learning in our classification experiments.<br />
Kirosç­‰äººã€‚ [2015]å±•ç¤ºäº†å¦‚ä½•å°†å¥å­ç¼–ç ä¸ºä¸€ä¸ªè·³è¿‡æ€è€ƒçš„å‘é‡ï¼Œè¯¥å‘é‡å¯ä»¥å¾ˆå¥½åœ°ä¼ é€’åˆ°å„ç§ä»»åŠ¡ã€‚ Skip-Thoughå’ŒCove Pretrainç¼–ç å™¨éƒ½å¯ä»¥åœ¨æ¯”å•è¯æ›´é«˜çš„çº§åˆ«æ•è·ä¿¡æ¯ã€‚ ç„¶è€Œï¼Œè·³è¿‡æ€æƒ³çš„ç¼–ç å™¨æ˜¯ç”¨ä¾èµ–äºç¼–ç å™¨çš„æœ€ç»ˆè¾“å‡ºçš„æ— ç›‘ç£æ–¹æ³•æ¥è®­ç»ƒçš„ã€‚ MT-LSTMä½¿ç”¨ç›‘ç£æ–¹æ³•è¿›è¡Œè®­ç»ƒï¼Œè¯¥æ–¹æ³•ä¾èµ–äºä¸æ¯ä¸ªè¾“å…¥å­—ç›¸å…³è”çš„ä¸­é—´è¾“å‡ºã€‚ æ­¤å¤–ï¼Œ4800ç»´è·³è·ƒæ€ç»´å‘é‡ä½¿å¾—è®­ç»ƒæ¯”ä½¿ç”¨600ç»´å‡¹æ§½æ›´ä¸ç¨³å®šã€‚ è¡¨5æ˜¾ç¤ºäº†è¿™äº›å·®å¼‚ä½¿å¾—COVEæ›´é€‚åˆäºæˆ‘ä»¬çš„åˆ†ç±»å®éªŒä¸­çš„è¿ç§»å­¦ä¹ ã€‚ 
<img src="https://cdn.jsdelivr.net/gh/tian-guo-guo/cdn@1.0/assets/img/blog/190911-table5.png" alt="190911-table5.png" /></p>

<p><strong>9 Conclusion</strong>
We introduce an approach for transferring knowledge from an encoder pretrained on machine translation to a variety of downstream NLP tasks. In all cases, models that used CoVe from our best, pretrained MT-LSTM performed better than baselines that used random word vector initialization, baselines that used pretrained word vectors from a GloVe model, and baselines that used word vectors from a GloVe model together with character n-gram embeddings. We hope this is a step towards the goal of building unified NLP models that rely on increasingly more general reusable weights. <br />
ä»‹ç»äº†ä¸€ç§å°†æœºå™¨ç¿»è¯‘è®­ç»ƒå¥½çš„ç¼–ç å™¨çš„çŸ¥è¯†è½¬ç§»åˆ°å¤šç§ä¸‹æ¸¸NLPä»»åŠ¡çš„æ–¹æ³•ã€‚ åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œä½¿ç”¨æˆ‘ä»¬æœ€å¥½çš„ã€é¢„å…ˆè®­ç»ƒçš„MT-LSTMçš„COVEçš„æ¨¡å‹æ¯”ä½¿ç”¨éšæœºå­—å‘é‡åˆå§‹åŒ–çš„åŸºçº¿ã€ä½¿ç”¨æ‰‹å¥—æ¨¡å‹çš„é¢„å…ˆè®­ç»ƒçš„å­—å‘é‡çš„åŸºçº¿ã€ä»¥åŠä½¿ç”¨æ‰‹å¥—æ¨¡å‹çš„å­—å‘é‡å’Œå­—ç¬¦N-å›¾åµŒå…¥çš„åŸºçº¿è¡¨ç°å¾—æ›´å¥½ã€‚ æˆ‘ä»¬å¸Œæœ›è¿™æ˜¯æœç€å»ºç«‹ç»Ÿä¸€çš„NLPæ¨¡å‹çš„ç›®æ ‡è¿ˆå‡ºçš„ä¸€æ­¥ï¼Œè¯¥æ¨¡å‹ä¾èµ–äºè¶Šæ¥è¶Šå¹¿æ³›çš„å¯é‡ç”¨æƒé‡ã€‚</p>

<p>The PyTorch code at https://github.com/salesforce/cove includes an example of how to generate CoVe from the MT-LSTM we used in all of our best models. We hope that making our best MT-LSTM available will encourage further research into shared representations for NLP models.<br />
http://github.com/salesforce/coveä¸Šçš„Pytorchä»£ç åŒ…å«ä¸€ä¸ªå¦‚ä½•ä»æˆ‘ä»¬åœ¨æ‰€æœ‰æœ€ä½³æ¨¡å‹ä¸­ä½¿ç”¨çš„MT-LSTMç”Ÿæˆcoveçš„ç¤ºä¾‹ã€‚ æˆ‘ä»¬å¸Œæœ›ï¼Œä½¿æˆ‘ä»¬æœ€å¥½çš„MT-LSTMå¯ç”¨å°†é¼“åŠ±è¿›ä¸€æ­¥ç ”ç©¶NLPæ¨¡å‹çš„å…±äº«è¡¨ç¤ºã€‚</p>
:ET